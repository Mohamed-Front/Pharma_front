import{_ as O,u as P,a as N,P as W,r as v,c as j,o as U,e as c,h as u,g as e,i as p,j as i,t as a,F as R,y as D,D as T,b as V,s as z,A as M,Q,E as S,R as F,S as G,k as K}from"./index-2cd76906.js";const Y={class:"bg-gray-100 min-h-screen"},H={class:"py-10 px-4 md:px-8 max-w-7xl mx-auto"},I={key:0,class:"flex justify-center py-20"},J={key:1,class:"text-center py-20 text-gray-500 text-xl"},X={key:2,class:"space-y-8"},Z={class:"relative bg-white rounded-xl shadow-lg overflow-hidden"},ee={class:"absolute top-4 left-4 bg-gradient-to-r from-green-600 to-green-700 text-white text-xs font-bold py-2 px-4 rounded-full shadow-md z-10"},te={class:"p-8 flex flex-col md:flex-row items-center justify-between gap-6"},se={class:"text-center md:"},ae={class:"text-3xl md:text-4xl font-extrabold text-gray-900 leading-tight"},oe={class:"text-lg text-gray-600 mt-2"},le={class:"text-sm text-gray-500 mt-1"},re=["src"],ie={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},de={class:"bg-white rounded-xl shadow p-6 text-center"},ne={class:"text-3xl font-bold text-gray-800"},ce={class:"text-gray-600"},ue={class:"bg-white rounded-xl shadow p-6 text-center"},_e={class:"text-3xl font-bold text-gray-800"},ve={class:"text-gray-600"},pe={class:"bg-white rounded-xl shadow p-6 text-center"},he={class:"text-3xl font-bold text-gray-800"},xe={class:"text-gray-600"},ge={class:"bg-white rounded-xl shadow-lg overflow-hidden"},me={class:"p-6 border-b"},ye={class:"text-2xl font-bold text-gray-800"},we={class:"overflow-x-auto"},fe={class:"w-full"},be={class:"bg-white divide-y divide-gray-200"},ke={class:"px-6 py-4 whitespace-nowrap"},Ve={class:"text-sm font-medium text-gray-900"},Re={class:"px-6 py-4"},De=["src"],Se={class:"px-6 py-4 text-sm text-gray-600"},Fe={class:"px-6 py-4 text-sm font-semibold text-gray-900"},$e={class:"px-6 py-4"},Le={key:1,class:"text-gray-400 text-xs"},qe={class:"px-6 py-4"},Ae={class:"px-6 py-4"},Be={class:"bg-white rounded-xl shadow-lg p-8"},Ce={class:"text-2xl font-bold text-gray-800 mb-6"},Ee={class:"flex items-center gap-4"},Oe={class:"font-medium text-gray-700"},Pe={class:"bg-white rounded-xl shadow-lg p-8"},Ne={class:"text- Kult2xl font-bold text-gray-800 mb-6"},We={key:0,class:"space-y-6"},je={class:"flex items-center gap-3 mb-2"},Ue={class:"font-semibold text-gray-800"},Te={class:"text-xs text-gray-500"},ze={class:"text-gray-700"},Me={key:1,class:"text-center py-10 text-gray-500"},Qe={__name:"warehouse-details",setup(Ge){const{t:o}=P(),h=N(),$=W(),l=v(null),w=v(!0),f=v(!1),x=v(""),g=v(0);v(localStorage.getItem("appLang")||"en");const m=v({}),y=v({}),L=j(()=>{var r,s;return((s=(r=l.value)==null?void 0:r.logo)==null?void 0:s.url)||"https://via.placeholder.com/64?text=Logo"}),q=r=>Number(r).toLocaleString("en-US"),b=r=>{if(!r||r.length===0)return null;const s=new Date,t=r.filter(n=>{const k=new Date(n.start_date),E=new Date(n.end_date);return n.status==="active"&&s>=k&&s<=E});if(t.length===0)return null;const _=t.find(n=>n.discount_type===2);if(_)return{type:"discount",value:_.discount_value+"% OFF"};const d=t.find(n=>n.discount_type===3&&n.quantity);return d?{type:"bonus",value:`Buy ${d.min_limit}, Get ${d.quantity} Free`}:{type:"offer",value:"Special Offer"}},A=async r=>{try{w.value=!0;const s=await V.get(`api/pharmacy-home/warehouse/${r}`);if(s.data.success)l.value={...s.data.data,total_products:s.data.data.paginated_products.total,connected_pharmacies:s.data.data.connected_pharmacies||0,rate:s.data.data.total_rating||0,reviews:s.data.data.reviews||[]},s.data.data.paginated_products.data.forEach(t=>{m.value[t.id]=1});else throw new Error("Failed to fetch warehouse")}catch(s){h.add({severity:"error",summary:o("error"),detail:o("error.fetchWarehouse")||"Failed to load warehouse",life:3e3}),console.error("Error:",s)}finally{w.value=!1}},B=async r=>{var t,_;const s=m.value[r]||1;if(s<1){h.add({severity:"warn",summary:o("warning"),detail:"Quantity must be at least 1",life:3e3});return}y.value[r]=!0;try{const d=await V.post("/api/cart/add/item?update=1",{product_id:r,quantity:s});if(d.data.success)h.add({severity:"success",summary:o("success"),detail:`${s} Ã— Product added to cart successfully!`,life:3e3}),m.value[r]=1;else throw new Error(d.data.message||"Failed to add to cart")}catch(d){const n=((_=(t=d.response)==null?void 0:t.data)==null?void 0:_.message)||d.message||"Error adding to cart";h.add({severity:"error",summary:o("error"),detail:n,life:3e3})}finally{setTimeout(()=>{delete y.value[r]},1e3)}},C=async()=>{var r,s;if(!x.value.trim()||g.value===0){h.add({severity:"warn",summary:o("warning"),detail:o("error.reviewFieldsRequired")||"Please provide rating and review",life:3e3});return}try{f.value=!0;const t={id:l.value.id,type:"warehouse",body:x.value,rate:g.value};await V.post("api/review",t);const _={id:Date.now(),user_name:"You",rate:g.value,body:x.value,created_at:new Date().toISOString()};l.value.reviews.unshift(_);const d=l.value.reviews.reduce((n,k)=>n+k.rate,0);l.value.rate=d/l.value.reviews.length,h.add({severity:"success",summary:o("success"),detail:o("success.reviewAdded")||"Thank you for your review!",life:3e3}),x.value="",g.value=0}catch(t){h.add({severity:"error",summary:o("error"),detail:((s=(r=t.response)==null?void 0:r.data)==null?void 0:s.message)||"Failed to submit review",life:3e3})}finally{f.value=!1}};return U(()=>{A($.params.id)}),(r,s)=>(c(),u("div",Y,[e("div",H,[w.value?(c(),u("div",I,[p(i(z),{style:{width:"60px",height:"60px"},strokeWidth:"4"})])):l.value?(c(),u("div",X,[e("div",Z,[e("div",ee,a(i(o)("verified_account")||"Verified Account"),1),e("div",te,[e("div",se,[e("h1",ae,a(l.value.name),1),e("p",oe,a(l.value.city)+", "+a(l.value.country),1),e("p",le,a(l.value.address),1)]),e("img",{src:L.value,alt:"Logo",class:"w-28 h-28 object-contain rounded-xl border-4 border-gray-200 shadow-md"},null,8,re)])]),e("div",ie,[e("div",de,[s[2]||(s[2]=e("i",{class:"pi pi-box text-4xl text-green-600 mb-3"},null,-1)),e("div",ne,a(l.value.total_products),1),e("div",ce,a(i(o)("number_of_products")||"Products"),1)]),e("div",ue,[s[3]||(s[3]=e("i",{class:"pi pi-briefcase text-4xl text-green-600 mb-3"},null,-1)),e("div",_e,a(l.value.connected_pharmacies),1),e("div",ve,a(i(o)("connected_pharmacies")||"Connected Pharmacies"),1)]),e("div",pe,[s[4]||(s[4]=e("i",{class:"pi pi-star-fill text-4xl text-yellow-500 mb-3"},null,-1)),e("div",he,a(l.value.rate?l.value.rate.toFixed(1):"N/A"),1),e("div",xe,a(i(o)("ratings")||"Average Rating"),1)])]),e("div",ge,[e("div",me,[e("h2",ye,a(i(o)("most_requested_products")||"Available Products"),1)]),e("div",we,[e("table",fe,[e("tbody",be,[(c(!0),u(R,null,D(l.value.paginated_products.data,t=>{var _;return c(),u("tr",{key:t.id,class:"hover:bg-gray-50 transition"},[e("td",ke,[e("div",Ve,a(t.commercial_name),1)]),e("td",Re,[e("img",{src:((_=t.media[0])==null?void 0:_.url)||"https://via.placeholder.com/64",class:"h-16 w-16 rounded-lg object-cover border"},null,8,De)]),e("td",Se,a(t.company.name),1),e("td",Fe," $"+a(q(t.price)),1),e("td",$e,[b(t.active_offers)?(c(),u("span",{key:0,class:M(["inline-flex items-center px-3 py-1 rounded-full text-xs font-medium",b(t.active_offers).type==="discount"?"bg-red-100 text-red-800":"bg-green-100 text-green-800"])},a(b(t.active_offers).value),3)):(c(),u("span",Le,"No offer"))]),e("td",qe,[p(i(Q),{modelValue:m.value[t.id],"onUpdate:modelValue":d=>m.value[t.id]=d,min:1,buttonLayout:"horizontal",inputClass:"text-center"},null,8,["modelValue","onUpdate:modelValue"])]),e("td",Ae,[p(i(S),{icon:y.value[t.id]?"pi pi-spin pi-spinner":"pi pi-shopping-cart",loading:y.value[t.id],class:"bg-green-600 hover:bg-green-700 text-white",onClick:d=>B(t.id)},null,8,["icon","loading","onClick"])])])}),128))])])])]),e("div",Be,[e("h3",Ce,a(i(o)("add_review")||"Write a Review"),1),e("form",{onSubmit:T(C,["prevent"]),class:"space-y-6"},[e("div",Ee,[e("span",Oe,a(i(o)("rate"))+":",1),p(i(F),{modelValue:g.value,"onUpdate:modelValue":s[0]||(s[0]=t=>g.value=t),stars:5,cancel:!1,class:"text-yellow-400"},null,8,["modelValue"])]),p(i(G),{modelValue:x.value,"onUpdate:modelValue":s[1]||(s[1]=t=>x.value=t),placeholder:i(o)("placeholder.write_review")||"Share your experience...",rows:"5",class:"w-full"},null,8,["modelValue","placeholder"]),p(i(S),{type:"submit",label:i(o)("submit_review")||"Submit Review",loading:f.value,class:"w-full md:w-auto px-8 bg-green-600 hover:bg-green-700"},null,8,["label","loading"])],32)]),e("div",Pe,[e("h3",Ne,a(i(o)("customer_reviews")||"Customer Reviews")+" ("+a(l.value.reviews.length)+") ",1),l.value.reviews.length>0?(c(),u("div",We,[(c(!0),u(R,null,D(l.value.reviews,t=>(c(),u("div",{key:t.id,class:"border-b pb-6 last:border-0"},[e("div",je,[s[5]||(s[5]=e("i",{class:"pi pi-user text-2xl text-gray-400"},null,-1)),e("div",null,[e("p",Ue,a(t.user_name||"Anonymous"),1),e("p",Te,a(new Date(t.created_at||Date.now()).toLocaleDateString()),1)])]),p(i(F),{modelValue:t.rate,readonly:"",stars:5,class:"mb-2"},null,8,["modelValue"]),e("p",ze,a(t.body),1)]))),128))])):(c(),u("div",Me,a(i(o)("no_reviews_yet")||"No reviews yet. Be the first to review!"),1))])])):(c(),u("div",J,a(i(o)("error.noWarehouse")||"Warehouse not found"),1)),p(i(K))])]))}},Ye=O(Qe,[["__scopeId","data-v-7da3f26e"]]);export{Ye as default};
