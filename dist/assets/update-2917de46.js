import{_ as O,i as N,J as L,j as M,u as R,r as m,d as z,Y as f,Z as G,o as g,c as x,M as S,k as l,t as n,z as d,v as $,C as A,F as J,B as h,q as c,l as i}from"./index-2f0b6a57.js";const P={class:"max-w-5xl mx-auto p-6 bg-white rounded-xl shadow-lg"},Y={class:"text-3xl font-bold text-center mb-8 text-gray-800"},Z={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},H={class:"space-y-2"},K={for:"product",class:"block text-sm font-medium text-gray-700"},Q={class:"space-y-2"},W={for:"limit",class:"block text-sm font-medium text-gray-700"},X={class:"space-y-2"},ee={for:"quantity",class:"block text-sm font-medium text-gray-700"},te={class:"space-y-2"},ae={for:"quantity_unit",class:"block text-sm font-medium text-gray-700"},le={class:"space-y-2"},oe={for:"discount_type",class:"block text-sm font-medium text-gray-700"},se={class:"space-y-2"},re={for:"discount_value",class:"block text-sm font-medium text-gray-700"},ue={class:"space-y-2"},de={for:"start_date",class:"block text-sm font-medium text-gray-700"},ne={class:"space-y-2"},ie={for:"end_date",class:"block text-sm font-medium text-gray-700"},ce={class:"space-y-2 md:col-span-2"},fe={for:"description",class:"block text-sm font-medium text-gray-700"},pe={class:"pt-4 flex justify-center"},_e={key:0},ve={key:1,class:"pi pi-spinner pi-spin"},me={__name:"update",setup(ye){const q=N(),V=L(),p=M(),{t:u}=R(),k=m(),y=m(!1),w=m([]),_=m(!1),t=m({product_id:null,limit:null,quantity:null,quantity_unit:null,discount_type:null,discount_value:null,start_date:null,end_date:null,description:""}),o=m({product_id:!1,limit:!1,quantity:!1,quantity_unit:!1,discount_type:!1,discount_value:!1,start_date:!1,end_date:!1,description:!1}),D=async()=>{try{const a=await h.get("/api/product");w.value=a.data.data}catch(a){console.error("Error fetching products:",a),p.add({severity:"error",summary:u("error"),detail:u("error_fetching_data"),life:3e3})}},T=async a=>{try{const s=(await h.get(`/api/offer/${a}`)).data.data;t.value={product_id:s.product_id,limit:s.limit,quantity:s.quantity,quantity_unit:s.quantity_unit,discount_type:s.discount_type,discount_value:s.discount_value,start_date:s.start_date?s.start_date.split("T")[0]:null,end_date:s.end_date?s.end_date.split("T")[0]:null,description:s.description||""}}catch(e){console.error("Error fetching offer:",e),p.add({severity:"error",summary:u("error"),detail:u("error_fetching_offer"),life:3e3}),q.push({name:"offers"})}},U=()=>(o.value.product_id=!t.value.product_id,o.value.limit=t.value.limit===null||t.value.limit==="",o.value.quantity=t.value.quantity===null||t.value.quantity==="",o.value.quantity_unit=!t.value.quantity_unit,o.value.discount_type=!t.value.discount_type,o.value.discount_value=t.value.discount_value===null||t.value.discount_value==="",o.value.start_date=!t.value.start_date,o.value.end_date=!t.value.end_date,o.value.description=!1,t.value.start_date&&t.value.end_date&&(o.value.end_date=new Date(t.value.start_date)>new Date(t.value.end_date)),!Object.values(o.value).some(a=>a)),F=async()=>{var a;if(Object.keys(o.value).forEach(e=>o.value[e]=!1),!U()){p.add({severity:"error",summary:u("error"),detail:u("please_fill_required_fields"),life:3e3});return}y.value=!0;try{_.value?(await h.put(`/api/offer/${V.params.id}`,t.value),p.add({severity:"success",summary:u("success"),detail:u("offer_updated"),life:3e3})):(await h.post("/api/offer",t.value),p.add({severity:"success",summary:u("success"),detail:u("offer_created"),life:3e3})),q.push({name:"offers"})}catch(e){console.error("Error:",e);let s=u(_.value?"error_updating_offer":"error_creating_offer");if(((a=e.response)==null?void 0:a.status)===422){const v=e.response.data.errors;s=Object.values(v).flat().join(", "),Object.keys(v).forEach(b=>{b in o.value&&(o.value[b]=!0)})}p.add({severity:"error",summary:u("error"),detail:s,life:3e3})}finally{y.value=!1}};return z(()=>{D(),V.params.id&&(_.value=!0,T(V.params.id))}),(a,e)=>{const s=f("Dropdown"),v=f("InputNumber"),b=f("InputText"),j=f("Textarea"),C=f("Button"),E=f("Form"),B=f("Toast"),I=G("can");return g(),x(J,null,[S((g(),x("div",P,[l("h1",Y,n(a.$t(_.value?"offer.edit_offer":"offer.create_new_offer")),1),d(E,{ref_key:"form",ref:k,model:t.value,onSubmit:A(F,["prevent"]),class:"space-y-6"},{default:$(()=>[l("div",Z,[l("div",H,[l("label",K,[c(n(a.$t("offer.product"))+" ",1),e[9]||(e[9]=l("span",{class:"text-red-500"},"*",-1))]),d(s,{id:"product",modelValue:t.value.product_id,"onUpdate:modelValue":e[0]||(e[0]=r=>t.value.product_id=r),options:w.value,optionLabel:"commercial_name",optionValue:"id",placeholder:a.$t("offer.select_product"),class:i(["w-full border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",{"p-invalid":o.value.product_id}])},null,8,["modelValue","options","placeholder","class"])]),l("div",Q,[l("label",W,[c(n(a.$t("offer.limit"))+" ",1),e[10]||(e[10]=l("span",{class:"text-red-500"},"*",-1))]),d(v,{id:"limit",modelValue:t.value.limit,"onUpdate:modelValue":e[1]||(e[1]=r=>t.value.limit=r),useGrouping:!1,placeholder:a.$t("offer.enter_limit"),class:i(["w-full",{"p-invalid":o.value.limit}]),inputClass:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,8,["modelValue","placeholder","class"])]),l("div",X,[l("label",ee,[c(n(a.$t("offer.quantity"))+" ",1),e[11]||(e[11]=l("span",{class:"text-red-500"},"*",-1))]),d(v,{id:"quantity",modelValue:t.value.quantity,"onUpdate:modelValue":e[2]||(e[2]=r=>t.value.quantity=r),useGrouping:!1,placeholder:a.$t("offer.enter_quantity"),class:i(["w-full",{"p-invalid":o.value.quantity}]),inputClass:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,8,["modelValue","placeholder","class"])]),l("div",te,[l("label",ae,[c(n(a.$t("offer.quantity_unit"))+" ",1),e[12]||(e[12]=l("span",{class:"text-red-500"},"*",-1))]),d(s,{id:"quantity_unit",modelValue:t.value.quantity_unit,"onUpdate:modelValue":e[3]||(e[3]=r=>t.value.quantity_unit=r),options:[{label:"Tablets",value:1},{label:"Capsules",value:2},{label:"Units",value:3}],optionLabel:"label",optionValue:"value",placeholder:a.$t("offer.select_quantity_unit"),class:i(["w-full border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",{"p-invalid":o.value.quantity_unit}])},null,8,["modelValue","placeholder","class"])]),l("div",le,[l("label",oe,[c(n(a.$t("offer.discount_type"))+" ",1),e[13]||(e[13]=l("span",{class:"text-red-500"},"*",-1))]),d(s,{id:"discount_type",modelValue:t.value.discount_type,"onUpdate:modelValue":e[4]||(e[4]=r=>t.value.discount_type=r),options:[{label:"Percentage",value:1},{label:"Fixed Amount",value:2}],optionLabel:"label",optionValue:"value",placeholder:a.$t("offer.select_discount_type"),class:i(["w-full border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",{"p-invalid":o.value.discount_type}])},null,8,["modelValue","placeholder","class"])]),l("div",se,[l("label",re,[c(n(a.$t("offer.discount_value"))+" ",1),e[14]||(e[14]=l("span",{class:"text-red-500"},"*",-1))]),d(v,{id:"discount_value",modelValue:t.value.discount_value,"onUpdate:modelValue":e[5]||(e[5]=r=>t.value.discount_value=r),mode:"decimal",minFractionDigits:2,maxFractionDigits:2,placeholder:a.$t("offer.enter_discount_value"),class:i(["w-full",{"p-invalid":o.value.discount_value}]),inputClass:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,8,["modelValue","placeholder","class"])]),l("div",ue,[l("label",de,[c(n(a.$t("offer.start_date"))+" ",1),e[15]||(e[15]=l("span",{class:"text-red-500"},"*",-1))]),d(b,{id:"start_date",modelValue:t.value.start_date,"onUpdate:modelValue":e[6]||(e[6]=r=>t.value.start_date=r),type:"date",placeholder:a.$t("offer.enter_start_date"),class:i(["w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",{"p-invalid":o.value.start_date}])},null,8,["modelValue","placeholder","class"])]),l("div",ne,[l("label",ie,[c(n(a.$t("offer.end_date"))+" ",1),e[16]||(e[16]=l("span",{class:"text-red-500"},"*",-1))]),d(b,{id:"end_date",modelValue:t.value.end_date,"onUpdate:modelValue":e[7]||(e[7]=r=>t.value.end_date=r),type:"date",placeholder:a.$t("offer.enter_end_date"),class:i(["w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",{"p-invalid":o.value.end_date}])},null,8,["modelValue","placeholder","class"])]),l("div",ce,[l("label",fe,n(a.$t("offer.description")),1),d(j,{id:"description",modelValue:t.value.description,"onUpdate:modelValue":e[8]||(e[8]=r=>t.value.description=r),placeholder:a.$t("offer.enter_description"),class:i(["w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",{"p-invalid":o.value.description}])},null,8,["modelValue","placeholder","class"])])]),l("div",pe,[d(C,{type:"submit",label:_.value?a.$t("offer.update_offer"):a.$t("offer.create_offer"),icon:"pi pi-plus",loading:y.value,class:"px-8 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center space-x-2",disabled:y.value},{default:$(()=>[y.value?(g(),x("i",ve)):(g(),x("span",_e,n(a.$t(_.value?"offer.update_offer":"offer.create_offer")),1))]),_:1},8,["label","loading","disabled"])])]),_:1},8,["model"])])),[[I,"create offers"]]),d(B)],64)}}},ge=O(me,[["__scopeId","data-v-9cd8dda1"]]);export{ge as default};
