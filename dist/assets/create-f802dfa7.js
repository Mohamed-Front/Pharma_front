import{_ as ne,z as ie,a as re,u as ue,r,o as ce,d,a8 as de,Z as pe,e as g,h as y,g as a,t as s,i as n,w as me,D as k,b,B as h,A as x,F as ve,y as _e,C as ge}from"./index-2cd76906.js";const ye={class:"max-w-5xl mx-auto p-6 bg-white rounded-xl shadow-lg"},fe={class:"text-3xl font-bold text-center mb-8 text-gray-800"},be={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},he={class:"space-y-2"},xe={for:"category",class:"block text-sm font-medium text-gray-700"},Ve={class:"space-y-2"},we={for:"company",class:"block text-sm font-medium text-gray-700"},$e={class:"space-y-2 relative"},ke={for:"commercial_name",class:"block text-sm font-medium text-gray-700"},Fe={key:0,class:"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto"},Ce={class:"py-1"},De=["onClick"],Ue={class:"space-y-2 md:col-span-2"},qe={for:"active_ingredient",class:"block text-sm font-medium text-gray-700"},Ie={class:"space-y-2 md:col-span-2"},Ne={for:"usage",class:"block text-sm font-medium text-gray-700"},Te={class:"space-y-2"},Se={for:"calibres",class:"block text-sm font-medium text-gray-700"},Le={class:"space-y-2"},Be={for:"quantity",class:"block text-sm font-medium text-gray-700"},je={class:"space-y-2"},Ge={for:"quantity_unit",class:"block text-sm font-medium text-gray-700"},Me={class:"space-y-2"},Pe={for:"price",class:"block text-sm font-medium text-gray-700"},Re={class:"space-y-2"},ze={for:"price_unit",class:"block text-sm font-medium text-gray-700"},Ae={class:"space-y-2"},Ee={for:"expiration_from",class:"block text-sm font-medium text-gray-700"},Oe={class:"space-y-2"},Je={for:"expiration_to",class:"block text-sm font-medium text-gray-700"},We={class:"space-y-2 md:col-span-2"},Ze={for:"storage_notes",class:"block text-sm font-medium text-gray-700"},He={class:"space-y-2"},Ke={for:"pharmaceutical_form",class:"block text-sm font-medium text-gray-700"},Qe={class:"md:col-span-2 space-y-2"},Xe={class:"block text-sm font-medium text-gray-700"},Ye={class:"flex justify-center"},et={key:0,class:"p-4"},tt={class:"relative group"},at=["src"],lt={class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 flex items-center justify-center rounded-lg transition-all"},ot={class:"opacity-0 group-hover:opacity-100 flex space-x-3 transition-all transform translate-y-4 group-hover:translate-y-0"},st={class:"mt-2 text-center text-sm text-gray-500"},nt={key:1,class:"p-8 flex flex-col items-center justify-center"},it={class:"text-sm text-center text-gray-600 mb-1"},rt={class:"text-blue-500 font-medium"},ut={class:"pt-4 flex justify-center"},ct={__name:"create",setup(dt){const P=ie(),F=re(),{t:v}=ue(),V=r(!1),w=r(null),$=r(null),f=r(!1),p=r([]),m=r(!1),c=r({company_id:!1,commercial_name:!1,price:!1,price_unit:!1}),l=r({category_id:null,company_id:null,commercial_name:"",active_ingredient:[],product_image:null,usage:"",calibres:"",quantity:null,quantity_unit:null,price:null,price_unit:null,expiration_from:null,expiration_to:null,storage_notes:"",pharmaceutical_form:""}),D=r([]),U=r([]),q=r([]),I=r(""),N=r(""),T=r(""),S=async()=>{const e=await b.get("/api/category",{params:{search:I.value}});D.value=e.data.data},L=async()=>{const e=await b.get("/api/company",{params:{search:N.value}});U.value=e.data.data},B=async()=>{const e=await b.get("/api/scientific-structure",{params:{search:T.value}});q.value=e.data.data},C=(e,t)=>(...i)=>{clearTimeout(e.timer),e.timer=setTimeout(()=>e(...i),t)},R=C(S,350),z=C(L,350),A=C(B,350),E=e=>{I.value=e.value,R()},O=e=>{N.value=e.value,z()},J=e=>{T.value=e.value,A()},W=async e=>{if(!e||e.length<2){p.value=[],m.value=!1;return}try{const t=await b.get(`/api/product/by/name?name=${encodeURIComponent(e)}`);p.value=t.data.data||[],m.value=p.value.length>0}catch{F.add({severity:"error",summary:v("error"),detail:v("error_fetching_names"),life:3e3}),p.value=[],m.value=!1}},Z=e=>{l.value.commercial_name=e,p.value=[],m.value=!1},H=e=>{const t=e.target.value;l.value.commercial_name=t,W(t)},K=e=>{e.preventDefault(),f.value=!0},Q=()=>f.value=!1,X=e=>{w.value=e;const t=new FileReader;t.onload=i=>$.value=i.target.result,t.readAsDataURL(e),f.value=!1},j=e=>{var i,u,_;const t=((i=e.target.files)==null?void 0:i[0])||((_=(u=e.dataTransfer)==null?void 0:u.files)==null?void 0:_[0]);t&&t.type.startsWith("image/")&&X(t)},Y=()=>{w.value=null,$.value=null},ee=()=>(c.value.company_id=!l.value.company_id,c.value.commercial_name=!l.value.commercial_name,c.value.price=l.value.price===null||l.value.price==="",c.value.price_unit=!l.value.price_unit,!Object.values(c.value).some(e=>e)),te=async()=>{var t,i;if(!ee())return;V.value=!0;const e=new FormData;e.append("category_id",l.value.category_id||""),e.append("company_id",l.value.company_id||""),e.append("commercial_name",l.value.commercial_name||""),l.value.active_ingredient.forEach((u,_)=>e.append(`scientific_structure[${_}]`,u)),e.append("usage",l.value.usage||""),e.append("calibres",l.value.calibres||""),e.append("quantity",l.value.quantity?Math.floor(l.value.quantity):""),e.append("quantity_unit",l.value.quantity_unit||""),e.append("price",l.value.price?Number(l.value.price).toFixed(2):""),e.append("price_unit",l.value.price_unit||""),e.append("expiration_from",l.value.expiration_from||""),e.append("expiration_to",l.value.expiration_to||""),e.append("storage_notes",l.value.storage_notes||""),e.append("pharmaceutical_form",l.value.pharmaceutical_form||""),w.value&&e.append("product_image",w.value);try{await b.post("/api/product",e),P.push({name:"products"}),F.add({severity:"success",summary:v("success"),detail:v("product_created"),life:3e3})}catch(u){F.add({severity:"error",summary:v("error"),detail:((i=(t=u.response)==null?void 0:t.data)==null?void 0:i.message)||v("error_creating_product"),life:3e3})}finally{V.value=!1}};return ce(()=>{S(),L(),B()}),(e,t)=>{const i=d("Dropdown"),u=d("InputText"),_=d("MultiSelect"),G=d("Textarea"),M=d("InputNumber"),ae=d("Button"),le=d("Form"),oe=d("Toast"),se=de("can");return pe((g(),y("div",ye,[a("h1",fe,s(e.$t("product.create_new_product")),1),n(le,{onSubmit:k(te,["prevent"]),class:"space-y-6"},{default:me(()=>[a("div",be,[a("div",he,[a("label",xe,s(e.$t("product.category")),1),n(i,{id:"category",modelValue:l.value.category_id,"onUpdate:modelValue":t[0]||(t[0]=o=>l.value.category_id=o),options:D.value,optionLabel:"name_ar",optionValue:"id",placeholder:e.$t("product.select_category"),filter:"",onFilter:E,class:"w-full"},null,8,["modelValue","options","placeholder"])]),a("div",Ve,[a("label",we,[h(s(e.$t("product.company"))+" ",1),t[16]||(t[16]=a("span",{class:"text-red-500"},"*",-1))]),n(i,{id:"company",modelValue:l.value.company_id,"onUpdate:modelValue":t[1]||(t[1]=o=>l.value.company_id=o),options:U.value,optionLabel:"name",optionValue:"id",placeholder:e.$t("product.select_company"),filter:"",onFilter:O,class:x(["w-full",{"p-invalid":c.value.company_id}])},null,8,["modelValue","options","placeholder","class"])]),a("div",$e,[a("label",ke,[h(s(e.$t("product.commercial_name"))+" ",1),t[17]||(t[17]=a("span",{class:"text-red-500"},"*",-1))]),n(u,{id:"commercial_name",modelValue:l.value.commercial_name,"onUpdate:modelValue":t[2]||(t[2]=o=>l.value.commercial_name=o),placeholder:e.$t("product.enter_commercial_name"),class:x(["w-full",{"p-invalid":c.value.commercial_name}]),onInput:H,onFocus:t[3]||(t[3]=o=>m.value=p.value.length>0),onBlur:t[4]||(t[4]=o=>e.setTimeout(()=>m.value=!1,200))},null,8,["modelValue","placeholder","class"]),m.value?(g(),y("div",Fe,[a("ul",Ce,[(g(!0),y(ve,null,_e(p.value,o=>(g(),y("li",{key:o.id,onClick:pt=>Z(o.commercial_name),class:"px-4 py-2 text-sm hover:bg-blue-50 cursor-pointer"},s(o.commercial_name),9,De))),128))])])):ge("",!0)]),a("div",Ue,[a("label",qe,s(e.$t("product.active_ingredient")),1),n(_,{id:"active_ingredient",modelValue:l.value.active_ingredient,"onUpdate:modelValue":t[5]||(t[5]=o=>l.value.active_ingredient=o),options:q.value,optionLabel:"name",optionValue:"name",placeholder:e.$t("product.select_active_ingredient"),filter:"",onFilter:J,display:"chip",class:"w-full"},null,8,["modelValue","options","placeholder"])]),a("div",Ie,[a("label",Ne,s(e.$t("product.usage")),1),n(G,{id:"usage",modelValue:l.value.usage,"onUpdate:modelValue":t[6]||(t[6]=o=>l.value.usage=o),placeholder:e.$t("product.enter_usage"),class:"w-full"},null,8,["modelValue","placeholder"])]),a("div",Te,[a("label",Se,s(e.$t("product.calibres")),1),n(u,{id:"calibres",modelValue:l.value.calibres,"onUpdate:modelValue":t[7]||(t[7]=o=>l.value.calibres=o),placeholder:e.$t("product.enter_calibres"),class:"w-full"},null,8,["modelValue","placeholder"])]),a("div",Le,[a("label",Be,s(e.$t("product.quantity")),1),n(M,{id:"quantity",modelValue:l.value.quantity,"onUpdate:modelValue":t[8]||(t[8]=o=>l.value.quantity=o),useGrouping:!1,class:"w-full"},null,8,["modelValue"])]),a("div",je,[a("label",Ge,s(e.$t("product.quantity_unit")),1),n(i,{id:"quantity_unit",modelValue:l.value.quantity_unit,"onUpdate:modelValue":t[9]||(t[9]=o=>l.value.quantity_unit=o),options:[{label:e.$t("tablets"),value:"tablets"},{label:e.$t("capsules"),value:"capsules"},{label:e.$t("units"),value:"units"},{label:e.$t("boxes"),value:"boxes"},{label:e.$t("bottles"),value:"bottles"}],optionLabel:"label",optionValue:"value",placeholder:e.$t("product.select_quantity_unit"),class:"w-full"},null,8,["modelValue","options","placeholder"])]),a("div",Me,[a("label",Pe,[h(s(e.$t("product.price"))+" ",1),t[18]||(t[18]=a("span",{class:"text-red-500"},"*",-1))]),n(M,{id:"price",modelValue:l.value.price,"onUpdate:modelValue":t[10]||(t[10]=o=>l.value.price=o),mode:"decimal",minFractionDigits:2,maxFractionDigits:2,class:x(["w-full",{"p-invalid":c.value.price}])},null,8,["modelValue","class"])]),a("div",Re,[a("label",ze,[h(s(e.$t("product.price_unit"))+" ",1),t[19]||(t[19]=a("span",{class:"text-red-500"},"*",-1))]),n(i,{id:"price_unit",modelValue:l.value.price_unit,"onUpdate:modelValue":t[11]||(t[11]=o=>l.value.price_unit=o),options:[{label:"ل.س",value:"ل.س"},{label:"$",value:"$"}],optionLabel:"label",optionValue:"value",placeholder:e.$t("product.select_price_unit"),class:x(["w-full",{"p-invalid":c.value.price_unit}])},null,8,["modelValue","placeholder","class"])]),a("div",Ae,[a("label",Ee,s(e.$t("product.expiration_from")),1),n(u,{type:"date",modelValue:l.value.expiration_from,"onUpdate:modelValue":t[12]||(t[12]=o=>l.value.expiration_from=o),mode:"decimal",class:"w-full"},null,8,["modelValue"])]),a("div",Oe,[a("label",Je,s(e.$t("product.expiration_to")),1),n(u,{type:"date",modelValue:l.value.expiration_to,"onUpdate:modelValue":t[13]||(t[13]=o=>l.value.expiration_to=o),mode:"decimal",class:"w-full"},null,8,["modelValue"])]),a("div",We,[a("label",Ze,s(e.$t("product.storage_notes")),1),n(G,{id:"storage_notes",modelValue:l.value.storage_notes,"onUpdate:modelValue":t[14]||(t[14]=o=>l.value.storage_notes=o),placeholder:e.$t("product.enter_storage_notes"),class:"w-full"},null,8,["modelValue","placeholder"])]),a("div",He,[a("label",Ke,s(e.$t("product.pharmaceutical_form")),1),n(u,{id:"pharmaceutical_form",modelValue:l.value.pharmaceutical_form,"onUpdate:modelValue":t[15]||(t[15]=o=>l.value.pharmaceutical_form=o),placeholder:e.$t("product.enter_pharmaceutical_form"),class:"w-full"},null,8,["modelValue","placeholder"])]),a("div",Qe,[a("label",Xe,s(e.$t("product.product_image")),1),a("div",Ye,[a("label",{onDragover:k(K,["prevent"]),onDragleave:Q,onDrop:k(j,["prevent"]),class:x([{"border-blue-500 bg-blue-50":f.value,"border-gray-300":!f.value},"cursor-pointer w-full max-w-md rounded-xl border-2 border-dashed transition-colors duration-300"])},[a("input",{type:"file",onChange:j,accept:"image/*",class:"hidden"},null,32),$.value?(g(),y("div",et,[a("div",tt,[a("img",{src:$.value,alt:"Preview",class:"w-full h-64 object-cover rounded-lg shadow-md group-hover:scale-105 transition-transform"},null,8,at),a("div",lt,[a("div",ot,[a("button",{type:"button",onClick:k(Y,["stop"]),class:"bg-red-500 text-white p-2 rounded-full hover:bg-red-600"},[...t[20]||(t[20]=[a("i",{class:"pi pi-trash text-sm"},null,-1)])]),t[21]||(t[21]=a("button",{type:"button",class:"bg-white text-gray-700 p-2 rounded-full hover:bg-gray-100"},[a("i",{class:"pi pi-pencil text-sm"})],-1))])])]),a("p",st,s(e.$t("product.click_or_drag_to_change_photo")),1)])):(g(),y("div",nt,[t[22]||(t[22]=a("div",{class:"bg-blue-100 p-4 rounded-full mb-4"},[a("i",{class:"pi pi-image text-blue-500 text-2xl"})],-1)),a("p",it,[a("span",rt,s(e.$t("product.click_to_upload")),1),h(" "+s(e.$t("product.or_drag_and_drop")),1)]),t[23]||(t[23]=a("p",{class:"text-xs text-gray-400"},"SVG, PNG, JPG أو GIF (حد أقصى 1 ميجا)",-1))]))],34)])])]),a("div",ut,[n(ae,{type:"submit",label:e.$t("product.create_product"),icon:"pi pi-plus",loading:V.value,class:"px-8 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg shadow-md hover:shadow-lg transition-all",disabled:V.value},null,8,["label","loading","disabled"])])]),_:1}),n(oe)])),[[se,"create products"]])}}},vt=ne(ct,[["__scopeId","data-v-e32789e0"]]);export{vt as default};
