import{_ as N,a as I,P as R,u as S,r as h,m as j,o as B,e as d,h as u,g as s,t as n,j as i,i as b,C as x,A as U,B as g,F as V,y as M,b as $,s as O,E as q,k as G}from"./index-2cd76906.js";const W={class:"bg-white min-h-screen"},z={class:"py-12 px-4 max-w-7xl m-auto"},A={class:"flex flex-col items-center justify-center text-center mb-10"},K={class:"text-2xl md:text-3xl font-extrabold text-gray-800"},Q={key:0,class:"flex justify-center mb-10"},H={key:1,class:"bg-white rounded-xl shadow-lg p-6 max-w-4xl mx-auto border border-gray-100"},J={class:"flex flex-col md:flex-row gap-8"},X={class:"flex-shrink-0 md:w-1/3 flex flex-col items-center"},Y=["src","alt"],Z={class:"flex-1 md:w-2/3"},ee={class:"text-3xl font-extrabold text-gray-900 mb-4"},te={class:"space-y-3 mb-6"},ae={class:"text-base text-gray-700"},se={key:0,class:"text-base text-gray-700"},re={class:"font-medium"},ie={key:1,class:"text-base text-gray-700"},oe={class:"font-medium"},ne={key:2,class:"text-base text-gray-700"},le={class:"font-medium"},ce={class:"mb-6 border-t pt-4"},de={class:"flex flex-wrap gap-3"},ue=["title"],me={class:"text-xs font-normal text-gray-600"},pe={key:0,class:"bg-gray-100 text-gray-600 text-sm font-semibold px-3 py-1 rounded-lg"},_e={class:"flex items-center justify-between mt-8 pt-4 border-t"},xe={class:"flex flex-col"},ge={class:"text-xs text-gray-500"},ye={class:"text-3xl font-extrabold text-green-600"},ve={key:2,class:"text-center text-gray-600 py-10"},fe={__name:"product-detail",setup(he){const y=I(),w=R(),{t:e}=S(),t=h(null),v=h(!0),m=h(!1),F=h(localStorage.getItem("appLang")||"en"),k={id:0,commercial_name:"Sample Product",scientific_structure:["Unknown"],price:"0.00",price_unit:"$",pharmaceutical_form:"Unknown",category:{name_en:"Unknown",name_ar:"غير معروف"},company:{name:"Unknown Company"},media:[{url:""}],offers:[],warehouse_id:0,in_cart:!1},E=async()=>{var c,o;v.value=!0;try{const l=await $.get(`/api/pharmacy-home/product/${w.params.id}`);if(l.data&&l.data.data){const r=l.data.data;t.value={...r,discount:r.offers.map(a=>{let p="",f=e("offers.applies");if(a.discount_type===1)p=`${a.discount_value}% OFF`;else if(a.discount_type===2)p=`${a.discount_value} ${r.price_unit||e("currency")} OFF`;else if(a.discount_type===3){const C=a.quantity||1,D=e("offers.giftItem");p=`Buy ${C} Get 1 FREE`,f=`Get ${C}x ${D} FREE`}let _="";return a.min_limit!==null&&a.max_limit!==null?_=e("offers.limits",{min:a.min_limit,max:a.max_limit}):a.min_limit!==null?_=e("offers.minLimit",{min:a.min_limit}):a.max_limit!==null&&(_=e("offers.maxLimit",{max:a.max_limit})),_&&(f=_),a.status==="expired"&&(f=e("offers.expired")),p&&a.status==="active"?{id:a.id,display:p,description:f}:null}).filter(a=>a!==null),tags:((c=r.scientific_structure)==null?void 0:c.length)>0?r.scientific_structure:[e("tags.unknown")]}}else t.value=k,y.add({severity:"warn",summary:e("warning"),detail:e("error.noProduct"),life:3e3})}catch(l){t.value=k;let r=e("error.fetchProduct");((o=l.response)==null?void 0:o.status)===404?r=e("error.productNotFound"):l.code==="ERR_NETWORK"&&(r=e("error.network")),y.add({severity:"error",summary:e("error"),detail:r,life:3e3}),console.error("Error fetching product:",l)}finally{v.value=!1}},L=async c=>{var o,l;m.value=!0;try{const r=await $.post("/api/cart/add/item",{product_id:c,quantity:1});if(r.data.success)t.value&&(t.value.in_cart=!0),y.add({severity:"success",summary:e("success"),detail:e("cart.addSuccess"),life:3e3});else throw new Error(r.data.message||e("error.addToCart"))}catch(r){y.add({severity:"error",summary:e("error"),detail:((l=(o=r.response)==null?void 0:o.data)==null?void 0:l.message)||e("error.addToCart"),life:3e3}),console.error("Error adding to cart:",r)}finally{m.value=!1}},P=c=>({كبسولة:"pi-capsules",حقن:"pi-syringe",قرص:"pi-pill",شراب:"pi-bottle"})[c]||"pi-tablet",T=c=>{c.target.src=""};return j(()=>w.params.id,(c,o)=>{c&&c!==o&&(t.value=null,v.value=!0,E())},{immediate:!1}),B(()=>{E()}),(c,o)=>{var l,r;return d(),u("div",W,[s("div",z,[s("div",A,[s("h2",K,n(i(e)("product.details")),1)]),v.value?(d(),u("div",Q,[b(i(O),{style:{width:"50px",height:"50px"},strokeWidth:"4"})])):t.value&&t.value.id!==0?(d(),u("div",H,[s("div",J,[s("div",X,[(r=(l=t.value.media)==null?void 0:l[0])!=null&&r.url?(d(),u("img",{key:0,src:t.value.media[0].url,alt:t.value.commercial_name,class:"product-image w-full max-w-xs md:max-w-none h-auto object-cover rounded-xl shadow-lg",onError:T},null,40,Y)):x("",!0)]),s("div",Z,[s("h3",ee,n(t.value.commercial_name),1),s("div",te,[s("p",ae,[s("i",{class:U(["pi",P(t.value.pharmaceutical_form),"mr-2 text-green-600"])},null,2),g(" "+n(t.value.pharmaceutical_form||i(e)("unknown")),1)]),t.value.category?(d(),u("p",se,[o[1]||(o[1]=s("i",{class:"pi pi-tag mr-2 text-green-600"},null,-1)),s("span",re,n(i(e)("product.category"))+":",1),g(" "+n(F.value==="ar"?t.value.category.name_ar||i(e)("unknown"):t.value.category.name_en||i(e)("unknown")),1)])):x("",!0),t.value.company?(d(),u("p",ie,[o[2]||(o[2]=s("i",{class:"pi pi-building mr-2 text-green-600"},null,-1)),s("span",oe,n(i(e)("product.company"))+":",1),g(" "+n(t.value.company.name||i(e)("unknown")),1)])):x("",!0),t.value.expiration_to?(d(),u("p",ne,[o[3]||(o[3]=s("i",{class:"pi pi-calendar-times mr-2 text-red-600"},null,-1)),s("span",le,n(i(e)("product.expires"))+":",1),g(" "+n(new Date(t.value.expiration_to).toLocaleDateString()),1)])):x("",!0)]),s("div",ce,[s("div",de,[(d(!0),u(V,null,M(t.value.discount,a=>(d(),u("span",{key:a.id,class:"bg-green-50 text-green-700 text-sm font-semibold px-3 py-1 rounded-lg border border-green-200",title:a.description},[g(n(a.display)+" ",1),s("span",me,"("+n(a.description)+")",1)],8,ue))),128)),!t.value.discount||t.value.discount.length===0?(d(),u("span",pe)):x("",!0)])]),s("div",_e,[s("div",xe,[s("span",ge,n(i(e)("product.price")),1),s("span",ye,n(parseFloat(t.value.price).toLocaleString())+" "+n(t.value.price_unit||i(e)("currency")),1)]),b(i(q),{label:m.value?i(e)("cart.adding"):t.value.in_cart?i(e)("cart.inCart"):i(e)("cart.addToCart"),icon:m.value?"pi pi-spin pi-spinner":"pi pi-cart-plus",disabled:m.value||t.value.id===0,class:"bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg transition-colors text-lg",onClick:o[0]||(o[0]=a=>L(t.value.id)),"aria-label":i(e)("cart.addToCart")+" "+t.value.commercial_name},null,8,["label","icon","disabled","aria-label"])])])])])):(d(),u("div",ve,n(i(e)("error.noProduct")),1)),b(i(G))])])}}},we=N(fe,[["__scopeId","data-v-844b11d2"]]);export{we as default};
