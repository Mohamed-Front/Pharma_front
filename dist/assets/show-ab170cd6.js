import{u as W,z,P as F,a as M,r as p,o as G,d as u,e as $,h as k,g as e,B as H,t as s,j as i,i as l,w as m,b as q,C as J}from"./index-2cd76906.js";const K={class:"p-6 md:p-10 bg-gray-100 min-h-screen"},O={class:"container mx-auto"},Q={class:"bg-white shadow-2xl rounded-2xl p-6 lg:p-10"},X={class:"flex flex-col md:flex-row items-start md:items-center justify-between mb-8 pb-4 border-b-2 border-gray-200"},Y={class:"text-3xl font-extrabold text-gray-800"},Z={class:"text-indigo-600"},ee={class:"flex flex-col md:flex-row"},te={key:0,class:"flex items-center justify-center h-64"},se={key:1,class:"space-y-8"},oe={class:"grid grid-cols-1 md:grid-cols-2 gap-8 p-6 bg-gray-50 rounded-xl shadow-inner"},ie={class:"space-y-4"},ae={class:"field"},le={class:"font-semibold text-gray-600"},ne={class:"text-gray-900 text-lg font-medium"},de={class:"field"},ce={class:"font-semibold text-gray-600"},re={class:"text-gray-900 text-lg font-medium"},ue={class:"field"},ve={class:"font-semibold text-gray-600"},_e={class:"text-gray-900 text-lg font-medium"},pe={class:"space-y-4"},me={class:"field"},ge={class:"font-semibold text-gray-600"},he={class:"field"},ye={class:"font-semibold text-gray-600"},be={class:"text-gray-900 text-lg font-medium"},xe={class:"field"},fe={class:"font-semibold text-gray-600"},we={class:"text-gray-900 text-lg font-medium"},$e={class:"field"},ke={class:"font-semibold text-gray-600"},Pe={class:"text-gray-900 text-lg font-medium"},Ce={class:"field"},Ne={class:"font-semibold text-gray-600"},De={class:"text-gray-900 text-lg font-medium"},Te={class:"field"},Se={class:"font-semibold text-gray-600"},Ae={class:"text-gray-900 text-lg font-medium"},Ie={class:"field"},Ve={class:"font-semibold text-gray-600"},Be={class:"text-gray-900 text-lg font-medium"},Ee={class:"bg-gray-50 p-6 rounded-xl shadow-inner"},Ue={class:"text-2xl font-bold text-gray-800 mb-4"},je={class:"py-10 text-center text-gray-500"},qe={class:"text-lg"},Le={key:2,class:"py-20 text-center text-gray-500"},Re={class:"text-2xl font-semibold"},We={key:0,class:"space-y-6 p-4"},ze={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Fe={class:"space-y-4"},Me={class:"field"},Ge={class:"font-semibold text-gray-600"},He={class:"text-gray-900 text-lg font-medium"},Je={class:"field"},Ke={class:"font-semibold text-gray-600"},Oe={class:"text-gray-900 text-lg font-medium"},Qe={class:"field"},Xe={class:"font-semibold text-gray-600"},Ye={class:"text-gray-900 text-lg font-medium"},Ze={class:"space-y-4"},et={class:"field"},tt={class:"font-semibold text-gray-600"},st={class:"field"},ot={class:"font-semibold text-gray-600"},it={class:"text-gray-900 text-lg font-medium"},at={class:"field"},lt={class:"font-semibold text-gray-600"},nt={class:"text-gray-900 text-lg font-medium"},dt={class:"field"},ct={class:"font-semibold text-gray-600"},rt={class:"text-gray-900 text-lg font-medium"},ut={class:"field"},vt={class:"font-semibold text-gray-600"},_t={class:"text-gray-900 text-lg font-medium"},pt={class:"field"},mt={class:"font-semibold text-gray-600"},gt={class:"text-gray-900 text-lg font-medium"},ht={class:"field"},yt={class:"font-semibold text-gray-600"},bt={class:"text-gray-900 text-lg font-medium"},xt={class:"space-y-6 p-4"},ft={class:"field"},wt={class:"font-semibold my-1 text-gray-600"},Pt={__name:"show",setup($t){const{t}=W();z();const V=F(),P=M(),C=p(!0),o=p(null),N=p(!1),g=p(!1),c=p(""),_=p(!1),B=d=>{switch(d==null?void 0:d.toLowerCase()){case"unpaid":return"warning";case"paid":return"success";case"cancelled":return"danger";default:return"info"}},E=async()=>{C.value=!0;try{const d=await q.get(`/api/invoice/${V.params.id}`);o.value=d.data.data}catch(d){P.add({severity:"error",summary:t("error"),detail:t("invoice.loadError"),life:3e3}),console.error("Error fetching invoice:",d)}finally{C.value=!1}},L=async()=>{if(!c.value||isNaN(c.value)||c.value<=0){P.add({severity:"error",summary:t("error"),detail:t("invoice.invalidAmount"),life:3e3});return}_.value=!0;try{await q.post(`/api/invoice/pay/${V.params.id}`,{amount:Number(c.value)}),P.add({severity:"success",summary:t("success"),detail:t("invoice.paymentSuccess"),life:3e3}),g.value=!1,c.value="",await E()}catch(d){P.add({severity:"error",summary:t("error"),detail:t("invoice.paymentError"),life:3e3}),console.error("Error processing payment:",d)}finally{_.value=!1}},R=()=>{var a,r,D,T,h,v,S,y,A,b,x,f,n,w,U;const d=window.open("","_blank");d.document.write(`
    <html>
      <head>
        <title> #${((a=o.value)==null?void 0:a.number)||""}</title>
        <style>
          body { font-family: Arial, sans-serif; padding: 20px; }
          .invoice-container { max-width: 800px; margin: 0 auto;text-align: right; }
          .invoice-header {  margin-bottom: 20px; }
          .invoice-details { margin-bottom: 20px; }
          .invoice-details p { margin: 5px 0; }
          .items-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
          .items-table th, .items-table td { border: 1px solid #ddd; padding: 8px;  }
          .items-table th { background-color: #f4f4f4; }
          @media print {
            .no-print { display: none; }
          }
        </style>
      </head>
      <body>
        <div class="invoice-container">
          <div class="invoice-header">
            <h1> ${((r=o.value)==null?void 0:r.number)||""} ${t("invoice.printTitle")}</h1>
          </div>
          <div class="invoice-details">
            <p><strong>${t("invoice.pharmacy")}:</strong> ${((T=(D=o.value)==null?void 0:D.pharmacy)==null?void 0:T.name)||"-"}</p>
            <p><strong>${t("invoice.warehouse")}:</strong> ${((v=(h=o.value)==null?void 0:h.warehouse)==null?void 0:v.name)||"-"}</p>
            <p><strong>${t("invoice.status")}:</strong> ${((S=o.value)==null?void 0:S.status_description)||"-"}</p>
            <p><strong>${t("invoice.originalPrice")}:</strong> ${((y=o.value)==null?void 0:y.original_price)||"-"}</p>
            <p><strong>${t("invoice.delivery")}:</strong> ${((A=o.value)==null?void 0:A.delivery)||"-"}</p>
            <p><strong>${t("invoice.totalDiscounts")}:</strong> ${((b=o.value)==null?void 0:b.total_discounts)||"-"}</p>
            <p><strong>${t("invoice.totalPrice")}:</strong> ${((x=o.value)==null?void 0:x.total_price)||"-"}</p>
            <p><strong>${t("invoice.totalPaid")}:</strong> ${((f=o.value)==null?void 0:f.total_paid)||"-"}</p>
            <p><strong>${t("invoice.createdAt")}:</strong> ${((n=o.value)==null?void 0:n.created_at)||"-"}</p>
          </div>
          <table class="items-table">
            <thead>
              <tr>
                <th>${t("invoice.itemName")}</th>
                <th>${t("invoice.quantity")}</th>
                <th>${t("invoice.price")}</th>
                <th>${t("invoice.total")}</th>
              </tr>
            </thead>
            <tbody>
              ${(U=(w=o.value)==null?void 0:w.items)==null?void 0:U.map(I=>{var j;return`
                <tr>
                  <td>${((j=I.product)==null?void 0:j.commercial_name)||"-"}</td>
                  <td>${I.quantity||"-"}</td>
                  <td>${I.original_price||"-"}</td>
                  <td>${I.total_price||"-"}</td>
                </tr>
              `}).join("")}
            </tbody>
          </table>
        </div>
      </body>
    </html>
  `),d.document.close(),d.print()};return G(()=>{E()}),(d,a)=>{var b,x,f;const r=u("Button"),D=u("Toast"),T=u("ProgressSpinner"),h=u("Tag"),v=u("Column"),S=u("DataTable"),y=u("Dialog"),A=u("InputNumber");return $(),k("div",K,[e("div",O,[e("div",Q,[e("div",X,[e("h1",Y,[H(s(i(t)("invoice.detailsTitle"))+" ",1),e("span",Z,"#"+s(((b=o.value)==null?void 0:b.number)||"..."),1)]),e("div",ee,[l(r,{label:i(t)("invoice.print"),icon:"pi pi-print",class:"px-6 py-2 rounded-full bg-indigo-600 text-white hover:bg-indigo-700 transition-colors duration-200",onClick:R},null,8,["label"]),l(r,{label:i(t)("invoice.viewDetails"),icon:"pi pi-file",class:"px-6 py-2 mx-1 rounded-full bg-blue-600 text-white hover:bg-blue-700 transition-colors duration-200",onClick:a[0]||(a[0]=n=>N.value=!0)},null,8,["label"]),l(r,{label:i(t)("invoice.pay"),icon:"pi pi-money-bill",class:"px-6 py-2 rounded-full bg-green-600 text-white hover:bg-green-700 transition-colors duration-200",onClick:a[1]||(a[1]=n=>g.value=!0)},null,8,["label"])])]),l(D),C.value?($(),k("div",te,[l(T,{style:{width:"60px",height:"60px"},strokeWidth:"4",class:"text-indigo-600"})])):o.value?($(),k("div",se,[e("div",oe,[e("div",ie,[e("div",ae,[e("label",le,s(i(t)("invoice.invoiceNumber")),1),e("p",ne,s(o.value.number),1)]),e("div",de,[e("label",ce,s(i(t)("invoice.pharmacy")),1),e("p",re,s(((x=o.value.pharmacy)==null?void 0:x.name)||"-"),1)]),e("div",ue,[e("label",ve,s(i(t)("invoice.warehouse")),1),e("p",_e,s(((f=o.value.warehouse)==null?void 0:f.name)||"-"),1)])]),e("div",pe,[e("div",me,[e("label",ge,s(i(t)("invoice.status")),1),l(h,{value:o.value.status_description,severity:B(o.value.status_description),class:"px-3 py-1 text-sm font-semibold rounded-full"},null,8,["value","severity"])]),e("div",he,[e("label",ye,s(i(t)("invoice.originalPrice")),1),e("p",be,s(o.value.original_price),1)]),e("div",xe,[e("label",fe,s(i(t)("invoice.delivery")),1),e("p",we,s(o.value.delivery),1)]),e("div",$e,[e("label",ke,s(i(t)("invoice.totalDiscounts")),1),e("p",Pe,s(o.value.total_discounts),1)]),e("div",Ce,[e("label",Ne,s(i(t)("invoice.totalPrice")),1),e("p",De,s(o.value.total_price),1)]),e("div",Te,[e("label",Se,s(i(t)("invoice.totalPaid")),1),e("p",Ae,s(o.value.total_paid),1)]),e("div",Ie,[e("label",Ve,s(i(t)("invoice.createdAt")),1),e("p",Be,s(o.value.created_at),1)])])]),e("div",Ee,[e("h3",Ue,s(i(t)("invoice.items")),1),l(S,{value:o.value.items,loading:C.value,"data-key":"item_id","responsive-layout":"scroll",class:"rounded-lg overflow-hidden border border-gray-200"},{empty:m(()=>[e("div",je,[a[7]||(a[7]=e("i",{class:"pi pi-exclamation-circle text-4xl mb-2"},null,-1)),e("p",qe,s(i(t)("invoice.noItems")),1)])]),default:m(()=>[l(v,{field:"product.commercial_name",header:i(t)("invoice.itemName"),"header-style":"width:30%;"},null,8,["header"]),l(v,{field:"quantity",header:i(t)("invoice.quantity"),"header-style":"width:20%;"},null,8,["header"]),l(v,{field:"original_price",header:i(t)("invoice.price"),"header-style":"width:20%;"},null,8,["header"]),l(v,{field:"total_price",header:i(t)("invoice.total"),"header-style":"width:20%;"},null,8,["header"])]),_:1},8,["value","loading"])])])):($(),k("div",Le,[a[8]||(a[8]=e("i",{class:"pi pi-exclamation-circle text-6xl mb-4"},null,-1)),e("p",Re,s(i(t)("invoice.notFound")),1)])),l(y,{visible:N.value,"onUpdate:visible":a[3]||(a[3]=n=>N.value=n),header:i(t)("invoice.detailsTitle"),modal:!0,style:{width:"50vw"},class:"rounded-lg",breakpoints:{"960px":"75vw","640px":"90vw"}},{footer:m(()=>[l(r,{label:i(t)("invoice.close"),icon:"pi pi-times",class:"p-button-text p-button-secondary",onClick:a[2]||(a[2]=n=>N.value=!1)},null,8,["label"])]),default:m(()=>{var n,w;return[o.value?($(),k("div",We,[e("div",ze,[e("div",Fe,[e("div",Me,[e("label",Ge,s(i(t)("invoice.invoiceNumber")),1),e("p",He,s(o.value.number),1)]),e("div",Je,[e("label",Ke,s(i(t)("invoice.pharmacy")),1),e("p",Oe,s(((n=o.value.pharmacy)==null?void 0:n.name)||"-"),1)]),e("div",Qe,[e("label",Xe,s(i(t)("invoice.warehouse")),1),e("p",Ye,s(((w=o.value.warehouse)==null?void 0:w.name)||"-"),1)])]),e("div",Ze,[e("div",et,[e("label",tt,s(i(t)("invoice.status")),1),l(h,{value:o.value.status_description,severity:B(o.value.status_description),class:"px-3 py-1 text-sm font-semibold rounded-full"},null,8,["value","severity"])]),e("div",st,[e("label",ot,s(i(t)("invoice.originalPrice")),1),e("p",it,s(o.value.original_price),1)]),e("div",at,[e("label",lt,s(i(t)("invoice.delivery")),1),e("p",nt,s(o.value.delivery),1)]),e("div",dt,[e("label",ct,s(i(t)("invoice.totalDiscounts")),1),e("p",rt,s(o.value.total_discounts),1)]),e("div",ut,[e("label",vt,s(i(t)("invoice.totalPrice")),1),e("p",_t,s(o.value.total_price),1)]),e("div",pt,[e("label",mt,s(i(t)("invoice.totalPaid")),1),e("p",gt,s(o.value.total_paid),1)]),e("div",ht,[e("label",yt,s(i(t)("invoice.createdAt")),1),e("p",bt,s(o.value.created_at),1)])])])])):J("",!0)]}),_:1},8,["visible","header"]),l(y,{visible:g.value,"onUpdate:visible":a[6]||(a[6]=n=>g.value=n),header:i(t)("invoice.makePayment"),modal:!0,style:{width:"40vw"},class:"rounded-lg",breakpoints:{"960px":"75vw","640px":"90vw"}},{footer:m(()=>[l(r,{label:i(t)("invoice.cancel"),icon:"pi pi-times",class:"p-button-text p-button-secondary",disabled:_.value,onClick:a[5]||(a[5]=n=>{g.value=!1,c.value=""})},null,8,["label","disabled"]),l(r,{label:i(t)("invoice.pay"),icon:"pi pi-check",class:"p-button-success",loading:_.value,disabled:!c.value||_.value,onClick:L},null,8,["label","loading","disabled"])]),default:m(()=>[e("div",xt,[e("div",ft,[e("p",wt,s(i(t)("invoice.paymentAmount")),1),l(A,{modelValue:c.value,"onUpdate:modelValue":a[4]||(a[4]=n=>c.value=n),mode:"currency",currency:"USD",locale:"en-US",min:0,class:"w-full",disabled:_.value},null,8,["modelValue","disabled"])])])]),_:1},8,["visible","header"])])])])}}};export{Pt as default};
