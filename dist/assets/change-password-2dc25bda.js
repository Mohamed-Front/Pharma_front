import{a2 as V,u as B,P as z,z as D,r as u,Y as M,o as N,d as q,e as a,h as n,g as o,t,B as w,i as g,w as x,C as p,D as P,Z as b,ar as v,A as y,b as U}from"./index-2cd76906.js";const j={class:"bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8"},A={class:"w-full"},F={class:"mt-6 text-center text-3xl font-extrabold text-gray-900"},R={class:"mt-2 text-center text-sm text-gray-600"},S={class:"mt-8 sm:mx-auto sm:w-full sm:max-w-md"},E={class:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10"},H={key:0,class:"mb-6 p-4 bg-green-50 border border-green-200 text-green-800 rounded-md text-center"},I={key:1,class:"mb-6 p-4 bg-red-50 border border-red-200 text-red-800 rounded-md"},T={for:"password",class:"block text-sm font-medium text-gray-700"},Y={class:"mt-1 relative"},Z=["type"],G={key:0,class:"mt-1 text-sm text-red-600"},J={for:"confirmation_password",class:"block text-sm font-medium text-gray-700"},K={class:"mt-1"},L=["type"],O={key:0,class:"mt-1 text-sm text-red-600"},Q=["disabled"],W={key:0},X={key:1,class:"flex items-center"},ss={class:"mt-6 text-center"},ts=V({__name:"change-password",setup(es){const{t:i}=B(),k=z();D();const f=u(""),m=u(!1),_=u(!1),l=u(null),h=u(!1),s=M({password:"",confirmation_password:"",errors:{password:"",confirmation_password:""}});N(()=>{const e=k.params.number;if(!e){l.value=i("auth.invalid_or_missing_token");return}f.value=e});const C=()=>{let e=!0;return s.errors.password="",s.errors.confirmation_password="",s.password.length<6&&(s.errors.password=i("auth.password_too_short"),e=!1),s.password!==s.confirmation_password&&(s.errors.confirmation_password=i("auth.passwords_do_not_match"),e=!1),e},$=async()=>{var e,r;if(C()){m.value=!0,l.value=null;try{await U.post("/api/change-password-request/update-password",{number:f.value,password:s.password,confirmation_password:s.confirmation_password}),_.value=!0}catch(c){const d=((r=(e=c.response)==null?void 0:e.data)==null?void 0:r.message)||c.message||i("auth.change_password_failed");l.value=typeof d=="string"?d:i("auth.change_password_failed")}finally{m.value=!1}}};return(e,r)=>{const c=q("router-link");return a(),n("div",j,[o("div",A,[o("h2",F,t(e.$t("auth.change_password")),1),o("p",R,t(e.$t("auth.enter_new_password")),1)]),o("div",S,[o("div",E,[_.value?(a(),n("div",H,[w(t(e.$t("auth.password_changed_successfully"))+" ",1),g(c,{to:{name:"login"},class:"underline font-medium"},{default:x(()=>[w(t(e.$t("auth.sign_in_now")),1)]),_:1})])):p("",!0),l.value?(a(),n("div",I,t(l.value),1)):p("",!0),_.value?p("",!0):(a(),n("form",{key:2,onSubmit:P($,["prevent"]),class:"space-y-6"},[o("div",null,[o("label",T,t(e.$t("auth.new_password")),1),o("div",Y,[b(o("input",{id:"password","onUpdate:modelValue":r[0]||(r[0]=d=>s.password=d),type:h.value?"text":"password",required:"",minlength:"6",class:y(["appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm",{"border-red-500":s.errors.password}])},null,10,Z),[[v,s.password]])]),s.errors.password?(a(),n("p",G,t(s.errors.password),1)):p("",!0)]),o("div",null,[o("label",J,t(e.$t("auth.confirm_new_password")),1),o("div",K,[b(o("input",{id:"confirmation_password","onUpdate:modelValue":r[1]||(r[1]=d=>s.confirmation_password=d),type:h.value?"text":"password",required:"",class:y(["appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm",{"border-red-500":s.errors.confirmation_password}])},null,10,L),[[v,s.confirmation_password]])]),s.errors.confirmation_password?(a(),n("p",O,t(s.errors.confirmation_password),1)):p("",!0)]),o("div",null,[o("button",{type:"submit",disabled:m.value,class:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed transition"},[m.value?(a(),n("span",X,[r[2]||(r[2]=o("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[o("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),o("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)),w(" "+t(e.$t("common.processing")),1)])):(a(),n("span",W,t(e.$t("auth.change_password")),1))],8,Q)])],32)),o("div",ss,[g(c,{to:{name:"login"},class:"text-sm text-green-600 hover:text-green-500"},{default:x(()=>[w(" ‚Üê "+t(e.$t("auth.back_to_login")),1)]),_:1})])])])])}}});export{ts as default};
