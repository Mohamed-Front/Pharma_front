import{_ as D,i as F,j,u as B,r as y,w as C,d as E,a5 as G,o as v,c as f,S as L,k as a,t as d,q as r,z as u,l as _,m as o,y as g,C as N,F as O,B as V,a8 as b,aq as m,H as $,R as M,D as R,A as S}from"./index-d45c326e.js";const z={class:"max-w-5xl mx-auto p-6 bg-white rounded-xl shadow-lg"},I={class:"text-3xl font-bold text-center mb-8 text-gray-800"},T={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},A={class:"space-y-2"},H={for:"product",class:"block text-sm font-medium text-gray-700"},J={class:"space-y-2"},K={for:"quantity",class:"block text-sm font-medium text-gray-700"},P={class:"space-y-2"},Q={for:"quantity_unit",class:"block text-sm font-medium text-gray-700"},W={class:"space-y-2"},X={for:"discount_type",class:"block text-sm font-medium text-gray-700"},Y={key:0,class:"space-y-2"},Z={for:"discount_value",class:"block text-sm font-medium text-gray-700"},ee={key:0,class:"text-gray-500"},te={key:1,class:"space-y-2"},le={for:"gift_product_id",class:"block text-sm font-medium text-gray-700"},ae={key:2,class:"space-y-2"},se={for:"gift_quantity",class:"block text-sm font-medium text-gray-700"},ie={class:"space-y-2"},ue={for:"min_limit",class:"block text-sm font-medium text-gray-700"},oe={class:"space-y-2"},ne={for:"max_limit",class:"block text-sm font-medium text-gray-700"},de={class:"space-y-2"},re={for:"start_date",class:"block text-sm font-medium text-gray-700"},_e={class:"space-y-2"},ce={for:"end_date",class:"block text-sm font-medium text-gray-700"},ve={class:"space-y-2 md:col-span-2"},fe={for:"description",class:"block text-sm font-medium text-gray-700"},me={class:"pt-6 flex justify-center"},pe={__name:"create",setup(ye){const w=F(),p=j(),{t:c}=B(),x=y(!1),q=y([]),e=y({product_id:null,min_limit:null,max_limit:null,quantity:null,quantity_unit:null,discount_type:null,discount_value:null,gift_product_id:null,gift_quantity:null,start_date:null,end_date:null,description:""}),s=y({product_id:!1,min_limit:!1,max_limit:!1,quantity:!1,quantity_unit:!1,discount_type:!1,discount_value:!1,gift_product_id:!1,gift_quantity:!1,start_date:!1,end_date:!1}),h=async()=>{try{const l=await V.get("/api/product");q.value=l.data.data}catch(l){console.error("Error fetching products:",l),p.add({severity:"error",summary:c("error"),detail:c("error_fetching_data"),life:3e3})}};C(()=>e.value.discount_type,l=>{l!==3&&(e.value.gift_product_id=null,e.value.gift_quantity=null),l===3&&(e.value.discount_value=null)});const k=()=>{if(Object.keys(s.value).forEach(l=>{s.value[l]=!1}),s.value.product_id=!e.value.product_id,s.value.quantity=e.value.quantity===null||e.value.quantity==="",s.value.quantity_unit=!e.value.quantity_unit,s.value.discount_type=!e.value.discount_type,s.value.min_limit=e.value.min_limit===null||e.value.min_limit==="",s.value.max_limit=e.value.max_limit===null||e.value.max_limit==="",s.value.start_date=!e.value.start_date,s.value.end_date=!e.value.end_date,e.value.discount_type===3?(s.value.gift_product_id=!e.value.gift_product_id,s.value.gift_quantity=e.value.gift_quantity===null||e.value.gift_quantity==="",s.value.discount_value=!1):s.value.discount_value=e.value.discount_value===null||e.value.discount_value==="",e.value.min_limit!=null&&e.value.max_limit!=null&&(s.value.max_limit=s.value.max_limit||e.value.min_limit>e.value.max_limit),e.value.quantity!=null&&e.value.min_limit!=null&&e.value.max_limit!=null&&(s.value.quantity=s.value.quantity||e.value.quantity<e.value.min_limit||e.value.quantity>e.value.max_limit),e.value.discount_type===1&&e.value.discount_value!=null&&(s.value.discount_value=s.value.discount_value||e.value.discount_value<0||e.value.discount_value>100),e.value.discount_type===2&&e.value.discount_value!=null&&(s.value.discount_value=s.value.discount_value||e.value.discount_value<0),e.value.start_date&&e.value.end_date){const l=new Date(e.value.start_date);new Date(e.value.end_date)<l&&(s.value.end_date=!0,p.add({severity:"error",summary:c("error"),detail:c("end_date_before_start"),life:3e3}))}return!Object.values(s.value).some(l=>l)},U=async()=>{var l,t;if(k()){x.value=!0;try{const n={...e.value};n.discount_type!==3&&(delete n.gift_product_id,delete n.gift_quantity),n.discount_type===3&&delete n.discount_value,await V.post("/api/offer",n),p.add({severity:"success",summary:c("success"),detail:c("offer_created"),life:3e3}),w.push({name:"offers"})}catch(n){console.error("Error:",n);let i=c("error_creating_offer");((l=n.response)==null?void 0:l.status)===422?i=Object.values(n.response.data.errors).flat().join(", "):((t=n.response)==null?void 0:t.status)===500&&(i=c("server_error")),p.add({severity:"error",summary:c("error"),detail:i,life:3e3})}finally{x.value=!1}}};return E(()=>{h()}),(l,t)=>{const n=G("can");return v(),f(O,null,[L((v(),f("div",z,[a("h1",I,d(l.$t("offer.create_new_offer")),1),a("form",{onSubmit:N(U,["prevent"]),class:"space-y-6"},[a("div",T,[a("div",A,[a("label",H,[r(d(l.$t("offer.product"))+" ",1),t[12]||(t[12]=a("span",{class:"text-red-500"},"*",-1))]),u(o(b),{filter:"",id:"product",modelValue:e.value.product_id,"onUpdate:modelValue":t[0]||(t[0]=i=>e.value.product_id=i),options:q.value,optionLabel:"commercial_name",optionValue:"id",placeholder:l.$t("offer.select_product"),class:_(["w-full",{"p-invalid":s.value.product_id}])},null,8,["modelValue","options","placeholder","class"])]),a("div",J,[a("label",K,[r(d(l.$t("offer.quantity"))+" ",1),t[13]||(t[13]=a("span",{class:"text-red-500"},"*",-1))]),u(o(m),{id:"quantity",modelValue:e.value.quantity,"onUpdate:modelValue":t[1]||(t[1]=i=>e.value.quantity=i),useGrouping:!1,placeholder:l.$t("offer.enter_quantity"),class:_(["w-full",{"p-invalid":s.value.quantity}])},null,8,["modelValue","placeholder","class"])]),a("div",P,[a("label",Q,[r(d(l.$t("offer.quantity_unit"))+" ",1),t[14]||(t[14]=a("span",{class:"text-red-500"},"*",-1))]),u(o(b),{id:"quantity_unit",modelValue:e.value.quantity_unit,"onUpdate:modelValue":t[2]||(t[2]=i=>e.value.quantity_unit=i),options:[{label:"Tablets",value:1},{label:"Capsules",value:2},{label:"Units",value:3},{label:"Bottle",value:4},{label:"Can",value:5}],optionLabel:"label",optionValue:"value",placeholder:l.$t("offer.select_quantity_unit"),class:_(["w-full",{"p-invalid":s.value.quantity_unit}])},null,8,["modelValue","placeholder","class"])]),a("div",W,[a("label",X,[r(d(l.$t("offer.discount_type"))+" ",1),t[15]||(t[15]=a("span",{class:"text-red-500"},"*",-1))]),u(o(b),{id:"discount_type",modelValue:e.value.discount_type,"onUpdate:modelValue":t[3]||(t[3]=i=>e.value.discount_type=i),options:[{label:l.$t("offer.percentage"),value:1},{label:l.$t("offer.fixed_amount"),value:2},{label:l.$t("offer.gift"),value:3}],optionLabel:"label",optionValue:"value",placeholder:l.$t("offer.select_discount_type"),class:_(["w-full",{"p-invalid":s.value.discount_type}])},null,8,["modelValue","options","placeholder","class"])]),e.value.discount_type===1||e.value.discount_type===2?(v(),f("div",Y,[a("label",Z,[r(d(e.value.discount_type===1?l.$t("offer.percentage"):l.$t("offer.fixed_amount"))+" ",1),t[16]||(t[16]=a("span",{class:"text-red-500"},"*",-1))]),u(o(m),{id:"discount_value",modelValue:e.value.discount_value,"onUpdate:modelValue":t[4]||(t[4]=i=>e.value.discount_value=i),mode:(e.value.discount_type===1,"decimal"),minFractionDigits:e.value.discount_type===1?0:2,maxFractionDigits:(e.value.discount_type===1,2),min:(e.value.discount_type===1,0),max:e.value.discount_type===1?100:null,placeholder:l.$t("offer.enter_discount_value"),class:_(["w-full",{"p-invalid":s.value.discount_value}])},null,8,["modelValue","mode","minFractionDigits","maxFractionDigits","min","max","placeholder","class"]),e.value.discount_type===1?(v(),f("small",ee,"Max 100%")):g("",!0)])):g("",!0),e.value.discount_type===3?(v(),f("div",te,[a("label",le,[r(d(l.$t("offer.gift_product"))+" ",1),t[17]||(t[17]=a("span",{class:"text-red-500"},"*",-1))]),u(o(b),{filter:"",id:"gift_product_id",modelValue:e.value.gift_product_id,"onUpdate:modelValue":t[5]||(t[5]=i=>e.value.gift_product_id=i),options:q.value,optionLabel:"commercial_name",optionValue:"id",placeholder:l.$t("offer.select_gift_product"),class:_(["w-full",{"p-invalid":s.value.gift_product_id}])},null,8,["modelValue","options","placeholder","class"])])):g("",!0),e.value.discount_type===3?(v(),f("div",ae,[a("label",se,[r(d(l.$t("offer.gift_quantity"))+" ",1),t[18]||(t[18]=a("span",{class:"text-red-500"},"*",-1))]),u(o(m),{id:"gift_quantity",modelValue:e.value.gift_quantity,"onUpdate:modelValue":t[6]||(t[6]=i=>e.value.gift_quantity=i),useGrouping:!1,min:1,placeholder:l.$t("offer.enter_gift_quantity"),class:_(["w-full",{"p-invalid":s.value.gift_quantity}])},null,8,["modelValue","placeholder","class"])])):g("",!0),a("div",ie,[a("label",ue,[r(d(l.$t("offer.min_limit_tooltip"))+" ",1),t[19]||(t[19]=a("span",{class:"text-red-500"},"*",-1))]),u(o(m),{id:"min_limit",modelValue:e.value.min_limit,"onUpdate:modelValue":t[7]||(t[7]=i=>e.value.min_limit=i),useGrouping:!1,placeholder:l.$t("offer.enter_min_limit"),class:_(["w-full",{"p-invalid":s.value.min_limit}])},null,8,["modelValue","placeholder","class"])]),a("div",oe,[a("label",ne,[r(d(l.$t("offer.max_limit_tooltip"))+" ",1),t[20]||(t[20]=a("span",{class:"text-red-500"},"*",-1))]),u(o(m),{id:"max_limit",modelValue:e.value.max_limit,"onUpdate:modelValue":t[8]||(t[8]=i=>e.value.max_limit=i),useGrouping:!1,placeholder:l.$t("offer.enter_max_limit"),class:_(["w-full",{"p-invalid":s.value.max_limit}])},null,8,["modelValue","placeholder","class"])]),a("div",de,[a("label",re,[r(d(l.$t("offer.start_date"))+" ",1),t[21]||(t[21]=a("span",{class:"text-red-500"},"*",-1))]),u(o($),{id:"start_date",modelValue:e.value.start_date,"onUpdate:modelValue":t[9]||(t[9]=i=>e.value.start_date=i),type:"date",class:_(["w-full",{"p-invalid":s.value.start_date}])},null,8,["modelValue","class"])]),a("div",_e,[a("label",ce,[r(d(l.$t("offer.end_date"))+" ",1),t[22]||(t[22]=a("span",{class:"text-red-500"},"*",-1))]),u(o($),{id:"end_date",modelValue:e.value.end_date,"onUpdate:modelValue":t[10]||(t[10]=i=>e.value.end_date=i),type:"date",class:_(["w-full",{"p-invalid":s.value.end_date}])},null,8,["modelValue","class"])]),a("div",ve,[a("label",fe,d(l.$t("offer.description")),1),u(o(M),{id:"description",modelValue:e.value.description,"onUpdate:modelValue":t[11]||(t[11]=i=>e.value.description=i),placeholder:l.$t("offer.enter_description"),class:"w-full",rows:"4"},null,8,["modelValue","placeholder"])])]),a("div",me,[u(o(R),{type:"submit",label:l.$t("offer.create_offer"),icon:"pi pi-plus",loading:x.value,class:"px-8 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-300"},null,8,["label","loading"])])],32)])),[[n,"create offers"]]),u(o(S))],64)}}},be=D(pe,[["__scopeId","data-v-c89d2876"]]);export{be as default};
