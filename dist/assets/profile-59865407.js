import{_ as X,X as Y,u as K,j as Q,i as Z,r as m,d as ee,o as p,c,k as e,m as s,t as n,l as C,q as D,z as d,F as te,x as le,v as w,B as $,E as ae,D as k,H as v,s as se,y as oe,C as V,Y as I,A as re}from"./index-d45c326e.js";import{O as ne,x as ie}from"./index.es-c3e6217d.js";const de={class:"bg-gray-50 min-h-screen p-4 md:p-8"},pe={class:"bg-white rounded-xl shadow-md p-6 flex flex-col md:flex-row items-center justify-between gap-6 mb-8"},ce={class:"flex flex-col-reverse md:flex-row items-center text-center gap-6"},ue=["src","alt"],me={class:"flex flex-col items-center gap-2"},ge={class:"text-2xl md:text-3xl font-bold text-gray-900"},ve={class:"flex items-center gap-2"},fe={class:"text-sm text-gray-700"},_e={class:"flex items-center gap-2"},he=["href"],ye={class:"flex items-center gap-2"},xe={class:"text-sm text-gray-700"},be={class:"flex items-center gap-2"},we={class:"text-sm text-gray-700"},ke={class:"flex items-start gap-4"},Ve={class:"flex flex-col items-end gap-2"},Ee={class:"flex items-center gap-2 mb-2 bg-[#DCFCE7] px-2 rounded-md"},Ce={class:"text-sm font-semibold text-gray-700"},De={key:0,class:"pi pi-check text-xs"},$e={key:1,class:"pi pi-times text-xs"},Le={class:"bg-white rounded-xl shadow-md p-6"},Fe={class:"flex flex-col-reverse md:flex-row items-center justify-between gap-4 mb-6"},Ue={class:"text-xl md:text-2xl font-bold text-gray-900"},je={class:"text-green-600 hover:underline text-sm font-semibold"},Se={key:0,class:"flex justify-center mb-10"},Be={key:1,class:"text-center text-gray-600 py-8"},Ie={key:2,class:"overflow-x-auto"},Pe={class:"w-full text-left rtl:text-right table-auto"},Me={class:"text-gray-500 text-sm border-b border-gray-200"},Ge={class:"p-4 whitespace-nowrap"},Ne={class:"p-4 whitespace-nowrap"},ze={class:"p-4 whitespace-nowrap"},Ae={class:"p-4 whitespace-nowrap"},Oe={class:"p-4 whitespace-nowrap"},Re={class:"p-4 text-gray-700 font-medium whitespace-nowrap"},Te={class:"p-4 text-gray-500 whitespace-nowrap"},qe={class:"p-4 text-gray-700 whitespace-nowrap"},He={class:"p-4 whitespace-nowrap"},Je={class:"p-4 text-gray-700 font-semibold whitespace-nowrap"},We={class:"p-fluid grid grid-cols-1 md:grid-cols-2 gap-4"},Xe={class:"field"},Ye={for:"name",class:"font-bold"},Ke={class:"field"},Qe={for:"owner_name",class:"font-bold"},Ze={class:"field"},et={for:"license_number",class:"font-bold"},tt={class:"field"},lt={for:"phone",class:"font-bold"},at={class:"field md:col-span-2"},st={for:"address",class:"font-bold"},ot={class:"field"},rt={for:"lat",class:"font-bold"},nt={class:"field"},it={for:"long",class:"font-bold"},dt={class:"field md:col-span-2"},pt={class:"font-bold"},ct={class:"text-gray-500"},ut={class:"field md:col-span-2"},mt={class:"font-bold text-center"},gt={key:0,class:"p-4"},vt={class:"relative group"},ft=["src"],_t={class:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-0 rounded-lg group-hover:bg-opacity-40 transition-all duration-300"},ht={class:"space-x-3 transform translate-y-4 opacity-0 group-hover:opacity-100 group-hover:translate-y-0 transition-all duration-300"},yt={key:1,class:"flex flex-col items-center justify-center h-full p-4"},xt={class:"mb-1 text-sm text-center text-gray-600"},bt={class:"font-medium text-green-500"},wt={class:"m-0 mb-4"},kt={class:"flex justify-end gap-2"},Vt={__name:"profile",setup(Et){const P=Y(),{t:a}=K(),u=Q(),M=Z(),_=m([]),b=m(!1),h=m(!1),y=m(!1),E=m(!1),x=m({pharmacy_logo:!1}),f=m(null),i=m({id:null,name:"",owner_name:"",license_number:"",phone:"",address:"",lat:"",long:"",status:null,pharmacy_logo:null,status_description:""}),o=m({...i.value,pharmacy_logo_preview:null}),G=r=>{x.value[r]=!0},N=r=>{x.value[r]=!1},L=(r,t)=>{var g,U,j;const l=((U=(g=r.dataTransfer)==null?void 0:g.files)==null?void 0:U[0])||((j=r.target.files)==null?void 0:j[0]);if(l){if(!l.type.match("image.*")){u.add({severity:"error",summary:a("error"),detail:a("auth.invalid_image_type"),life:3e3});return}if(l.size>1024*1024){u.add({severity:"error",summary:a("error"),detail:a("auth.image_too_large"),life:3e3});return}f.value=l;const S=new FileReader;S.onload=W=>{var B;o.value.pharmacy_logo_preview=(B=W.target)==null?void 0:B.result},S.readAsDataURL(l),x.value[t]=!1}},z=r=>{f.value=null,o.value.pharmacy_logo_preview=null,i.value.pharmacy_logo&&(o.value.pharmacy_logo=null);const t=document.getElementById(r);t&&(t.value="")},A=r=>{const t=document.getElementById(r);t&&t.click()},O=r=>{const t=r.latLng,l=t.lat(),g=t.lng();o.value.lat=l.toString(),o.value.long=g.toString()},R=()=>{o.value={...i.value},o.value.pharmacy_logo_preview=i.value.pharmacy_logo,f.value=null,y.value=!0},T=async()=>{var r,t;E.value=!0;try{const l=new FormData;l.append("name",o.value.name),l.append("owner_name",o.value.owner_name),l.append("license_number",o.value.license_number||""),l.append("phone",o.value.phone),l.append("address",o.value.address),l.append("lat",o.value.lat),l.append("long",o.value.long),f.value?l.append("pharmacy_logo",f.value):i.value.pharmacy_logo&&o.value.pharmacy_logo===null&&l.append("remove_logo",1);const g=await $.post("/api/pharmacy/profile/update",l,{});g.data.success?(i.value={...o.value},f.value=null,y.value=!1,u.add({severity:"success",summary:a("success"),detail:a("profile.updateSuccess"),life:3e3}),await F()):u.add({severity:"warn",summary:a("warning"),detail:g.data.message||a("profile.updateError"),life:3e3})}catch(l){u.add({severity:"error",summary:a("error"),detail:((t=(r=l.response)==null?void 0:r.data)==null?void 0:t.message)||a("profile.updateError"),life:3e3}),console.error("Error updating profile:",l)}finally{E.value=!1}},F=async()=>{try{const r=await $.get("/api/pharmacy/profile/data");r.data.success&&r.data.data?(i.value=r.data.data,o.value={...r.data.data},o.value.pharmacy_logo_preview=r.data.data.pharmacy_logo):u.add({severity:"warn",summary:a("warning"),detail:a("profile.fetchError"),life:3e3})}catch(r){u.add({severity:"error",summary:a("error"),detail:a("profile.fetchError"),life:3e3}),console.error("Error fetching profile:",r)}},q=async()=>{b.value=!0;try{const r=await $.get("/api/order");r.data.success&&r.data.data?_.value=r.data.data:_.value=[]}catch(r){_.value=[],u.add({severity:"error",summary:a("error"),detail:a("orders.fetchError"),life:3e3}),console.error("Error fetching orders:",r)}finally{b.value=!1}},H=async()=>{try{P.pharmacyhandleLogout(),M.push({name:"login"})}catch(r){u.add({severity:"error",summary:a("error"),detail:a("profile.logoutError"),life:3e3}),console.error("Error logging out:",r)}finally{h.value=!1}},J=r=>new Date(r).toLocaleDateString("ar-EG",{day:"2-digit",month:"long",year:"numeric"});return ee(()=>{F(),q()}),(r,t)=>(p(),c("div",de,[e("div",pe,[e("div",ce,[e("img",{src:i.value.pharmacy_logo||`https://api.dicebear.com/9.x/initials/svg?seed=${i.value.name}`,alt:s(a)("profile.alt"),class:"w-24 h-24 md:w-32 md:h-32 rounded-xl object-cover border-4 border-gray-200 shadow-md"},null,8,ue),e("div",me,[e("h1",ge,n(i.value.name),1),e("div",ve,[t[18]||(t[18]=e("i",{class:"pi pi-map-marker text-green-600"},null,-1)),e("span",fe,n(i.value.address),1)]),e("div",_e,[t[19]||(t[19]=e("i",{class:"pi pi-phone text-green-600"},null,-1)),e("a",{href:"tel:"+i.value.phone,class:"text-sm text-gray-700"},n(i.value.phone),9,he)]),e("div",ye,[t[20]||(t[20]=e("i",{class:"pi pi-user text-green-600"},null,-1)),e("span",xe,n(i.value.owner_name),1)]),e("div",be,[t[21]||(t[21]=e("i",{class:"pi pi-id-card text-green-600"},null,-1)),e("span",we,n(i.value.license_number),1)])])]),e("div",ke,[e("div",Ve,[e("div",Ee,[e("span",Ce,n(s(a)(`profile.status.${i.value.status_description}`)),1),e("span",{class:C(["p-1 rounded-full",i.value.status_description==="active"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"])},[i.value.status_description==="active"?(p(),c("i",De)):(p(),c("i",$e))],2)]),e("button",{onClick:R,class:"bg-[#0E3758] text-white font-bold py-2 px-4 rounded-lg flex items-center gap-2 transition-colors hover:bg-opacity-90"},[D(n(s(a)("profile.edit"))+" ",1),t[22]||(t[22]=e("i",{class:"pi pi-file-edit"},null,-1))]),e("button",{onClick:t[0]||(t[0]=l=>h.value=!0),class:"bg-red-600 text-white font-bold py-2 px-4 rounded-lg flex items-center gap-2 transition-colors hover:bg-red-700"},[D(n(s(a)("profile.logout"))+" ",1),t[23]||(t[23]=e("i",{class:"pi pi-sign-out"},null,-1))])])])]),e("div",Le,[e("div",Fe,[e("h2",Ue,n(s(a)("orders.title")),1),e("button",je,n(s(a)("orders.viewAll")),1)]),b.value?(p(),c("div",Se,[d(s(ae),{style:{width:"50px",height:"50px"},strokeWidth:"4"})])):!b.value&&_.value.length===0?(p(),c("div",Be,[e("p",null,n(s(a)("orders.empty")),1)])):(p(),c("div",Ie,[e("table",Pe,[e("thead",null,[e("tr",Me,[e("th",Ge,n(s(a)("orders.id")),1),e("th",Ne,n(s(a)("orders.date")),1),e("th",ze,n(s(a)("orders.warehouse")),1),e("th",Ae,n(s(a)("orders.statu")),1),e("th",Oe,n(s(a)("orders.amount")),1)])]),e("tbody",null,[(p(!0),c(te,null,le(_.value,l=>(p(),c("tr",{key:l.id,class:"border-b border-gray-100"},[e("td",Re,n(l.number),1),e("td",Te,n(J(l.created_at)),1),e("td",qe,n(l.warehouse.name),1),e("td",He,[e("span",{class:C(["px-3 py-1 text-xs font-medium rounded-full",{"bg-green-100 text-green-700":l.status_description==="delivered","bg-red-100 text-red-700":l.status_description==="cancelled","bg-yellow-100 text-yellow-700":l.status_description==="pending"}])},n(s(a)(`orders.status.${l.status_description}`)),3)]),e("td",Je,n(l.total_price),1)]))),128))])])]))]),d(s(I),{visible:y.value,"onUpdate:visible":t[15]||(t[15]=l=>y.value=l),modal:"",header:s(a)("profile.edit"),style:{width:"50rem"},breakpoints:{"1199px":"75vw","575px":"90vw"},class:"p-dialog-rounded"},{footer:w(()=>[d(s(k),{label:s(a)("common.cancel"),icon:"pi pi-times",onClick:t[14]||(t[14]=l=>y.value=!1),class:"p-button-secondary",text:""},null,8,["label"]),d(s(k),{label:s(a)("common.save"),icon:"pi pi-check",onClick:T,loading:E.value,class:"bg-[#0E3758] text-white hover:bg-[#1a5b8f] border-transparent"},null,8,["label","loading"])]),default:w(()=>[e("div",We,[e("div",Xe,[e("label",Ye,n(s(a)("profile.name")),1),d(s(v),{id:"name",modelValue:o.value.name,"onUpdate:modelValue":t[1]||(t[1]=l=>o.value.name=l),placeholder:s(a)("profile.name"),class:"p-inputtext-sm"},null,8,["modelValue","placeholder"])]),e("div",Ke,[e("label",Qe,n(s(a)("profile.owner_name")),1),d(s(v),{id:"owner_name",modelValue:o.value.owner_name,"onUpdate:modelValue":t[2]||(t[2]=l=>o.value.owner_name=l),placeholder:s(a)("profile.owner_name"),class:"p-inputtext-sm"},null,8,["modelValue","placeholder"])]),e("div",Ze,[e("label",et,n(s(a)("profile.license_number")),1),d(s(v),{id:"license_number",modelValue:o.value.license_number,"onUpdate:modelValue":t[3]||(t[3]=l=>o.value.license_number=l),placeholder:s(a)("profile.license_number"),class:"p-inputtext-sm"},null,8,["modelValue","placeholder"])]),e("div",tt,[e("label",lt,n(s(a)("profile.phone")),1),d(s(v),{id:"phone",modelValue:o.value.phone,"onUpdate:modelValue":t[4]||(t[4]=l=>o.value.phone=l),placeholder:s(a)("profile.phone"),class:"p-inputtext-sm"},null,8,["modelValue","placeholder"])]),e("div",at,[e("label",st,n(s(a)("profile.address")),1),d(s(v),{id:"address",modelValue:o.value.address,"onUpdate:modelValue":t[5]||(t[5]=l=>o.value.address=l),placeholder:s(a)("profile.address"),class:"p-inputtext-sm"},null,8,["modelValue","placeholder"])]),e("div",ot,[e("label",rt,n(s(a)("profile.lat")),1),d(s(v),{id:"lat",modelValue:o.value.lat,"onUpdate:modelValue":t[6]||(t[6]=l=>o.value.lat=l),placeholder:s(a)("profile.lat"),class:"p-inputtext-sm bg-gray-100 cursor-not-allowed",readonly:""},null,8,["modelValue","placeholder"])]),e("div",nt,[e("label",it,n(s(a)("profile.long")),1),d(s(v),{id:"long",modelValue:o.value.long,"onUpdate:modelValue":t[7]||(t[7]=l=>o.value.long=l),placeholder:s(a)("profile.long"),class:"p-inputtext-sm bg-gray-100 cursor-not-allowed",readonly:""},null,8,["modelValue","placeholder"])]),e("div",dt,[e("label",pt,n(s(a)("profile.location")),1),d(s(ne),{onClick:O,style:{width:"100%",height:"300px","border-radius":"8px",overflow:"hidden"},center:{lat:o.value.lat?parseFloat(o.value.lat):33.5158,lng:o.value.long?parseFloat(o.value.long):36.2939},zoom:14,class:"shadow-md"},{default:w(()=>[o.value.lat&&o.value.long?(p(),se(s(ie),{key:0,options:{position:{lat:parseFloat(o.value.lat),lng:parseFloat(o.value.long)}}},null,8,["options"])):oe("",!0)]),_:1},8,["center"]),e("small",ct,n(s(a)("profile.map_instruction")),1)]),e("div",ut,[e("label",mt,n(s(a)("profile.pharmacy_logo")),1),e("label",{onDragover:t[11]||(t[11]=V(l=>G("pharmacy_logo"),["prevent"])),onDragleave:t[12]||(t[12]=l=>N("pharmacy_logo")),onDrop:t[13]||(t[13]=V(l=>L(l,"pharmacy_logo"),["prevent"])),class:C([{"border-green-400 bg-green-50":x.value.pharmacy_logo,"border-gray-200":!x.value.pharmacy_logo},"w-full h-40 rounded-lg cursor-pointer transition-all duration-300 hover:border-green-400 border-2 border-dashed"])},[e("input",{type:"file",onChange:t[8]||(t[8]=l=>L(l,"pharmacy_logo")),accept:"image/*",class:"hidden",id:"pharmacy_logo"},null,32),o.value.pharmacy_logo_preview?(p(),c("div",gt,[e("div",vt,[e("img",{src:o.value.pharmacy_logo_preview,alt:"Pharmacy Logo Preview",class:"object-contain w-full h-32 rounded-lg shadow-md group-hover:scale-105 transition-transform duration-300"},null,8,ft),e("div",_t,[e("div",ht,[e("button",{type:"button",onClick:t[9]||(t[9]=V(l=>z("pharmacy_logo"),["stop"])),class:"p-2 bg-red-500 text-white rounded-full hover:bg-red-600 transition"},[...t[24]||(t[24]=[e("i",{class:"text-sm pi pi-trash"},null,-1)])]),e("button",{type:"button",onClick:t[10]||(t[10]=V(l=>A("pharmacy_logo"),["stop"])),class:"p-2 bg-white text-gray-700 rounded-full hover:bg-gray-100 transition"},[...t[25]||(t[25]=[e("i",{class:"text-sm pi pi-pencil"},null,-1)])])])])])])):(p(),c("div",yt,[t[26]||(t[26]=e("div",{class:"p-3 mb-2 bg-green-100 rounded-full"},[e("i",{class:"text-xl text-green-500 pi pi-image"})],-1)),e("p",xt,[e("span",bt,n(s(a)("auth.click_to_upload")),1),D(" "+n(s(a)("auth.or_drag_and_drop")),1)]),t[27]||(t[27]=e("p",{class:"text-xs text-gray-400"},"SVG, PNG, JPG or GIF (max. 1MB)",-1))]))],34)])])]),_:1},8,["visible","header"]),d(s(I),{visible:h.value,"onUpdate:visible":t[17]||(t[17]=l=>h.value=l),modal:"",header:s(a)("profile.confirmLogout"),style:{width:"25rem"},class:"p-dialog-rounded"},{default:w(()=>[e("p",wt,n(s(a)("profile.logoutConfirm")),1),e("div",kt,[d(s(k),{label:s(a)("common.cancel"),severity:"secondary",onClick:t[16]||(t[16]=l=>h.value=!1),class:"p-button-secondary"},null,8,["label"]),d(s(k),{label:s(a)("profile.logout"),severity:"danger",onClick:H},null,8,["label"])])]),_:1},8,["visible","header"]),d(s(re))]))}},$t=X(Vt,[["__scopeId","data-v-37c993b6"]]);export{$t as default};
