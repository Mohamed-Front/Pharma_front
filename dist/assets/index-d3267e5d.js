import{_ as ce,u as pe,z as me,a as ve,r as c,a7 as _e,m as he,o as be,d as v,a8 as Q,Z as _,e as $,h as B,g as l,i as o,w as p,f as fe,t as i,j as r,F as ye,y as ge,C as we,a9 as ke,b as M,B as S,A as L}from"./index-2cd76906.js";const Ve={class:"grid"},xe={class:"col-12"},Ce={class:"p-4 card shadow-2 border-round"},De={class:"text-2xl font-bold"},Te={class:"flex gap-2"},$e={class:"p-input-icon-left"},Se={class:"p-input-icon-left"},Ue={class:"card shadow-1 surface-0"},Ie={class:"flex gap-1"},Ee={class:"py-4 text-center"},Ne={class:"text-xl"},qe={class:"flex py-4 justify-content-center align-items-center"},Be={key:0,class:"mt-3 p-paginator p-component p-unselectable-text"},Me={class:"p-paginator-left-content"},Fe={class:"p-paginator-current"},Re={class:"p-paginator-right-content"},Ae={class:"p-paginator-pages"},Le=["disabled"],je=["disabled"],Oe=["onClick"],ze=["disabled"],Ge=["disabled"],We={class:"p-paginator-rpp-options"},Ze={class:"p-fluid"},He={class:"field my-1"},Je={for:"number",class:"my-1"},Ke={class:"field my-1"},Qe={for:"pharmacy_id",class:"my-1"},Xe={class:"field my-1"},Ye={for:"warehouse_id",class:"my-1"},Pe={class:"field my-1"},et={for:"status",class:"my-1"},tt={class:"field my-1"},at={for:"total_price",class:"my-1"},lt={class:"p-fluid"},rt={class:"field my-1"},ot={for:"number_edit",class:"my-1"},st={class:"field my-1"},dt={for:"pharmacy_id_edit",class:"my-1"},it={class:"field my-1"},nt={for:"warehouse_id_edit",class:"my-1"},ut={class:"field my-1"},ct={for:"status_edit",class:"my-1"},pt={class:"field my-1"},mt={for:"total_price_edit",class:"my-1"},vt={class:"flex align-items-center justify-content-center"},_t={__name:"index",setup(ht){const{t:e}=pe(),X=me(),y=ve(),U=c(!0),j=c(""),O=c(null),C=c(!1),I=c(!1),F=c(!1);c(null);const z=c(null),G=c({}),E=c(""),N=c(""),u=c({number:"",pharmacy_id:"",warehouse_id:"",status:"",total_price:""}),Y=c(null),m=c(1),R=c(0),D=c(10),g=c(0),W=c(0),Z=c(0),P=s=>{switch(s.toLowerCase()){case"نشط":case"pending":return"warning";case"قيد الانتظار":case"waiting":return"info";case"مرتجع":case"returned":return"danger";case"مُنجز":case"completed":case"مُسلم":case"delivered":return"success";default:return"info"}},k=(s,a)=>{var d;const n=s.status;switch((d=s.status_description)!=null&&d.toLowerCase(),a){case"view":return!0;case"delete":return n===1;case"accept":return n===1;case"cancel":return n===1||n===2;case"deliver":return n===2;case"return":return n===3;case"edit":return n===1;default:return!1}},H=(s,a)=>{var d;const n=s.status;switch((d=s.status_description)!=null&&d.toLowerCase(),a){case"accept":return e(n===1?"order.accept":"order.confirm");case"cancel":return e(n===1?"order.cancel":"order.reject");case"deliver":return e("order.deliver");case"return":return e("order.return");default:return e(`order.${a}`)}},ee=()=>{z.value.exportCSV()},te=s=>{j.value=s,C.value=!0},ae=()=>{M.delete(`/api/order/${j.value}`).then(()=>{w(),C.value=!1,y.add({severity:"success",summary:e("success"),detail:e("order.deleteSuccess"),life:3e3})}).catch(s=>{y.add({severity:"error",summary:e("error"),detail:e("order.deleteError"),life:3e3})})},q=(s,a,n)=>{let d="",h="";switch(a){case 2:d=e("order.acceptSuccess"),h=e("order.acceptError");break;case 5:d=e("order.cancelSuccess"),h=e("order.cancelError");break;case 3:d=e("order.deliverSuccess"),h=e("order.deliverError");break;case 4:d=e("order.returnSuccess"),h=e("order.returnError");break;default:d=e("order.statusChanged"),h=e("order.statusChangeError")}M.post(`/api/order/change-status/${s}?status=${a}`).then(()=>{w(),y.add({severity:"success",summary:e("success"),detail:d,life:3e3})}).catch(K=>{y.add({severity:"error",summary:e("error"),detail:h,life:3e3})})},le=()=>{G.value={global:{value:null,matchMode:ke.CONTAINS}}},re=()=>{u.value={number:"",pharmacy_id:"",warehouse_id:"",status:"",total_price:""},Y.value=null},oe=s=>{X.push({name:"order_show",params:{id:s}})},J=()=>{M.post("/api/order",u.value).then(()=>{w(),I.value=!1,y.add({severity:"success",summary:e("success"),detail:e("order.createSuccess"),life:3e3}),re()}).catch(s=>{y.add({severity:"error",summary:e("error"),detail:e("order.createError"),life:3e3})})};_e(()=>{le()});const w=()=>{U.value=!0,M.get("/api/order",{params:{page:m.value,limit:D.value,from:E.value,to:N.value}}).then(s=>{U.value=!1,O.value=s.data.data,R.value=s.data.pagination.total,g.value=s.data.pagination.last_page,W.value=s.data.pagination.from,Z.value=s.data.pagination.to}).catch(s=>{U.value=!1,y.add({severity:"error",summary:e("error"),detail:e("order.loadError"),life:3e3}),console.error("Error fetching data:",s)})};he([E,N],()=>{m.value=1,w()});const T=s=>{s>=1&&s<=g.value&&(m.value=s,w())},se=s=>{D.value=s.value,m.value=1,w()};return be(()=>{w()}),(s,a)=>{const n=v("InputText"),d=v("Button"),h=v("Toolbar"),K=v("Toast"),b=v("Column"),de=v("Tag"),ie=v("ProgressSpinner"),ne=v("DataTable"),ue=v("Dropdown"),A=v("Dialog"),f=Q("can"),V=Q("tooltip");return _(($(),B("div",Ve,[l("div",xe,[l("div",Ce,[o(h,{class:"mb-4"},{start:p(()=>[l("h2",De,i(r(e)("order.managementTitle")),1)]),end:p(()=>[l("div",Te,[l("span",$e,[a[23]||(a[23]=l("i",{class:"pi pi-calendar"},null,-1)),o(n,{modelValue:E.value,"onUpdate:modelValue":a[0]||(a[0]=t=>E.value=t),type:"date",placeholder:r(e)("order.fromDate")},null,8,["modelValue","placeholder"])]),l("span",Se,[a[24]||(a[24]=l("i",{class:"pi pi-calendar"},null,-1)),o(n,{modelValue:N.value,"onUpdate:modelValue":a[1]||(a[1]=t=>N.value=t),type:"date",placeholder:r(e)("order.toDate")},null,8,["modelValue","placeholder"])]),_(o(d,{label:r(e)("order.export"),icon:"pi pi-upload",class:"p-export",onClick:ee},null,8,["label"]),[[f,"create orders"]])])]),_:1}),o(K),l("div",Ue,[_(($(),fe(ne,{ref_key:"dt",ref:z,value:O.value,loading:U.value,"data-key":"id",paginator:!1,rows:D.value,filters:G.value,totalRecords:R.value,"responsive-layout":"scroll",stripedRows:"",showGridlines:"",class:"p-datatable-sm"},{empty:p(()=>[l("div",Ee,[a[25]||(a[25]=l("i",{class:"mb-2 text-2xl pi pi-exclamation-circle"},null,-1)),l("p",Ne,i(r(e)("order.noData")),1)])]),loading:p(()=>[l("div",qe,[o(ie,{style:{width:"50px",height:"50px"},strokeWidth:"4"})])]),default:p(()=>[o(b,{"selection-mode":"multiple","header-style":"width: 3rem"}),o(b,{field:"number",header:r(e)("order.orderNumber"),sortable:!0,"header-style":"width:15%; min-width:10rem;"},{body:p(t=>[S(i(t.data.number),1)]),_:1},8,["header"]),o(b,{field:"pharmacy.name",header:r(e)("order.pharmacy"),sortable:!0,"header-style":"width:15%; min-width:10rem;"},{body:p(t=>[S(i(t.data.pharmacy.name),1)]),_:1},8,["header"]),o(b,{field:"warehouse.name",header:r(e)("order.warehouse"),sortable:!0,"header-style":"width:15%; min-width:10rem;"},{body:p(t=>[S(i(t.data.warehouse.name),1)]),_:1},8,["header"]),o(b,{field:"status_description",header:r(e)("order.status"),sortable:!0,"header-style":"width:10%; min-width:8rem;"},{body:p(t=>[o(de,{value:t.data.status_description,severity:P(t.data.status_description)},null,8,["value","severity"])]),_:1},8,["header"]),o(b,{field:"total_price",header:r(e)("order.totalPrice"),sortable:!0,"header-style":"width:10%; min-width:8rem;"},{body:p(t=>[S(i(t.data.total_price),1)]),_:1},8,["header"]),o(b,{field:"created_at",header:r(e)("order.createdAt"),sortable:!0,"header-style":"width:15%; min-width:10rem;"},{body:p(t=>[S(i(t.data.created_at),1)]),_:1},8,["header"]),o(b,{header:r(e)("order.actions"),"header-style":"min-width:20rem;"},{body:p(t=>[l("div",Ie,[_(o(d,{icon:"pi pi-eye",class:"p-detail",disabled:!k(t.data,"view"),onClick:x=>oe(t.data.id)},null,8,["disabled","onClick"]),[[f,"edit orders"],[V,r(e)("view"),void 0,{top:!0}]]),_(o(d,{icon:"pi pi-trash",class:"p-delete",disabled:!k(t.data,"delete"),onClick:x=>te(t.data.id)},null,8,["disabled","onClick"]),[[V,r(e)("delete"),void 0,{top:!0}]]),_(o(d,{icon:t.data.status===1?"pi pi-check":"pi pi-check-circle",class:L(["p-detai",(t.data.status===1,"p-detai"),"p-detail"]),disabled:!k(t.data,"accept"),onClick:x=>q(t.data.id,2,t.data.status)},null,8,["icon","class","disabled","onClick"]),[[f,"edit orders"],[V,H(t.data,"accept"),void 0,{top:!0}]]),_(o(d,{icon:t.data.status===1?"pi pi-times":"pi pi-times-circle",class:L(["p-delete",(t.data.status===1,"p-delete"),"p-delete"]),disabled:!k(t.data,"cancel"),onClick:x=>q(t.data.id,5,t.data.status)},null,8,["icon","class","disabled","onClick"]),[[f,"edit orders"],[V,H(t.data,"cancel"),void 0,{top:!0}]]),_(o(d,{icon:"pi pi-truck",class:"p-detail",disabled:!k(t.data,"deliver"),onClick:x=>q(t.data.id,3,t.data.status)},null,8,["disabled","onClick"]),[[f,"edit orders"],[V,r(e)("order.deliver"),void 0,{top:!0}]]),_(o(d,{icon:"pi pi-undo",class:"p-detail",disabled:!k(t.data,"return"),onClick:x=>q(t.data.id,4,t.data.status)},null,8,["disabled","onClick"]),[[f,"edit orders"],[V,r(e)("order.return"),void 0,{top:!0}]])])]),_:1},8,["header"])]),_:1},8,["value","loading","rows","filters","totalRecords"])),[[f,"list orders"]]),g.value>0?($(),B("div",Be,[l("div",Me,[l("span",Fe,i(r(e)("order.showing"))+" "+i(W.value)+" "+i(r(e)("order.to"))+" "+i(Z.value)+" "+i(r(e)("order.of"))+" "+i(R.value)+" "+i(r(e)("order.entries")),1)]),l("div",Re,[l("span",Ae,[l("button",{class:"p-paginator-first p-paginator-element p-link",disabled:m.value===1,onClick:a[2]||(a[2]=t=>T(1))},[...a[26]||(a[26]=[l("span",{class:"p-paginator-icon pi pi-angle-double-left"},null,-1)])],8,Le),l("button",{class:"p-paginator-prev p-paginator-element p-link",disabled:m.value===1,onClick:a[3]||(a[3]=t=>T(m.value-1))},[...a[27]||(a[27]=[l("span",{class:"p-paginator-icon pi pi-angle-left"},null,-1)])],8,je),($(!0),B(ye,null,ge(g.value,t=>($(),B("button",{key:t,class:L(["p-paginator-page p-paginator-element p-link",{"p-highlight":m.value===t}]),onClick:x=>T(t)},i(t),11,Oe))),128)),l("button",{class:"p-paginator-next p-paginator-element p-link",disabled:m.value===g.value,onClick:a[4]||(a[4]=t=>T(m.value+1))},[...a[28]||(a[28]=[l("span",{class:"p-paginator-icon pi pi-angle-right"},null,-1)])],8,ze),l("button",{class:"p-paginator-last p-paginator-element p-link",disabled:m.value===g.value,onClick:a[5]||(a[5]=t=>T(g.value))},[...a[29]||(a[29]=[l("span",{class:"p-paginator-icon pi pi-angle-double-right"},null,-1)])],8,Ge)]),l("span",We,[o(ue,{modelValue:D.value,"onUpdate:modelValue":a[6]||(a[6]=t=>D.value=t),options:[5,10,20,30],onChange:se,class:"ml-2",style:{width:"100px"}},null,8,["modelValue"])])])])):we("",!0)]),o(A,{visible:I.value,"onUpdate:visible":a[13]||(a[13]=t=>I.value=t),style:{width:"450px"},header:r(e)("order.createTitle"),modal:!0},{footer:p(()=>[o(d,{label:r(e)("cancel"),icon:"pi pi-times",class:"p-button-text",onClick:a[12]||(a[12]=t=>I.value=!1)},null,8,["label"]),o(d,{label:r(e)("save"),icon:"pi pi-check",class:"p-button-text p-button-success",onClick:J},null,8,["label"])]),default:p(()=>[l("div",Ze,[l("div",He,[l("p",Je,i(r(e)("order.orderNumber")),1),o(n,{id:"number",modelValue:u.value.number,"onUpdate:modelValue":a[7]||(a[7]=t=>u.value.number=t),required:"",placeholder:r(e)("order.orderNumber")},null,8,["modelValue","placeholder"])]),l("div",Ke,[l("p",Qe,i(r(e)("order.pharmacyId")),1),o(n,{id:"pharmacy_id",modelValue:u.value.pharmacy_id,"onUpdate:modelValue":a[8]||(a[8]=t=>u.value.pharmacy_id=t),type:"number",required:"",placeholder:r(e)("order.pharmacyId")},null,8,["modelValue","placeholder"])]),l("div",Xe,[l("p",Ye,i(r(e)("order.warehouseId")),1),o(n,{id:"warehouse_id",modelValue:u.value.warehouse_id,"onUpdate:modelValue":a[9]||(a[9]=t=>u.value.warehouse_id=t),type:"number",required:"",placeholder:r(e)("order.warehouseId")},null,8,["modelValue","placeholder"])]),l("div",Pe,[l("p",et,i(r(e)("order.status")),1),o(n,{id:"status",modelValue:u.value.status,"onUpdate:modelValue":a[10]||(a[10]=t=>u.value.status=t),required:"",placeholder:r(e)("order.status")},null,8,["modelValue","placeholder"])]),l("div",tt,[l("p",at,i(r(e)("order.totalPrice")),1),o(n,{id:"total_price",modelValue:u.value.total_price,"onUpdate:modelValue":a[11]||(a[11]=t=>u.value.total_price=t),type:"number",required:"",placeholder:r(e)("order.totalPrice")},null,8,["modelValue","placeholder"])])])]),_:1},8,["visible","header"]),o(A,{visible:F.value,"onUpdate:visible":a[20]||(a[20]=t=>F.value=t),style:{width:"450px"},header:r(e)("order.editTitle"),modal:!0},{footer:p(()=>[o(d,{label:r(e)("cancel"),icon:"pi pi-times",class:"p-button-text",onClick:a[19]||(a[19]=t=>F.value=!1)},null,8,["label"]),o(d,{label:r(e)("save"),icon:"pi pi-check",class:"p-button-text p-button-success",onClick:J},null,8,["label"])]),default:p(()=>[l("div",lt,[l("div",rt,[l("p",ot,i(r(e)("order.orderNumber")),1),o(n,{id:"number_edit",modelValue:u.value.number,"onUpdate:modelValue":a[14]||(a[14]=t=>u.value.number=t),required:"",placeholder:r(e)("order.orderNumber")},null,8,["modelValue","placeholder"])]),l("div",st,[l("p",dt,i(r(e)("order.pharmacyId")),1),o(n,{id:"pharmacy_id_edit",modelValue:u.value.pharmacy_id,"onUpdate:modelValue":a[15]||(a[15]=t=>u.value.pharmacy_id=t),type:"number",required:"",placeholder:r(e)("order.pharmacyId")},null,8,["modelValue","placeholder"])]),l("div",it,[l("p",nt,i(r(e)("order.warehouseId")),1),o(n,{id:"warehouse_id_edit",modelValue:u.value.warehouse_id,"onUpdate:modelValue":a[16]||(a[16]=t=>u.value.warehouse_id=t),type:"number",required:"",placeholder:r(e)("order.warehouseId")},null,8,["modelValue","placeholder"])]),l("div",ut,[l("p",ct,i(r(e)("order.status")),1),o(n,{id:"status_edit",modelValue:u.value.status,"onUpdate:modelValue":a[17]||(a[17]=t=>u.value.status=t),required:"",placeholder:r(e)("order.status")},null,8,["modelValue","placeholder"])]),l("div",pt,[l("p",mt,i(r(e)("order.totalPrice")),1),o(n,{id:"total_price_edit",modelValue:u.value.total_price,"onUpdate:modelValue":a[18]||(a[18]=t=>u.value.total_price=t),type:"number",required:"",placeholder:r(e)("order.totalPrice")},null,8,["modelValue","placeholder"])])])]),_:1},8,["visible","header"]),o(A,{visible:C.value,"onUpdate:visible":a[22]||(a[22]=t=>C.value=t),style:{width:"450px"},header:r(e)("order.deleteConfirmTitle"),modal:!0},{footer:p(()=>[o(d,{label:r(e)("no"),icon:"pi pi-times",class:"p-button-text",onClick:a[21]||(a[21]=t=>C.value=!1)},null,8,["label"]),o(d,{label:r(e)("yes"),icon:"pi pi-check",class:"p-button-text p-button-danger",onClick:ae},null,8,["label"])]),default:p(()=>[l("div",vt,[a[30]||(a[30]=l("i",{class:"mr-3 pi pi-exclamation-triangle",style:{"font-size":"2rem",color:"var(--red-500)"}},null,-1)),l("span",null,i(r(e)("order.deleteConfirmMessage")),1)])]),_:1},8,["visible","header"])])])])),[[f,"list orders"]])}}},ft=ce(_t,[["__scopeId","data-v-c1854d06"]]);export{ft as default};
