import{u as W,j as q,J as S,r as p,g as U,d as I,o as i,c as n,k as e,z as m,m as o,t as a,F as R,x as V,C as M,B as f,E as D,D as E,K as C,L as P,A as z}from"./index-800b62dc.js";const J={class:"bg-gray-100 min-h-screen"},K={class:"py-10 px-4 md:px-8 max-w-4xl m-auto"},G={key:0,class:"flex justify-center mb-10"},H={key:1,class:"text-center text-gray-500 mb-10"},O={key:2,class:"space-y-8"},Q={class:"relative bg-white rounded-lg shadow-sm p-6 flex flex-col md:flex-row items-start justify-between"},X={class:"flex items-start w-full gap-4 md:flex-row flex-col"},Y={class:"flex items-center gap-2 mb-4 md:mb-0 w-full md:w-auto"},Z={class:"flex-1"},ee={class:"flex items-center gap-2 mb-1"},te={class:"text-sm font-bold text-[#1B8A45]"},se={class:"text-xl md:text-2xl font-extrabold text-gray-800 leading-tight"},ae={class:"flex flex-col items-center md:items-end w-full"},oe=["src"],le={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8"},re={class:"bg-white rounded-lg shadow-sm p-6 flex flex-col items-center text-center"},de={class:"text-3xl font-bold text-gray-800"},ie={class:"text-sm text-gray-500"},ne={class:"bg-white rounded-lg shadow-sm p-6 flex flex-col items-center text-center"},ce={class:"text-3xl font-bold text-gray-800"},ue={class:"text-sm text-gray-500"},pe={class:"bg-white rounded-lg shadow-sm p-6 flex flex-col items-center text-center"},me={class:"text-3xl font-bold text-gray-800"},_e={class:"text-sm text-gray-500"},xe={class:"bg-white rounded-lg shadow-sm p-6"},he={class:"text-xl font-bold text-gray-800 mb-4"},ge={class:"overflow-x-auto"},ve={class:"w-full table-auto"},ye={class:"bg-gray-100 text-gray-600 uppercase text-sm leading-normal"},fe={class:"py-3 px-6"},be={class:"py-3 px-6"},we={class:"py-3 px-6"},Ae={class:"py-3 px-6"},ke={class:"py-3 px-6"},Be={class:"py-3 px-6"},Le={class:"text-gray-600 text-sm font-light"},Re={class:"py-3 px-6"},Ve={class:"py-3 px-6"},Ee=["src"],Ce={class:"py-3 px-6"},Ne={class:"py-3 px-6"},$e={class:"py-3 px-6 whitespace-nowrap"},Fe={class:"py-3 px-6"},je={class:"bg-white rounded-lg shadow-md p-6 border-t-4 border-gray-300"},Te={class:"text-xl font-bold text-gray-800 mb-4"},We={class:"flex items-center gap-2"},qe={class:"text-gray-600 font-medium"},Se={for:"review-body",class:"block text-sm font-medium text-gray-700 mb-1"},Ue={class:"bg-white rounded-lg shadow-md p-6 border-t-4 border-gray-300"},Ie={class:"text-xl font-bold text-gray-800 mb-4"},Me={key:0,class:"space-y-4"},De={class:"flex items-center gap-2 mb-1"},Pe={class:"font-bold text-gray-800"},ze={class:"flex items-center gap-1 mb-2"},Je={class:"text-xs text-gray-500"},Ke={class:"text-sm text-gray-700"},Ge={key:1,class:"text-center text-gray-500"},Xe={__name:"warehouse-details",setup(He){const{t}=W(),_=q(),N=S(),r=p(null),v=p(!0),y=p(!1),x=p(""),h=p(0),b=p(localStorage.getItem("appLang")||"en"),g=p({}),$=U(()=>{var d;return((d=r.value)==null?void 0:d.logo)||"https://via.placeholder.com/64?text=Logo"}),F=async d=>{try{v.value=!0;const s=await f.get(`api/pharmacy-home/warehouse/${d}`);if(s.data.success)r.value={...s.data.data,total_products:s.data.data.paginated_products.total,connected_pharmacies:s.data.data.connected_pharmacies||0,rate:s.data.data.total_rating||0};else throw new Error("API request unsuccessful")}catch(s){_.add({severity:"error",summary:t("error"),detail:t("error.fetchWarehouse"),life:3e3}),console.error("Error fetching warehouse:",s)}finally{v.value=!1}},j=async d=>{var s,u;g.value[d]=!0;try{const c=await f.post("/api/cart/add/item",{product_id:d,quantity:1});if(c.data.success)_.add({severity:"success",summary:t("success"),detail:t("cart.addSuccess"),life:3e3});else throw new Error(c.data.message||t("error.addToCart"))}catch(c){const l=((u=(s=c.response)==null?void 0:s.data)==null?void 0:u.message)||c.message||t("error.addToCart");_.add({severity:"error",summary:t("error"),detail:l,life:3e3}),console.error("Error adding to cart:",c)}finally{setTimeout(()=>{delete g.value[d]},3e3)}},T=async()=>{var d;if(!x.value||!h.value){_.add({severity:"warn",summary:t("warning"),detail:t("error.reviewFieldsRequired"),life:3e3});return}try{y.value=!0;const s={id:r.value.id,type:"product",body:x.value,rate:h.value};await f.post("api/review",s);const u={id:(((d=r.value.reviews)==null?void 0:d.length)||0)+1,user_name:"Current User",rate:h.value,body:x.value};r.value.reviews||(r.value.reviews=[]),r.value.reviews.push(u),_.add({severity:"success",summary:t("success"),detail:t("success.reviewAdded"),life:3e3}),x.value="",h.value=0}catch(s){_.add({severity:"error",summary:t("error"),detail:t("error.addReview"),life:3e3}),console.error("Error adding review:",s)}finally{y.value=!1}};return I(()=>{F(N.params.id)}),(d,s)=>{var u,c;return i(),n("div",J,[e("div",K,[v.value?(i(),n("div",G,[m(o(D),{style:{width:"50px",height:"50px"},strokeWidth:"4","aria-label":"Loading spinner"})])):r.value?(i(),n("div",O,[e("div",Q,[s[3]||(s[3]=e("div",{class:"absolute top-0 left-0 bg-[#1B8A45] text-white text-xs font-bold py-1 px-3 rounded-tl-lg rounded-br-lg -translate-y-full translate-x-3"}," Feb 2023 - Feb 2025 ",-1)),e("div",X,[e("div",Y,[s[2]||(s[2]=e("i",{class:"pi pi-check-circle text-[#1B8A45] text-xl","aria-label":"Verified icon"},null,-1)),e("div",Z,[e("div",ee,[e("span",te,a(o(t)("verified_account")),1)]),e("h3",se,a(r.value.name),1)])]),e("div",ae,[e("img",{src:$.value,alt:"Warehouse Logo",class:"w-16 h-16 md:w-20 md:h-20 object-contain rounded-lg flex-shrink-0"},null,8,oe)])])]),e("div",le,[e("div",re,[s[4]||(s[4]=e("i",{class:"pi pi-box text-[#1B8A45] text-3xl mb-2"},null,-1)),e("span",de,a(r.value.total_products),1),e("span",ie,a(o(t)("number_of_products")),1)]),e("div",ne,[s[5]||(s[5]=e("i",{class:"pi pi-briefcase text-[#1B8A45] text-3xl mb-2"},null,-1)),e("span",ce,a(r.value.connected_pharmacies),1),e("span",ue,a(o(t)("connected_pharmacies")),1)]),e("div",pe,[s[6]||(s[6]=e("i",{class:"pi pi-star-fill text-[#EAB308] text-3xl mb-2"},null,-1)),e("span",me,a(((u=r.value.rate)==null?void 0:u.toFixed(1))||"N/A"),1),e("span",_e,a(o(t)("ratings")),1)])]),e("div",xe,[e("h4",he,a(o(t)("most_requested_products")),1),e("div",ge,[e("table",ve,[e("thead",null,[e("tr",ye,[e("th",fe,a(o(t)("product_name")),1),e("th",be,a(o(t)("product_image")),1),e("th",we,a(o(t)("category")),1),e("th",Ae,a(o(t)("company")),1),e("th",ke,a(o(t)("price")),1),e("th",Be,a(o(t)("action")),1)])]),e("tbody",Le,[(i(!0),n(R,null,V(r.value.paginated_products.data,l=>{var w,A,k,B,L;return i(),n("tr",{key:l.id,class:"border-b border-gray-200 hover:bg-gray-50"},[e("td",Re,a(l.commercial_name),1),e("td",Ve,[e("img",{src:((w=l.media[0])==null?void 0:w.url)||"https://via.placeholder.com/64?text=Image",alt:"Product Image",class:"w-12 h-12 object-contain rounded-lg"},null,8,Ee)]),e("td",Ce,a(b.value==="en"?((A=l.category)==null?void 0:A.name_en)||"N/A":((k=l.category)==null?void 0:k.name_ar)||"N/A"),1),e("td",Ne,a(b.value==="en"?((B=l.company)==null?void 0:B.name)||"N/A":((L=l.company)==null?void 0:L.name)||"N/A"),1),e("td",$e,"$"+a(l.price)+" "+a(l.price_unit),1),e("td",Fe,[m(o(E),{icon:g.value[l.id]?"pi pi-spin pi-spinner mr-2":"pi pi-cart-plus mr-2",class:"bg-[#1B8A45] hover:bg-[#156f3a] text-white font-bold py-2 px-4 rounded-md transition-colors",disabled:g.value[l.id],onClick:Oe=>j(l.id),"aria-label":"Add to cart"},null,8,["icon","disabled","onClick"])])])}),128))])])])]),e("div",je,[e("h4",Te,a(o(t)("add_review")),1),e("form",{onSubmit:M(T,["prevent"]),class:"space-y-4"},[e("div",We,[e("span",qe,a(o(t)("rate"))+":",1),m(o(C),{modelValue:h.value,"onUpdate:modelValue":s[0]||(s[0]=l=>h.value=l),stars:5,cancel:!1,class:"text-yellow-400"},null,8,["modelValue"])]),e("div",null,[e("label",Se,a(o(t)("your_review")),1),m(o(P),{id:"review-body",modelValue:x.value,"onUpdate:modelValue":s[1]||(s[1]=l=>x.value=l),rows:"4",class:"w-full p-3 border rounded-md focus:ring-[#1B8A45] focus:border-[#1B8A45]",placeholder:o(t)("placeholder.write_review")},null,8,["modelValue","placeholder"])]),m(o(E),{type:"submit",label:o(t)("submit_review"),loading:y.value,class:"w-full bg-[#1B8A45] hover:bg-[#156f3a] text-white font-bold py-2 px-4 rounded-md transition-colors"},null,8,["label","loading"])],32)]),e("div",Ue,[e("h4",Ie,a(o(t)("customer_reviews"))+" ("+a(((c=r.value.reviews)==null?void 0:c.length)||0)+")",1),r.value.reviews&&r.value.reviews.length>0?(i(),n("div",Me,[(i(!0),n(R,null,V(r.value.reviews,l=>(i(),n("div",{key:l.id,class:"border-b last:border-b-0 pb-4"},[e("div",De,[s[7]||(s[7]=e("i",{class:"pi pi-user-circle text-gray-400 text-lg"},null,-1)),e("span",Pe,a(l.user_name||"Anonymous User"),1)]),e("div",ze,[m(o(C),{"model-value":l.rate,stars:5,cancel:!1,readonly:"",class:"text-yellow-400"},null,8,["model-value"]),e("span",Je,"("+a(l.rate)+"/5)",1)]),e("p",Ke,a(l.body),1)]))),128))])):(i(),n("div",Ge,a(o(t)("no_reviews_yet")),1))])])):(i(),n("div",H,a(o(t)("error.noWarehouse")),1)),m(o(z))])])}}};export{Xe as default};
