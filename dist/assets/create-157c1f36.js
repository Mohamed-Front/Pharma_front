import{_ as re,s as ie,e as ue,u as ce,r as i,a as de,Y as d,a4 as pe,R as me,f as g,g as f,m as a,t as s,z as n,j as ve,B as k,q as b,x as h,v as x,F as _e,k as ge,y as fe}from"./index-b2b8894e.js";const ye={class:"max-w-5xl mx-auto p-6 bg-white rounded-xl shadow-lg"},be={class:"text-3xl font-bold text-center mb-8 text-gray-800"},he={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},xe={class:"space-y-2"},Ve={for:"category",class:"block text-sm font-medium text-gray-700"},we={class:"space-y-2"},$e={for:"company",class:"block text-sm font-medium text-gray-700"},ke={class:"space-y-2 relative"},Fe={for:"commercial_name",class:"block text-sm font-medium text-gray-700"},Ie={key:0,class:"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto"},Ce={class:"py-1"},qe=["onClick"],Ue={class:"space-y-2 md:col-span-2"},De={for:"active_ingredient",class:"block text-sm font-medium text-gray-700"},Ne={class:"space-y-2 md:col-span-2"},Te={for:"usage",class:"block text-sm font-medium text-gray-700"},Se={class:"space-y-2"},Le={for:"calibres",class:"block text-sm font-medium text-gray-700"},je={class:"space-y-2"},Be={for:"quantity",class:"block text-sm font-medium text-gray-700"},Ge={class:"space-y-2"},Me={for:"quantity_unit",class:"block text-sm font-medium text-gray-700"},Re={class:"space-y-2"},Pe={for:"price",class:"block text-sm font-medium text-gray-700"},ze={class:"space-y-2"},Ee={for:"price_unit",class:"block text-sm font-medium text-gray-700"},Oe={class:"space-y-2"},Ae={for:"expiration_from",class:"block text-sm font-medium text-gray-700"},Je={class:"space-y-2"},We={for:"expiration_to",class:"block text-sm font-medium text-gray-700"},Ye={class:"space-y-2 md:col-span-2"},He={for:"storage_notes",class:"block text-sm font-medium text-gray-700"},Ke={class:"space-y-2"},Qe={for:"pharmaceutical_form",class:"block text-sm font-medium text-gray-700"},Xe={class:"md:col-span-2 space-y-2"},Ze={class:"block text-sm font-medium text-gray-700"},et={class:"flex justify-center"},tt={key:0,class:"p-4"},at={class:"relative group"},lt=["src"],ot={class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 flex items-center justify-center rounded-lg transition-all"},st={class:"opacity-0 group-hover:opacity-100 flex space-x-3 transition-all transform translate-y-4 group-hover:translate-y-0"},nt={class:"mt-2 text-center text-sm text-gray-500"},rt={key:1,class:"p-8 flex flex-col items-center justify-center"},it={class:"text-sm text-center text-gray-600 mb-1"},ut={class:"text-blue-500 font-medium"},ct={class:"pt-4 flex justify-center"},dt={__name:"create",setup(pt){const P=ie(),F=ue(),{t:v}=ce(),V=i(!1),w=i(null),$=i(null),y=i(!1),p=i([]),m=i(!1),c=i({company_id:!1,commercial_name:!1,price:!1,price_unit:!1}),l=i({category_id:null,company_id:null,commercial_name:"",active_ingredient:[],product_image:null,usage:"",calibres:"",quantity:null,quantity_unit:null,price:null,price_unit:null,expiration_from:null,expiration_to:null,storage_notes:"",pharmaceutical_form:""}),C=i([]),q=i([]),U=i([]),D=i(""),N=i(""),T=i(""),S=async()=>{const e=await b.get("/api/category",{params:{search:D.value}});C.value=e.data.data},L=async()=>{const e=await b.get("/api/company",{params:{search:N.value}});q.value=e.data.data},j=async()=>{const e=await b.get("/api/scientific-structure",{params:{search:T.value}});U.value=e.data.data},I=(e,t)=>(...r)=>{clearTimeout(e.timer),e.timer=setTimeout(()=>e(...r),t)},z=I(S,350),E=I(L,350),O=I(j,350),A=e=>{D.value=e.value,z()},J=e=>{N.value=e.value,E()},W=e=>{T.value=e.value,O()},Y=async e=>{if(!e||e.length<2){p.value=[],m.value=!1;return}try{const t=await b.get(`/api/product/by/name?name=${encodeURIComponent(e)}`);p.value=t.data.data||[],m.value=p.value.length>0}catch{F.add({severity:"error",summary:v("error"),detail:v("error_fetching_names"),life:3e3}),p.value=[],m.value=!1}},H=e=>{l.value.commercial_name=e,p.value=[],m.value=!1},K=e=>{const t=e.target.value;l.value.commercial_name=t,Y(t)},Q=e=>{e.preventDefault(),y.value=!0},X=()=>y.value=!1,Z=e=>{w.value=e;const t=new FileReader;t.onload=r=>$.value=r.target.result,t.readAsDataURL(e),y.value=!1},B=e=>{var r,u,_;const t=((r=e.target.files)==null?void 0:r[0])||((_=(u=e.dataTransfer)==null?void 0:u.files)==null?void 0:_[0]);t&&t.type.startsWith("image/")&&Z(t)},ee=()=>{w.value=null,$.value=null},te=()=>(c.value.company_id=!l.value.company_id,c.value.commercial_name=!l.value.commercial_name,c.value.price=l.value.price===null||l.value.price==="",c.value.price_unit=!l.value.price_unit,!Object.values(c.value).some(e=>e)),ae=async()=>{var t,r;if(!te())return;V.value=!0;const e=new FormData;e.append("category_id",l.value.category_id||""),e.append("company_id",l.value.company_id||""),e.append("commercial_name",l.value.commercial_name||""),l.value.active_ingredient.forEach((u,_)=>e.append(`scientific_structure[${_}]`,u)),e.append("usage",l.value.usage||""),e.append("calibres",l.value.calibres||""),e.append("quantity",l.value.quantity?Math.floor(l.value.quantity):""),e.append("quantity_unit",l.value.quantity_unit||""),e.append("price",l.value.price?Number(l.value.price).toFixed(2):""),e.append("price_unit",l.value.price_unit||""),e.append("expiration_from",l.value.expiration_from||""),e.append("expiration_to",l.value.expiration_to||""),e.append("storage_notes",l.value.storage_notes||""),e.append("pharmaceutical_form",l.value.pharmaceutical_form||""),w.value&&e.append("product_image",w.value);try{await b.post("/api/product",e),P.push({name:"products"}),F.add({severity:"success",summary:v("success"),detail:v("product_created"),life:3e3})}catch(u){F.add({severity:"error",summary:v("error"),detail:((r=(t=u.response)==null?void 0:t.data)==null?void 0:r.message)||v("error_creating_product"),life:3e3})}finally{V.value=!1}};return de(()=>{S(),L(),j()}),(e,t)=>{const r=d("Dropdown"),u=d("InputText"),_=d("MultiSelect"),G=d("Textarea"),M=d("InputNumber"),R=d("Calendar"),le=d("Button"),oe=d("Form"),se=d("Toast"),ne=pe("can");return me((g(),f("div",ye,[a("h1",be,s(e.$t("product.create_new_product")),1),n(oe,{onSubmit:k(ae,["prevent"]),class:"space-y-6"},{default:ve(()=>[a("div",he,[a("div",xe,[a("label",Ve,s(e.$t("product.category")),1),n(r,{id:"category",modelValue:l.value.category_id,"onUpdate:modelValue":t[0]||(t[0]=o=>l.value.category_id=o),options:C.value,optionLabel:"name_ar",optionValue:"id",placeholder:e.$t("product.select_category"),filter:"",onFilter:A,class:"w-full"},null,8,["modelValue","options","placeholder"])]),a("div",we,[a("label",$e,[h(s(e.$t("product.company"))+" ",1),t[16]||(t[16]=a("span",{class:"text-red-500"},"*",-1))]),n(r,{id:"company",modelValue:l.value.company_id,"onUpdate:modelValue":t[1]||(t[1]=o=>l.value.company_id=o),options:q.value,optionLabel:"name",optionValue:"id",placeholder:e.$t("product.select_company"),filter:"",onFilter:J,class:x(["w-full",{"p-invalid":c.value.company_id}])},null,8,["modelValue","options","placeholder","class"])]),a("div",ke,[a("label",Fe,[h(s(e.$t("product.commercial_name"))+" ",1),t[17]||(t[17]=a("span",{class:"text-red-500"},"*",-1))]),n(u,{id:"commercial_name",modelValue:l.value.commercial_name,"onUpdate:modelValue":t[2]||(t[2]=o=>l.value.commercial_name=o),placeholder:e.$t("product.enter_commercial_name"),class:x(["w-full",{"p-invalid":c.value.commercial_name}]),onInput:K,onFocus:t[3]||(t[3]=o=>m.value=p.value.length>0),onBlur:t[4]||(t[4]=o=>e.setTimeout(()=>m.value=!1,200))},null,8,["modelValue","placeholder","class"]),m.value?(g(),f("div",Ie,[a("ul",Ce,[(g(!0),f(_e,null,ge(p.value,o=>(g(),f("li",{key:o.id,onClick:mt=>H(o.commercial_name),class:"px-4 py-2 text-sm hover:bg-blue-50 cursor-pointer"},s(o.commercial_name),9,qe))),128))])])):fe("",!0)]),a("div",Ue,[a("label",De,s(e.$t("product.active_ingredient")),1),n(_,{id:"active_ingredient",modelValue:l.value.active_ingredient,"onUpdate:modelValue":t[5]||(t[5]=o=>l.value.active_ingredient=o),options:U.value,optionLabel:"name",optionValue:"name",placeholder:e.$t("product.select_active_ingredient"),filter:"",onFilter:W,display:"chip",class:"w-full"},null,8,["modelValue","options","placeholder"])]),a("div",Ne,[a("label",Te,s(e.$t("product.usage")),1),n(G,{id:"usage",modelValue:l.value.usage,"onUpdate:modelValue":t[6]||(t[6]=o=>l.value.usage=o),placeholder:e.$t("product.enter_usage"),class:"w-full"},null,8,["modelValue","placeholder"])]),a("div",Se,[a("label",Le,s(e.$t("product.calibres")),1),n(u,{id:"calibres",modelValue:l.value.calibres,"onUpdate:modelValue":t[7]||(t[7]=o=>l.value.calibres=o),placeholder:e.$t("product.enter_calibres"),class:"w-full"},null,8,["modelValue","placeholder"])]),a("div",je,[a("label",Be,s(e.$t("product.quantity")),1),n(M,{id:"quantity",modelValue:l.value.quantity,"onUpdate:modelValue":t[8]||(t[8]=o=>l.value.quantity=o),useGrouping:!1,class:"w-full"},null,8,["modelValue"])]),a("div",Ge,[a("label",Me,s(e.$t("product.quantity_unit")),1),n(r,{id:"quantity_unit",modelValue:l.value.quantity_unit,"onUpdate:modelValue":t[9]||(t[9]=o=>l.value.quantity_unit=o),options:[{label:e.$t("tablets"),value:"tablets"},{label:e.$t("capsules"),value:"capsules"},{label:e.$t("units"),value:"units"},{label:e.$t("boxes"),value:"boxes"},{label:e.$t("bottles"),value:"bottles"}],optionLabel:"label",optionValue:"value",placeholder:e.$t("product.select_quantity_unit"),class:"w-full"},null,8,["modelValue","options","placeholder"])]),a("div",Re,[a("label",Pe,[h(s(e.$t("product.price"))+" ",1),t[18]||(t[18]=a("span",{class:"text-red-500"},"*",-1))]),n(M,{id:"price",modelValue:l.value.price,"onUpdate:modelValue":t[10]||(t[10]=o=>l.value.price=o),mode:"decimal",minFractionDigits:2,maxFractionDigits:2,class:x(["w-full",{"p-invalid":c.value.price}])},null,8,["modelValue","class"])]),a("div",ze,[a("label",Ee,[h(s(e.$t("product.price_unit"))+" ",1),t[19]||(t[19]=a("span",{class:"text-red-500"},"*",-1))]),n(r,{id:"price_unit",modelValue:l.value.price_unit,"onUpdate:modelValue":t[11]||(t[11]=o=>l.value.price_unit=o),options:[{label:"ل.س",value:"ل.س"},{label:"$",value:"$"}],optionLabel:"label",optionValue:"value",placeholder:e.$t("product.select_price_unit"),class:x(["w-full",{"p-invalid":c.value.price_unit}])},null,8,["modelValue","placeholder","class"])]),a("div",Oe,[a("label",Ae,s(e.$t("product.expiration_from")),1),n(R,{id:"expiration_from",modelValue:l.value.expiration_from,"onUpdate:modelValue":t[12]||(t[12]=o=>l.value.expiration_from=o),dateFormat:"yy-mm-dd",showIcon:!0,manualInput:!1,class:"w-full"},null,8,["modelValue"])]),a("div",Je,[a("label",We,s(e.$t("product.expiration_to")),1),n(R,{id:"expiration_to",modelValue:l.value.expiration_to,"onUpdate:modelValue":t[13]||(t[13]=o=>l.value.expiration_to=o),dateFormat:"yy-mm-dd",showIcon:!0,manualInput:!1,class:"w-full"},null,8,["modelValue"])]),a("div",Ye,[a("label",He,s(e.$t("product.storage_notes")),1),n(G,{id:"storage_notes",modelValue:l.value.storage_notes,"onUpdate:modelValue":t[14]||(t[14]=o=>l.value.storage_notes=o),placeholder:e.$t("product.enter_storage_notes"),class:"w-full"},null,8,["modelValue","placeholder"])]),a("div",Ke,[a("label",Qe,s(e.$t("product.pharmaceutical_form")),1),n(u,{id:"pharmaceutical_form",modelValue:l.value.pharmaceutical_form,"onUpdate:modelValue":t[15]||(t[15]=o=>l.value.pharmaceutical_form=o),placeholder:e.$t("product.enter_pharmaceutical_form"),class:"w-full"},null,8,["modelValue","placeholder"])]),a("div",Xe,[a("label",Ze,s(e.$t("product.product_image")),1),a("div",et,[a("label",{onDragover:k(Q,["prevent"]),onDragleave:X,onDrop:k(B,["prevent"]),class:x([{"border-blue-500 bg-blue-50":y.value,"border-gray-300":!y.value},"cursor-pointer w-full max-w-md rounded-xl border-2 border-dashed transition-colors duration-300"])},[a("input",{type:"file",onChange:B,accept:"image/*",class:"hidden"},null,32),$.value?(g(),f("div",tt,[a("div",at,[a("img",{src:$.value,alt:"Preview",class:"w-full h-64 object-cover rounded-lg shadow-md group-hover:scale-105 transition-transform"},null,8,lt),a("div",ot,[a("div",st,[a("button",{type:"button",onClick:k(ee,["stop"]),class:"bg-red-500 text-white p-2 rounded-full hover:bg-red-600"},[...t[20]||(t[20]=[a("i",{class:"pi pi-trash text-sm"},null,-1)])]),t[21]||(t[21]=a("button",{type:"button",class:"bg-white text-gray-700 p-2 rounded-full hover:bg-gray-100"},[a("i",{class:"pi pi-pencil text-sm"})],-1))])])]),a("p",nt,s(e.$t("product.click_or_drag_to_change_photo")),1)])):(g(),f("div",rt,[t[22]||(t[22]=a("div",{class:"bg-blue-100 p-4 rounded-full mb-4"},[a("i",{class:"pi pi-image text-blue-500 text-2xl"})],-1)),a("p",it,[a("span",ut,s(e.$t("product.click_to_upload")),1),h(" "+s(e.$t("product.or_drag_and_drop")),1)]),t[23]||(t[23]=a("p",{class:"text-xs text-gray-400"},"SVG, PNG, JPG أو GIF (حد أقصى 1 ميجا)",-1))]))],34)])])]),a("div",ct,[n(le,{type:"submit",label:e.$t("product.create_product"),icon:"pi pi-plus",loading:V.value,class:"px-8 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg shadow-md hover:shadow-lg transition-all",disabled:V.value},null,8,["label","loading","disabled"])])]),_:1}),n(se)])),[[ne,"create products"]])}}},_t=re(dt,[["__scopeId","data-v-018f3a83"]]);export{_t as default};
