import{_ as ee,u as te,i as se,J as oe,j as le,r as _,d as ae,Y as y,o as d,c as u,k as e,q as M,t as s,m as o,z as n,s as P,v as E,F as O,x as W,B as S,y as B}from"./index-800b62dc.js";const ie={class:"p-6 md:p-10 bg-gray-100 min-h-screen"},re={class:"container mx-auto"},de={class:"bg-white shadow-2xl rounded-2xl p-6 lg:p-10"},ne={class:"flex flex-col md:flex-row items-start md:items-center justify-between mb-8 pb-4 border-b-2 border-gray-200"},ce={class:"text-3xl font-extrabold text-gray-800"},ue={class:"text-indigo-600"},me={class:"flex flex-col md:flex-row space-y-4 md:space-y-0"},_e={key:0,class:"flex items-center justify-center h-64"},ve={key:1,class:"space-y-8"},ge={class:"grid grid-cols-1 md:grid-cols-2 gap-8 p-6 bg-gray-50 rounded-xl shadow-inner"},ye={class:"space-y-4"},pe={class:"field"},he={class:"font-semibold text-gray-600"},xe={class:"text-gray-900 text-lg font-medium"},be={class:"field"},fe={class:"font-semibold text-gray-600"},we={class:"text-gray-900 text-lg font-medium"},ke={class:"field"},Ce={class:"font-semibold text-gray-600"},Ee={class:"text-gray-900 text-lg font-medium"},Te={class:"field"},Ve={class:"font-semibold text-gray-600"},De={class:"text-gray-900 text-lg font-medium"},Pe={class:"space-y-4"},Se={class:"field"},Re={class:"font-semibold text-gray-600"},Be={class:"field"},Ne={class:"font-semibold text-gray-600"},Ie={class:"text-gray-900 text-lg font-medium"},$e={class:"field"},je={class:"font-semibold text-gray-600"},Ue={class:"text-gray-900 text-lg font-medium"},qe={class:"field"},ze={class:"font-semibold text-gray-600"},Fe={class:"text-gray-900 text-lg font-medium"},Le={class:"field"},Ae={class:"font-semibold text-gray-600"},Je={class:"text-gray-900 text-lg font-medium"},Me={class:"field"},Oe={class:"font-semibold text-gray-600"},We={class:"text-gray-900 text-lg font-medium"},Ye={class:"bg-gray-50 p-6 rounded-xl shadow-inner"},Ge={class:"text-2xl font-bold text-gray-800 mb-4"},He={class:"p-4 bg-gray-100 border-t border-gray-200"},Ke={class:"text-xl font-semibold text-gray-700 mb-4"},Qe={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Xe={class:"font-medium text-gray-600 mb-2"},Ze={key:0,class:"bg-white rounded-lg shadow-md divide-y divide-gray-200 border border-gray-200 max-h-60 overflow-y-auto"},et={class:"flex items-center justify-between mb-1"},tt={class:"m-0 text-gray-800 text-sm font-medium leading-snug"},st={class:"text-gray-500 text-xs block mt-1"},ot={key:1,class:"text-center p-4 text-gray-500 text-sm bg-white rounded-lg shadow-inner border border-gray-200"},lt={class:"font-medium text-gray-600 mb-2"},at={class:"space-y-3 p-3 bg-white rounded-lg shadow-md border border-gray-200"},it={class:"py-10 text-center text-gray-500"},rt={class:"text-lg"},dt={class:"bg-gray-50 p-6 rounded-xl shadow-inner"},nt={class:"text-2xl font-bold text-gray-800 mb-4"},ct={key:0,class:"bg-white rounded-lg shadow-md divide-y divide-gray-200"},ut={class:"flex items-center justify-between mb-1"},mt={class:"m-0 text-gray-800"},_t={class:"text-gray-500"},vt={key:1,class:"py-10 text-center text-gray-500"},gt={class:"text-lg"},yt={class:"mt-6"},pt={class:"text-xl font-bold text-gray-800 mb-3"},ht={class:"space-y-4"},xt={key:2,class:"py-20 text-center text-gray-500"},bt={class:"text-2xl font-semibold"},ft={key:0,class:"space-y-6 p-4"},wt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},kt={class:"space-y-4"},Ct={class:"field"},Et={class:"font-semibold text-gray-600"},Tt={class:"text-gray-900 text-lg font-medium"},Vt={class:"field"},Dt={class:"font-semibold text-gray-600"},Pt={class:"field"},St={class:"font-semibold text-gray-600"},Rt={class:"text-gray-900 text-lg font-medium"},Bt={class:"space-y-4"},Nt={class:"field"},It={class:"font-semibold text-gray-600"},$t={class:"text-gray-900 text-lg font-medium"},jt={class:"field"},Ut={class:"font-semibold text-gray-600"},qt={class:"text-gray-900 text-lg font-medium"},zt={class:"field"},Ft={class:"font-semibold text-gray-600"},Lt={class:"text-gray-900 text-lg font-medium"},At={class:"field"},Jt={class:"font-semibold text-gray-600"},Mt={class:"text-gray-900 text-lg font-medium"},Ot={__name:"show",setup(Wt){const{t}=te(),Y=se(),R=oe(),m=le(),p=_(!0),b=_(!1),a=_(null),f=_(""),k=_(!1),T=_(!1),v=_({}),h=_({}),N=_([]),I=r=>{switch(r==null?void 0:r.toLowerCase()){case"pending":return"warning";case"completed":case"paid":return"success";case"cancelled":return"danger";case"unpaid":return"warning";default:return"info"}},V=async()=>{p.value=!0;try{const r=await S.get(`/api/order/${R.params.id}`);a.value=r.data.data,a.value.items.forEach(l=>{v.value[l.id]||(v.value[l.id]=""),h.value[l.id]||(h.value[l.id]=!1)})}catch(r){m.add({severity:"error",summary:t("error"),detail:t("order.loadError"),life:3e3}),console.error("Error fetching order:",r)}finally{p.value=!1}},G=async()=>{var r,l;if(!f.value.trim()){m.add({severity:"error",summary:t("error"),detail:t("order.commentEmpty"),life:3e3});return}k.value=!0;try{await S.post(`/api/order/comment/${R.params.id}`,{body:f.value}),m.add({severity:"success",summary:t("success"),detail:t("order.commentSuccess"),life:3e3}),f.value="",await V()}catch(c){const g=((l=(r=c.response)==null?void 0:r.data)==null?void 0:l.message)||t("order.commentError");m.add({severity:"error",summary:t("error"),detail:g,life:3e3}),console.error("Error adding comment:",c)}finally{k.value=!1}},H=async r=>{var l,c,g;if(!((l=v.value[r])!=null&&l.trim())){m.add({severity:"error",summary:t("error"),detail:t("order.commentEmpty"),life:3e3});return}h.value[r]=!0;try{await S.post(`/api/order/item/comment/${r}`,{body:v.value[r]}),m.add({severity:"success",summary:t("success"),detail:t("order.itemCommentSuccess"),life:3e3}),v.value[r]="",await V()}catch(D){const w=((g=(c=D.response)==null?void 0:c.data)==null?void 0:g.message)||t("order.itemCommentError");m.add({severity:"error",summary:t("error"),detail:w,life:3e3}),console.error("Error adding item comment:",D)}finally{h.value[r]=!1}},K=async()=>{var r,l;b.value=!0;try{await S.post("/api/invoice",{order_id:R.params.id}),m.add({severity:"success",summary:t("success"),detail:t("order.invoiceCreated"),life:3e3}),await V()}catch(c){const g=((l=(r=c.response)==null?void 0:r.data)==null?void 0:l.message)||t("order.invoiceError");m.add({severity:"error",summary:t("error"),detail:g,life:3e3}),console.error("Error creating invoice:",c)}finally{b.value=!1}},Q=()=>{T.value=!0};return ae(()=>{V()}),(r,l)=>{var j,U,q,z,F;const c=y("Button"),g=y("Toast"),D=y("ProgressSpinner"),w=y("Tag"),C=y("Column"),$=y("Textarea"),X=y("DataTable"),Z=y("Dialog");return d(),u("div",ie,[e("div",re,[e("div",de,[e("div",ne,[e("h1",ce,[M(s(o(t)("order.detailsTitle"))+" ",1),e("span",ue,"#"+s(((j=a.value)==null?void 0:j.number)||"..."),1)]),e("div",me,[n(c,{label:o(t)("order.back"),icon:"pi pi-arrow-left",class:"px-6 py-2 rounded-full border border-gray-300 text-gray-700 hover:bg-gray-100 transition-colors duration-200",disabled:p.value||b.value,onClick:l[0]||(l[0]=i=>o(Y).push({name:"order_list"}))},null,8,["label","disabled"]),(U=a.value)!=null&&U.invoice?(d(),P(c,{key:0,label:o(t)("order.viewInvoice"),icon:"pi pi-file",class:"px-6 py-2 rounded-full mx-2 bg-blue-600 text-white hover:bg-blue-700 transition-colors duration-200",disabled:p.value||b.value,onClick:Q},null,8,["label","disabled"])):(d(),P(c,{key:1,label:o(t)("order.createInvoice"),icon:"pi pi-file",class:"px-6 py-2 rounded-full mx-2 bg-green-600 text-white hover:bg-green-700 transition-colors duration-200",loading:b.value,disabled:p.value||b.value,onClick:K},null,8,["label","loading","disabled"]))])]),n(g),p.value?(d(),u("div",_e,[n(D,{style:{width:"60px",height:"60px"},strokeWidth:"4",class:"text-indigo-600"})])):a.value?(d(),u("div",ve,[e("div",ge,[e("div",ye,[e("div",pe,[e("label",he,s(o(t)("order.orderNumber")),1),e("p",xe,s(a.value.number),1)]),e("div",be,[e("label",fe,s(o(t)("order.pharmacy")),1),e("p",we,s(((q=a.value.pharmacy)==null?void 0:q.name)||"-"),1)]),e("div",ke,[e("label",Ce,s(o(t)("order.warehouse")),1),e("p",Ee,s(((z=a.value.warehouse)==null?void 0:z.name)||"-"),1)]),e("div",Te,[e("label",Ve,s(o(t)("order.notes")),1),e("p",De,s(a.value.notes||"-"),1)])]),e("div",Pe,[e("div",Se,[e("label",Re,s(o(t)("order.status")),1),n(w,{value:a.value.status_description,severity:I(a.value.status_description),class:"px-3 py-1 text-sm font-semibold rounded-full"},null,8,["value","severity"])]),e("div",Be,[e("label",Ne,s(o(t)("order.originalPrice")),1),e("p",Ie,s(a.value.original_price),1)]),e("div",$e,[e("label",je,s(o(t)("order.delivery")),1),e("p",Ue,s(a.value.delivery),1)]),e("div",qe,[e("label",ze,s(o(t)("order.totalDiscounts")),1),e("p",Fe,s(a.value.total_discounts),1)]),e("div",Le,[e("label",Ae,s(o(t)("order.totalPrice")),1),e("p",Je,s(a.value.total_price),1)]),e("div",Me,[e("label",Oe,s(o(t)("order.createdAt")),1),e("p",We,s(a.value.created_at),1)])])]),e("div",Ye,[e("h3",Ge,s(o(t)("order.items")),1),n(X,{value:a.value.items,loading:p.value,"data-key":"id",expandedRows:N.value,"onUpdate:expandedRows":l[1]||(l[1]=i=>N.value=i),"responsive-layout":"scroll",class:"rounded-lg overflow-hidden border border-gray-200"},{expansion:E(({data:i})=>{var L,A,J;return[e("div",He,[e("h4",Ke,s(o(t)("order.itemComments"))+" for "+s(i.product.commercial_name),1),e("div",Qe,[e("div",null,[e("h5",Xe,s(o(t)("order.existingComments"))+" ("+s(((L=i.comments)==null?void 0:L.length)||0)+")",1),(A=i.comments)!=null&&A.length?(d(),u("div",Ze,[(d(!0),u(O,null,W(i.comments,x=>(d(),u("div",{key:x.id,class:"p-3"},[e("div",et,[e("p",tt,s(x.body),1),x.is_you?(d(),P(w,{key:0,value:o(t)("order.you"),severity:"info",class:"ml-2 bg-indigo-100 text-indigo-800 rounded-full px-2 py-0.5 text-xs font-medium flex-shrink-0"},null,8,["value"])):B("",!0)]),e("small",st,s(x.created_at),1)]))),128))])):(d(),u("div",ot,[l[5]||(l[5]=e("i",{class:"pi pi-comment text-lg mb-1"},null,-1)),e("p",null,s(o(t)("order.noItemComments")),1)]))]),e("div",null,[e("h5",lt,s(o(t)("order.addItemComment")),1),e("div",at,[n($,{modelValue:v.value[i.id],"onUpdate:modelValue":x=>v.value[i.id]=x,placeholder:o(t)("order.itemCommentPlaceholder"),disabled:h.value[i.id],rows:"3",class:"w-full rounded-lg border border-gray-300 p-2 text-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200",autoResize:""},null,8,["modelValue","onUpdate:modelValue","placeholder","disabled"]),n(c,{label:o(t)("order.submitComment"),icon:"pi pi-check",class:"px-4 py-1 rounded-lg bg-indigo-600 text-white text-sm font-semibold hover:bg-indigo-700 transition-colors duration-200",disabled:h.value[i.id]||!((J=v.value[i.id])!=null&&J.trim()),loading:h.value[i.id],onClick:x=>H(i.id)},null,8,["label","disabled","loading","onClick"])])])])])]}),empty:E(()=>[e("div",it,[l[6]||(l[6]=e("i",{class:"pi pi-exclamation-circle text-4xl mb-2"},null,-1)),e("p",rt,s(o(t)("order.noItems")),1)])]),default:E(()=>[n(C,{expander:!0,"header-style":"width: 3rem"}),l[7]||(l[7]=M()),n(C,{field:"product.commercial_name",header:o(t)("order.itemName"),"header-style":"width:30%;"},null,8,["header"]),n(C,{field:"quantity",header:o(t)("order.quantity"),"header-style":"width:20%;"},null,8,["header"]),n(C,{field:"original_price",header:o(t)("order.price"),"header-style":"width:20%;"},null,8,["header"]),n(C,{field:"total_price",header:o(t)("order.total"),"header-style":"width:20%;"},null,8,["header"])]),_:1},8,["value","loading","expandedRows"])]),e("div",dt,[e("h3",nt,s(o(t)("order.comments")),1),(F=a.value.comments)!=null&&F.length?(d(),u("div",ct,[(d(!0),u(O,null,W(a.value.comments,i=>(d(),u("div",{key:i.id,class:"p-4"},[e("div",ut,[e("p",mt,s(i.body),1),i.is_you?(d(),P(w,{key:0,value:o(t)("order.you"),severity:"info",class:"ml-2 bg-indigo-100 text-indigo-800 rounded-full px-2 py-0.5 text-xs font-medium"},null,8,["value"])):B("",!0)]),e("small",_t,s(i.created_at),1)]))),128))])):(d(),u("div",vt,[l[8]||(l[8]=e("i",{class:"pi pi-comment text-4xl mb-2"},null,-1)),e("p",gt,s(o(t)("order.noComments")),1)])),e("div",yt,[e("h4",pt,s(o(t)("order.addComment")),1),e("div",ht,[n($,{modelValue:f.value,"onUpdate:modelValue":l[2]||(l[2]=i=>f.value=i),placeholder:o(t)("order.commentPlaceholder"),disabled:k.value,rows:"4",class:"w-full rounded-lg border border-gray-300 p-3 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200",autoResize:""},null,8,["modelValue","placeholder","disabled"]),n(c,{label:o(t)("order.submitComment"),icon:"pi pi-check",class:"px-6 py-2 rounded-lg bg-indigo-600 text-white font-semibold hover:bg-indigo-700 transition-colors duration-200",disabled:k.value||!f.value.trim(),loading:k.value,onClick:G},null,8,["label","disabled","loading"])])])])])):(d(),u("div",xt,[l[9]||(l[9]=e("i",{class:"pi pi-exclamation-circle text-6xl mb-4"},null,-1)),e("p",bt,s(o(t)("order.notFound")),1)])),n(Z,{visible:T.value,"onUpdate:visible":l[4]||(l[4]=i=>T.value=i),header:o(t)("order.invoiceDetails"),modal:!0,style:{width:"50vw"},class:"rounded-lg",breakpoints:{"960px":"75vw","640px":"90vw"}},{footer:E(()=>[n(c,{label:o(t)("order.close"),icon:"pi pi-times",class:"p-button-text p-button-secondary",onClick:l[3]||(l[3]=i=>T.value=!1)},null,8,["label"])]),default:E(()=>{var i;return[(i=a.value)!=null&&i.invoice?(d(),u("div",ft,[e("div",wt,[e("div",kt,[e("div",Ct,[e("label",Et,s(o(t)("order.invoiceNumber")),1),e("p",Tt,s(a.value.invoice.number),1)]),e("div",Vt,[e("label",Dt,s(o(t)("order.invoiceStatus")),1),n(w,{value:a.value.invoice.status_description,severity:I(a.value.invoice.status_description),class:"px-3 py-1 text-sm font-semibold rounded-full"},null,8,["value","severity"])]),e("div",Pt,[e("label",St,s(o(t)("order.originalPrice")),1),e("p",Rt,s(a.value.invoice.original_price),1)])]),e("div",Bt,[e("div",Nt,[e("label",It,s(o(t)("order.delivery")),1),e("p",$t,s(a.value.invoice.delivery),1)]),e("div",jt,[e("label",Ut,s(o(t)("order.totalDiscounts")),1),e("p",qt,s(a.value.invoice.total_discounts),1)]),e("div",zt,[e("label",Ft,s(o(t)("order.totalPrice")),1),e("p",Lt,s(a.value.invoice.total_price),1)]),e("div",At,[e("label",Jt,s(o(t)("order.totalPaid")),1),e("p",Mt,s(a.value.invoice.total_paid),1)])])])])):B("",!0)]}),_:1},8,["visible","header"])])])])}}},Gt=ee(Ot,[["__scopeId","data-v-7ab4f78a"]]);export{Gt as default};
