import{_ as K,a0 as Q,u as X,a as Y,z as Z,r as c,o as ee,e as u,h as m,g as e,j as o,t as n,B as C,i as d,F as te,y as le,w,b as D,s as ae,A as B,E as k,H as f,f as oe,C as se,D as V,a1 as I,k as re}from"./index-2cd76906.js";import{O as ne,x as ie}from"./index.es-685cb9ec.js";const de={class:"bg-gray-50 min-h-screen p-4 md:p-8"},pe={class:"bg-white rounded-xl shadow-md p-6 flex flex-col md:flex-row items-center justify-between gap-6 mb-8"},ce={class:"flex flex-col-reverse md:flex-row items-center text-center gap-6"},ue=["src","alt"],me={class:"flex flex-col items-center gap-2"},ge={class:"text-2xl md:text-3xl font-bold text-gray-900"},fe={class:"flex items-center gap-2"},ve={class:"text-sm text-gray-700"},_e={class:"flex items-center gap-2"},he=["href"],ye={class:"flex items-center gap-2"},xe={class:"text-sm text-gray-700"},be={class:"flex items-center gap-2"},we={class:"text-sm text-gray-700"},ke={class:"flex items-start gap-4"},Ve={class:"flex flex-col items-end gap-2"},Ee={class:"flex items-center gap-2 mb-2 bg-[#DCFCE7] px-2 rounded-md"},Ce={class:"text-sm font-semibold text-gray-700"},De={class:"bg-white rounded-xl shadow-md p-6"},$e={class:"flex flex-col-reverse md:flex-row items-center justify-between gap-4 mb-6"},Le={class:"text-xl md:text-2xl font-bold text-gray-900"},Fe={class:"text-green-600 hover:underline text-sm font-semibold"},Ue={key:0,class:"flex justify-center mb-10"},je={key:1,class:"text-center text-gray-600 py-8"},Se={key:2,class:"overflow-x-auto"},Be={class:"w-full text-left rtl:text-right table-auto"},Ie={class:"text-gray-500 text-sm border-b border-gray-200"},Pe={class:"p-4 whitespace-nowrap"},Me={class:"p-4 whitespace-nowrap"},Ge={class:"p-4 whitespace-nowrap"},Ne={class:"p-4 whitespace-nowrap"},ze={class:"p-4 whitespace-nowrap"},Ae={class:"p-4 text-gray-700 font-medium whitespace-nowrap"},Oe={class:"p-4 text-gray-500 whitespace-nowrap"},Re={class:"p-4 text-gray-700 whitespace-nowrap"},Te={class:"p-4 whitespace-nowrap"},He={class:"p-4 text-gray-700 font-semibold whitespace-nowrap"},Je={class:"p-fluid grid grid-cols-1 md:grid-cols-2 gap-4"},We={class:"field"},qe={for:"name",class:"font-bold"},Ke={class:"field"},Qe={for:"owner_name",class:"font-bold"},Xe={class:"field"},Ye={for:"license_number",class:"font-bold"},Ze={class:"field"},et={for:"phone",class:"font-bold"},tt={class:"field md:col-span-2"},lt={for:"address",class:"font-bold"},at={class:"field"},ot={for:"lat",class:"font-bold"},st={class:"field"},rt={for:"long",class:"font-bold"},nt={class:"field md:col-span-2"},it={class:"font-bold"},dt={class:"text-gray-500"},pt={class:"field md:col-span-2"},ct={class:"font-bold text-center"},ut={key:0,class:"p-4"},mt={class:"relative group"},gt=["src"],ft={class:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-0 rounded-lg group-hover:bg-opacity-40 transition-all duration-300"},vt={class:"space-x-3 transform translate-y-4 opacity-0 group-hover:opacity-100 group-hover:translate-y-0 transition-all duration-300"},_t={key:1,class:"flex flex-col items-center justify-center h-full p-4"},ht={class:"mb-1 text-sm text-center text-gray-600"},yt={class:"font-medium text-green-500"},xt={class:"m-0 mb-4"},bt={class:"flex justify-end gap-2"},wt={__name:"profile",setup(kt){const P=Q(),{t:a}=X(),p=Y(),M=Z(),_=c([]),b=c(!1),h=c(!1),y=c(!1),E=c(!1),x=c({pharmacy_logo:!1}),v=c(null),i=c({id:null,name:"",owner_name:"",license_number:"",phone:"",address:"",lat:"",long:"",status:null,pharmacy_logo:null,status_description:""}),s=c({...i.value,pharmacy_logo_preview:null}),G=r=>{x.value[r]=!0},N=r=>{x.value[r]=!1},$=(r,t)=>{var g,F,U;const l=((F=(g=r.dataTransfer)==null?void 0:g.files)==null?void 0:F[0])||((U=r.target.files)==null?void 0:U[0]);if(l){if(!l.type.match("image.*")){p.add({severity:"error",summary:a("error"),detail:a("auth.invalid_image_type"),life:3e3});return}if(l.size>1024*1024){p.add({severity:"error",summary:a("error"),detail:a("auth.image_too_large"),life:3e3});return}v.value=l;const j=new FileReader;j.onload=q=>{var S;s.value.pharmacy_logo_preview=(S=q.target)==null?void 0:S.result},j.readAsDataURL(l),x.value[t]=!1}},z=r=>{v.value=null,s.value.pharmacy_logo_preview=null,i.value.pharmacy_logo&&(s.value.pharmacy_logo=null);const t=document.getElementById(r);t&&(t.value="")},A=r=>{const t=document.getElementById(r);t&&t.click()},O=r=>{const t=r.latLng,l=t.lat(),g=t.lng();s.value.lat=l.toString(),s.value.long=g.toString()},R=()=>{s.value={...i.value},s.value.pharmacy_logo_preview=i.value.pharmacy_logo,v.value=null,y.value=!0},T=async()=>{var r,t;E.value=!0;try{const l=new FormData;l.append("name",s.value.name),l.append("owner_name",s.value.owner_name),l.append("license_number",s.value.license_number||""),l.append("phone",s.value.phone),l.append("address",s.value.address),l.append("lat",s.value.lat),l.append("long",s.value.long),v.value?l.append("pharmacy_logo",v.value):i.value.pharmacy_logo&&s.value.pharmacy_logo===null&&l.append("remove_logo",1);const g=await D.post("/api/pharmacy/profile/update",l,{});g.data.success?(i.value={...s.value},v.value=null,y.value=!1,p.add({severity:"success",summary:a("success"),detail:a("profile.updateSuccess"),life:3e3}),await L()):p.add({severity:"warn",summary:a("warning"),detail:g.data.message||a("profile.updateError"),life:3e3})}catch(l){p.add({severity:"error",summary:a("error"),detail:((t=(r=l.response)==null?void 0:r.data)==null?void 0:t.message)||a("profile.updateError"),life:3e3}),console.error("Error updating profile:",l)}finally{E.value=!1}},L=async()=>{try{const r=await D.get("/api/pharmacy/profile/data");r.data.success&&r.data.data?(i.value=r.data.data,s.value={...r.data.data},s.value.pharmacy_logo_preview=r.data.data.pharmacy_logo):p.add({severity:"warn",summary:a("warning"),detail:a("profile.fetchError"),life:3e3})}catch(r){p.add({severity:"error",summary:a("error"),detail:a("profile.fetchError"),life:3e3}),console.error("Error fetching profile:",r)}},H=async()=>{b.value=!0;try{const r=await D.get("/api/order");r.data.success&&r.data.data?_.value=r.data.data:_.value=[]}catch(r){_.value=[],p.add({severity:"error",summary:a("error"),detail:a("orders.fetchError"),life:3e3}),console.error("Error fetching orders:",r)}finally{b.value=!1}},J=async()=>{try{P.pharmacyhandleLogout(),M.push({name:"login"})}catch(r){p.add({severity:"error",summary:a("error"),detail:a("profile.logoutError"),life:3e3}),console.error("Error logging out:",r)}finally{h.value=!1}},W=r=>new Date(r).toLocaleDateString("ar-EG",{day:"2-digit",month:"long",year:"numeric"});return ee(()=>{L(),H()}),(r,t)=>(u(),m("div",de,[e("div",pe,[e("div",ce,[e("img",{src:i.value.pharmacy_logo||`https://api.dicebear.com/9.x/initials/svg?seed=${i.value.name}`,alt:o(a)("profile.alt"),class:"w-24 h-24 md:w-32 md:h-32 rounded-xl object-cover border-4 border-gray-200 shadow-md"},null,8,ue),e("div",me,[e("h1",ge,n(i.value.name),1),e("div",fe,[t[18]||(t[18]=e("i",{class:"pi pi-map-marker text-green-600"},null,-1)),e("span",ve,n(i.value.address),1)]),e("div",_e,[t[19]||(t[19]=e("i",{class:"pi pi-phone text-green-600"},null,-1)),e("a",{href:"tel:"+i.value.phone,class:"text-sm text-gray-700"},n(i.value.phone),9,he)]),e("div",ye,[t[20]||(t[20]=e("i",{class:"pi pi-user text-green-600"},null,-1)),e("span",xe,n(i.value.owner_name),1)]),e("div",be,[t[21]||(t[21]=e("i",{class:"pi pi-id-card text-green-600"},null,-1)),e("span",we,n(i.value.license_number),1)])])]),e("div",ke,[e("div",Ve,[e("div",Ee,[e("span",Ce,n(o(a)(`${i.value.status_description}`)),1)]),e("button",{onClick:R,class:"bg-[#0E3758] text-white font-bold py-2 px-4 rounded-lg flex items-center gap-2 transition-colors hover:bg-opacity-90"},[C(n(o(a)("profile.edit"))+" ",1),t[22]||(t[22]=e("i",{class:"pi pi-file-edit"},null,-1))]),e("button",{onClick:t[0]||(t[0]=l=>h.value=!0),class:"bg-red-600 text-white font-bold py-2 px-4 rounded-lg flex items-center gap-2 transition-colors hover:bg-red-700"},[C(n(o(a)("profile.logout"))+" ",1),t[23]||(t[23]=e("i",{class:"pi pi-sign-out"},null,-1))])])])]),e("div",De,[e("div",$e,[e("h2",Le,n(o(a)("orders.title")),1),e("button",Fe,n(o(a)("orders.viewAll")),1)]),b.value?(u(),m("div",Ue,[d(o(ae),{style:{width:"50px",height:"50px"},strokeWidth:"4"})])):!b.value&&_.value.length===0?(u(),m("div",je,[e("p",null,n(o(a)("orders.empty")),1)])):(u(),m("div",Se,[e("table",Be,[e("thead",null,[e("tr",Ie,[e("th",Pe,n(o(a)("orders.id")),1),e("th",Me,n(o(a)("orders.date")),1),e("th",Ge,n(o(a)("orders.warehouse")),1),e("th",Ne,n(o(a)("orders.statu")),1),e("th",ze,n(o(a)("orders.amount")),1)])]),e("tbody",null,[(u(!0),m(te,null,le(_.value,l=>(u(),m("tr",{key:l.id,class:"border-b border-gray-100"},[e("td",Ae,n(l.number),1),e("td",Oe,n(W(l.created_at)),1),e("td",Re,n(l.warehouse.name),1),e("td",Te,[e("span",{class:B(["px-3 py-1 text-xs font-medium rounded-full",{"bg-green-100 text-green-700":l.status_description==="delivered","bg-red-100 text-red-700":l.status_description==="cancelled","bg-yellow-100 text-yellow-700":l.status_description==="pending"}])},n(o(a)(`orders.status.${l.status_description}`)),3)]),e("td",He,n(l.total_price),1)]))),128))])])]))]),d(o(I),{visible:y.value,"onUpdate:visible":t[15]||(t[15]=l=>y.value=l),modal:"",header:o(a)("profile.edit"),style:{width:"50rem"},breakpoints:{"1199px":"75vw","575px":"90vw"},class:"p-dialog-rounded"},{footer:w(()=>[d(o(k),{label:o(a)("common.cancel"),icon:"pi pi-times",onClick:t[14]||(t[14]=l=>y.value=!1),class:"p-button-secondary",text:""},null,8,["label"]),d(o(k),{label:o(a)("common.save"),icon:"pi pi-check",onClick:T,loading:E.value,class:"bg-[#0E3758] text-white hover:bg-[#1a5b8f] border-transparent"},null,8,["label","loading"])]),default:w(()=>[e("div",Je,[e("div",We,[e("label",qe,n(o(a)("profile.name")),1),d(o(f),{id:"name",modelValue:s.value.name,"onUpdate:modelValue":t[1]||(t[1]=l=>s.value.name=l),placeholder:o(a)("profile.name"),class:"p-inputtext-sm"},null,8,["modelValue","placeholder"])]),e("div",Ke,[e("label",Qe,n(o(a)("profile.owner_name")),1),d(o(f),{id:"owner_name",modelValue:s.value.owner_name,"onUpdate:modelValue":t[2]||(t[2]=l=>s.value.owner_name=l),placeholder:o(a)("profile.owner_name"),class:"p-inputtext-sm"},null,8,["modelValue","placeholder"])]),e("div",Xe,[e("label",Ye,n(o(a)("profile.license_number")),1),d(o(f),{id:"license_number",modelValue:s.value.license_number,"onUpdate:modelValue":t[3]||(t[3]=l=>s.value.license_number=l),placeholder:o(a)("profile.license_number"),class:"p-inputtext-sm"},null,8,["modelValue","placeholder"])]),e("div",Ze,[e("label",et,n(o(a)("profile.phone")),1),d(o(f),{id:"phone",modelValue:s.value.phone,"onUpdate:modelValue":t[4]||(t[4]=l=>s.value.phone=l),placeholder:o(a)("profile.phone"),class:"p-inputtext-sm"},null,8,["modelValue","placeholder"])]),e("div",tt,[e("label",lt,n(o(a)("profile.address")),1),d(o(f),{id:"address",modelValue:s.value.address,"onUpdate:modelValue":t[5]||(t[5]=l=>s.value.address=l),placeholder:o(a)("profile.address"),class:"p-inputtext-sm"},null,8,["modelValue","placeholder"])]),e("div",at,[e("label",ot,n(o(a)("profile.lat")),1),d(o(f),{id:"lat",modelValue:s.value.lat,"onUpdate:modelValue":t[6]||(t[6]=l=>s.value.lat=l),placeholder:o(a)("profile.lat"),class:"p-inputtext-sm bg-gray-100 cursor-not-allowed",readonly:""},null,8,["modelValue","placeholder"])]),e("div",st,[e("label",rt,n(o(a)("profile.long")),1),d(o(f),{id:"long",modelValue:s.value.long,"onUpdate:modelValue":t[7]||(t[7]=l=>s.value.long=l),placeholder:o(a)("profile.long"),class:"p-inputtext-sm bg-gray-100 cursor-not-allowed",readonly:""},null,8,["modelValue","placeholder"])]),e("div",nt,[e("label",it,n(o(a)("profile.location")),1),d(o(ne),{onClick:O,style:{width:"100%",height:"300px","border-radius":"8px",overflow:"hidden"},center:{lat:s.value.lat?parseFloat(s.value.lat):33.5158,lng:s.value.long?parseFloat(s.value.long):36.2939},zoom:14,class:"shadow-md"},{default:w(()=>[s.value.lat&&s.value.long?(u(),oe(o(ie),{key:0,options:{position:{lat:parseFloat(s.value.lat),lng:parseFloat(s.value.long)}}},null,8,["options"])):se("",!0)]),_:1},8,["center"]),e("small",dt,n(o(a)("profile.map_instruction")),1)]),e("div",pt,[e("label",ct,n(o(a)("profile.pharmacy_logo")),1),e("label",{onDragover:t[11]||(t[11]=V(l=>G("pharmacy_logo"),["prevent"])),onDragleave:t[12]||(t[12]=l=>N("pharmacy_logo")),onDrop:t[13]||(t[13]=V(l=>$(l,"pharmacy_logo"),["prevent"])),class:B([{"border-green-400 bg-green-50":x.value.pharmacy_logo,"border-gray-200":!x.value.pharmacy_logo},"w-full h-40 rounded-lg cursor-pointer transition-all duration-300 hover:border-green-400 border-2 border-dashed"])},[e("input",{type:"file",onChange:t[8]||(t[8]=l=>$(l,"pharmacy_logo")),accept:"image/*",class:"hidden",id:"pharmacy_logo"},null,32),s.value.pharmacy_logo_preview?(u(),m("div",ut,[e("div",mt,[e("img",{src:s.value.pharmacy_logo_preview,alt:"Pharmacy Logo Preview",class:"object-contain w-full h-32 rounded-lg shadow-md group-hover:scale-105 transition-transform duration-300"},null,8,gt),e("div",ft,[e("div",vt,[e("button",{type:"button",onClick:t[9]||(t[9]=V(l=>z("pharmacy_logo"),["stop"])),class:"p-2 bg-red-500 text-white rounded-full hover:bg-red-600 transition"},[...t[24]||(t[24]=[e("i",{class:"text-sm pi pi-trash"},null,-1)])]),e("button",{type:"button",onClick:t[10]||(t[10]=V(l=>A("pharmacy_logo"),["stop"])),class:"p-2 bg-white text-gray-700 rounded-full hover:bg-gray-100 transition"},[...t[25]||(t[25]=[e("i",{class:"text-sm pi pi-pencil"},null,-1)])])])])])])):(u(),m("div",_t,[t[26]||(t[26]=e("div",{class:"p-3 mb-2 bg-green-100 rounded-full"},[e("i",{class:"text-xl text-green-500 pi pi-image"})],-1)),e("p",ht,[e("span",yt,n(o(a)("auth.click_to_upload")),1),C(" "+n(o(a)("auth.or_drag_and_drop")),1)]),t[27]||(t[27]=e("p",{class:"text-xs text-gray-400"},"SVG, PNG, JPG or GIF (max. 1MB)",-1))]))],34)])])]),_:1},8,["visible","header"]),d(o(I),{visible:h.value,"onUpdate:visible":t[17]||(t[17]=l=>h.value=l),modal:"",header:o(a)("profile.confirmLogout"),style:{width:"25rem"},class:"p-dialog-rounded"},{default:w(()=>[e("p",xt,n(o(a)("profile.logoutConfirm")),1),e("div",bt,[d(o(k),{label:o(a)("common.cancel"),severity:"secondary",onClick:t[16]||(t[16]=l=>h.value=!1),class:"p-button-secondary"},null,8,["label"]),d(o(k),{label:o(a)("profile.logout"),severity:"danger",onClick:J},null,8,["label"])])]),_:1},8,["visible","header"]),d(o(re))]))}},Ct=K(wt,[["__scopeId","data-v-e3a8cee4"]]);export{Ct as default};
