import{_ as O,i as N,J as G,j as L,u as M,r as v,d as R,Z as p,$ as z,o as g,c as x,M as S,k as a,t as n,z as i,v as $,C as A,F as J,B as V,q as c,l as d}from"./index-a2c89516.js";const P={class:"max-w-5xl mx-auto p-6 bg-white rounded-xl shadow-lg"},Z={class:"text-3xl font-bold text-center mb-8 text-gray-800"},H={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},K={class:"space-y-2"},Q={for:"product",class:"block text-sm font-medium text-gray-700"},W={class:"space-y-2"},X={for:"min_limit",class:"block text-sm font-medium text-gray-700"},Y={class:"space-y-2"},ee={for:"max_limit",class:"block text-sm font-medium text-gray-700"},te={class:"space-y-2"},le={for:"quantity",class:"block text-sm font-medium text-gray-700"},ae={class:"space-y-2"},oe={for:"quantity_unit",class:"block text-sm font-medium text-gray-700"},se={class:"space-y-2"},re={for:"discount_type",class:"block text-sm font-medium text-gray-700"},ie={class:"space-y-2"},ue={for:"discount_value",class:"block text-sm font-medium text-gray-700"},ne={class:"space-y-2"},de={for:"start_date",class:"block text-sm font-medium text-gray-700"},ce={class:"space-y-2"},fe={for:"end_date",class:"block text-sm font-medium text-gray-700"},pe={class:"space-y-2 md:col-span-2"},me={for:"description",class:"block text-sm font-medium text-gray-700"},_e={class:"pt-4 flex justify-center"},ve={key:0},ye={key:1,class:"pi pi-spinner pi-spin"},be={__name:"update",setup(ge){const q=N(),h=G(),m=L(),{t:u}=M(),k=v(),y=v(!1),w=v([]),_=v(!1),t=v({product_id:null,min_limit:null,max_limit:null,quantity:null,quantity_unit:null,discount_type:null,discount_value:null,start_date:null,end_date:null,description:""}),o=v({product_id:!1,min_limit:!1,max_limit:!1,quantity:!1,quantity_unit:!1,discount_type:!1,discount_value:!1,start_date:!1,end_date:!1,description:!1}),D=async()=>{try{const l=await V.get("/api/product");w.value=l.data.data}catch(l){console.error("Error fetching products:",l),m.add({severity:"error",summary:u("error"),detail:u("error_fetching_data"),life:3e3})}},T=async l=>{try{const s=(await V.get(`/api/offer/${l}`)).data.data;t.value={product_id:s.product_id,min_limit:s.min_limit,max_limit:s.max_limit,quantity:s.quantity,quantity_unit:s.quantity_unit,discount_type:s.discount_type,discount_value:s.discount_value,start_date:s.start_date?s.start_date.split("T")[0]:null,end_date:s.end_date?s.end_date.split("T")[0]:null,description:s.description||""}}catch(e){console.error("Error fetching offer:",e),m.add({severity:"error",summary:u("error"),detail:u("error_fetching_offer"),life:3e3}),q.push({name:"offers"})}},U=()=>(o.value.product_id=!t.value.product_id,o.value.min_limit=t.value.min_limit===null||t.value.min_limit==="",o.value.max_limit=t.value.max_limit===null||t.value.max_limit==="",o.value.quantity=t.value.quantity===null||t.value.quantity==="",o.value.quantity_unit=!t.value.quantity_unit,o.value.discount_type=!t.value.discount_type,o.value.discount_value=t.value.discount_value===null||t.value.discount_value==="",o.value.start_date=!t.value.start_date,o.value.end_date=!t.value.end_date,o.value.description=!1,t.value.start_date&&t.value.end_date&&(o.value.end_date=new Date(t.value.start_date)>new Date(t.value.end_date)),t.value.min_limit&&t.value.max_limit&&(o.value.max_limit=t.value.min_limit>t.value.max_limit),!Object.values(o.value).some(l=>l)),C=async()=>{var l;if(Object.keys(o.value).forEach(e=>o.value[e]=!1),!U()){m.add({severity:"error",summary:u("error"),detail:u("please_fill_required_fields"),life:3e3});return}y.value=!0;try{_.value?(await V.put(`/api/offer/${h.params.id}`,t.value),m.add({severity:"success",summary:u("success"),detail:u("offer_updated"),life:3e3})):(await V.post("/api/offer",t.value),m.add({severity:"success",summary:u("success"),detail:u("offer_created"),life:3e3})),q.push({name:"offers"})}catch(e){console.error("Error:",e);let s=u(_.value?"error_updating_offer":"error_creating_offer");if(((l=e.response)==null?void 0:l.status)===422){const f=e.response.data.errors;s=Object.values(f).flat().join(", "),Object.keys(f).forEach(b=>{b in o.value&&(o.value[b]=!0)})}m.add({severity:"error",summary:u("error"),detail:s,life:3e3})}finally{y.value=!1}};return R(()=>{D(),h.params.id&&(_.value=!0,T(h.params.id))}),(l,e)=>{const s=p("Dropdown"),f=p("InputNumber"),b=p("InputText"),F=p("Textarea"),j=p("Button"),E=p("Form"),B=p("Toast"),I=z("can");return g(),x(J,null,[S((g(),x("div",P,[a("h1",Z,n(l.$t(_.value?"offer.edit_offer":"offer.create_new_offer")),1),i(E,{ref_key:"form",ref:k,model:t.value,onSubmit:A(C,["prevent"]),class:"space-y-6"},{default:$(()=>[a("div",H,[a("div",K,[a("label",Q,[c(n(l.$t("offer.product"))+" ",1),e[10]||(e[10]=a("span",{class:"text-red-500"},"*",-1))]),i(s,{id:"product",modelValue:t.value.product_id,"onUpdate:modelValue":e[0]||(e[0]=r=>t.value.product_id=r),options:w.value,optionLabel:"commercial_name",optionValue:"id",placeholder:l.$t("offer.select_product"),class:d(["w-full border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",{"p-invalid":o.value.product_id}])},null,8,["modelValue","options","placeholder","class"])]),a("div",W,[a("label",X,[c(n(l.$t("offer.min_limit"))+" ",1),e[11]||(e[11]=a("span",{class:"text-red-500"},"*",-1))]),i(f,{id:"min_limit",modelValue:t.value.min_limit,"onUpdate:modelValue":e[1]||(e[1]=r=>t.value.min_limit=r),useGrouping:!1,placeholder:l.$t("offer.enter_min_limit"),class:d(["w-full",{"p-invalid":o.value.min_limit}]),inputClass:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,8,["modelValue","placeholder","class"])]),a("div",Y,[a("label",ee,[c(n(l.$t("offer.max_limit"))+" ",1),e[12]||(e[12]=a("span",{class:"text-red-500"},"*",-1))]),i(f,{id:"max_limit",modelValue:t.value.max_limit,"onUpdate:modelValue":e[2]||(e[2]=r=>t.value.max_limit=r),useGrouping:!1,placeholder:l.$t("offer.enter_max_limit"),class:d(["w-full",{"p-invalid":o.value.max_limit}]),inputClass:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,8,["modelValue","placeholder","class"])]),a("div",te,[a("label",le,[c(n(l.$t("offer.quantity"))+" ",1),e[13]||(e[13]=a("span",{class:"text-red-500"},"*",-1))]),i(f,{id:"quantity",modelValue:t.value.quantity,"onUpdate:modelValue":e[3]||(e[3]=r=>t.value.quantity=r),useGrouping:!1,placeholder:l.$t("offer.enter_quantity"),class:d(["w-full",{"p-invalid":o.value.quantity}]),inputClass:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,8,["modelValue","placeholder","class"])]),a("div",ae,[a("label",oe,[c(n(l.$t("offer.quantity_unit"))+" ",1),e[14]||(e[14]=a("span",{class:"text-red-500"},"*",-1))]),i(s,{id:"quantity_unit",modelValue:t.value.quantity_unit,"onUpdate:modelValue":e[4]||(e[4]=r=>t.value.quantity_unit=r),options:[{label:"Tablets",value:1},{label:"Capsules",value:2},{label:"Units",value:3},{label:"bottle",value:4},{label:"can",value:5}],optionLabel:"label",optionValue:"value",placeholder:l.$t("offer.select_quantity_unit"),class:d(["w-full border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",{"p-invalid":o.value.quantity_unit}])},null,8,["modelValue","placeholder","class"])]),a("div",se,[a("label",re,[c(n(l.$t("offer.discount_type"))+" ",1),e[15]||(e[15]=a("span",{class:"text-red-500"},"*",-1))]),i(s,{id:"discount_type",modelValue:t.value.discount_type,"onUpdate:modelValue":e[5]||(e[5]=r=>t.value.discount_type=r),options:[{label:"Percentage",value:1},{label:"Fixed Amount",value:2}],optionLabel:"label",optionValue:"value",placeholder:l.$t("offer.select_discount_type"),class:d(["w-full border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",{"p-invalid":o.value.discount_type}])},null,8,["modelValue","placeholder","class"])]),a("div",ie,[a("label",ue,[c(n(l.$t("offer.discount_value"))+" ",1),e[16]||(e[16]=a("span",{class:"text-red-500"},"*",-1))]),i(f,{id:"discount_value",modelValue:t.value.discount_value,"onUpdate:modelValue":e[6]||(e[6]=r=>t.value.discount_value=r),mode:"decimal",minFractionDigits:2,maxFractionDigits:2,placeholder:l.$t("offer.enter_discount_value"),class:d(["w-full",{"p-invalid":o.value.discount_value}]),inputClass:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,8,["modelValue","placeholder","class"])]),a("div",ne,[a("label",de,[c(n(l.$t("offer.start_date"))+" ",1),e[17]||(e[17]=a("span",{class:"text-red-500"},"*",-1))]),i(b,{id:"start_date",modelValue:t.value.start_date,"onUpdate:modelValue":e[7]||(e[7]=r=>t.value.start_date=r),type:"date",placeholder:l.$t("offer.enter_start_date"),class:d(["w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",{"p-invalid":o.value.start_date}])},null,8,["modelValue","placeholder","class"])]),a("div",ce,[a("label",fe,[c(n(l.$t("offer.end_date"))+" ",1),e[18]||(e[18]=a("span",{class:"text-red-500"},"*",-1))]),i(b,{id:"end_date",modelValue:t.value.end_date,"onUpdate:modelValue":e[8]||(e[8]=r=>t.value.end_date=r),type:"date",placeholder:l.$t("offer.enter_end_date"),class:d(["w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",{"p-invalid":o.value.end_date}])},null,8,["modelValue","placeholder","class"])]),a("div",pe,[a("label",me,n(l.$t("offer.description")),1),i(F,{id:"description",modelValue:t.value.description,"onUpdate:modelValue":e[9]||(e[9]=r=>t.value.description=r),placeholder:l.$t("offer.enter_description"),class:d(["w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",{"p-invalid":o.value.description}])},null,8,["modelValue","placeholder","class"])])]),a("div",_e,[i(j,{type:"submit",label:_.value?l.$t("offer.update_offer"):l.$t("offer.create_offer"),icon:"pi pi-plus",loading:y.value,class:"px-8 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center space-x-2",disabled:y.value},{default:$(()=>[y.value?(g(),x("i",ye)):(g(),x("span",ve,n(l.$t(_.value?"offer.update_offer":"offer.create_offer")),1))]),_:1},8,["label","loading","disabled"])])]),_:1},8,["model"])])),[[I,"create offers"]]),i(B)],64)}}},Ve=O(be,[["__scopeId","data-v-c565be18"]]);export{Ve as default};
