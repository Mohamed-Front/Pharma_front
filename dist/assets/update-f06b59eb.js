import{_ as Z,j as H,i as K,P as Q,u as W,r as v,d as X,Z as g,o as i,c as u,k as a,t as r,z as n,v as j,C as k,F as Y,B as $,q as d,l as m,y as _}from"./index-d45c326e.js";const ee={class:"max-w-5xl mx-auto p-6 bg-white rounded-xl shadow-lg"},te={class:"text-3xl font-bold text-center mb-8 text-gray-800"},ae={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},oe={class:"space-y-2"},le={for:"category",class:"block text-sm font-medium text-gray-700"},re={key:0,class:"text-red-500 text-xs"},se={class:"space-y-2"},ie={for:"company",class:"block text-sm font-medium text-gray-700"},ue={key:0,class:"text-red-500 text-xs"},ne={class:"space-y-2"},de={for:"commercial_name",class:"block text-sm font-medium text-gray-700"},ce={key:0,class:"text-red-500 text-xs"},pe={class:"space-y-2 md:col-span-2"},me={for:"scientific_structure",class:"block text-sm font-medium text-gray-700"},_e={key:0,class:"text-red-500 text-xs"},fe={class:"space-y-2 md:col-span-2"},ve={for:"usage",class:"block text-sm font-medium text-gray-700"},ge={key:0,class:"text-red-500 text-xs"},ye={class:"space-y-2"},be={for:"calibres",class:"block text-sm font-medium text-gray-700"},xe={key:0,class:"text-red-500 text-xs"},he={class:"space-y-2"},Ve={for:"quantity",class:"block text-sm font-medium text-gray-700"},qe={key:0,class:"text-red-500 text-xs"},$e={class:"space-y-2"},ke={for:"quantity_unit",class:"block text-sm font-medium text-gray-700"},we={key:0,class:"text-red-500 text-xs"},Ue={class:"space-y-2"},De={for:"price",class:"block text-sm font-medium text-gray-700"},Fe={key:0,class:"text-red-500 text-xs"},Ce={class:"space-y-2"},Ie={for:"price_unit",class:"block text-sm font-medium text-gray-700"},Te={key:0,class:"text-red-500 text-xs"},Pe={class:"space-y-2"},je={for:"expiration_from",class:"block text-sm font-medium text-gray-700"},Be={key:0,class:"text-red-500 text-xs"},Ne={class:"space-y-2"},Re={for:"expiration_to",class:"block text-sm font-medium text-gray-700"},Se={key:0,class:"text-red-500 text-xs"},Le={class:"space-y-2 md:col-span-2"},Ee={for:"storage_notes",class:"block text-sm font-medium text-gray-700"},Ge={class:"space-y-2"},Me={for:"pharmaceutical_form",class:"block text-sm font-medium text-gray-700"},ze={key:0,class:"text-red-500 text-xs"},Oe={class:"md:col-span-2 space-y-2"},Ae={for:"product_image",class:"block text-sm font-medium text-gray-700"},Je={class:"flex justify-center"},Ze={key:0,class:"p-4"},He={class:"relative group"},Ke=["src"],Qe={class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 flex items-center justify-center transition-all duration-300 rounded-lg"},We={class:"opacity-0 group-hover:opacity-100 space-x-3 transition-all duration-300 transform translate-y-4 group-hover:translate-y-0"},Xe={id:"image-upload-instructions",class:"mt-2 text-center text-sm text-gray-500"},Ye={key:1,class:"p-8 flex flex-col items-center justify-center"},et={class:"text-sm text-center text-gray-600 mb-1"},tt={class:"text-blue-500 font-medium"},at={key:0,class:"text-red-500 text-xs"},ot={class:"pt-4 flex justify-center"},lt={key:0},rt={key:1,class:"pi pi-spinner pi-spin"},st={__name:"update",setup(it){const y=H(),B=K(),w=Q(),{t:c}=W(),N=v(),h=v(!1);v([]);const U=v([]),D=v([]),F=v([]),V=v(null),b=v(null),q=v(!1),l=v({category_id:!1,company_id:!1,commercial_name:!1,scientific_structure:!1,usage:!1,calibres:!1,quantity:!1,quantity_unit:!1,price:!1,price_unit:!1,expiration_from:!1,expiration_to:!1,pharmaceutical_form:!1,product_image:!1}),o=v({category_id:null,company_id:null,commercial_name:"",scientific_structure:[],product_image:null,usage:"",calibres:"",quantity:null,quantity_unit:null,price:null,price_unit:null,expiration_from:null,expiration_to:null,storage_notes:"",pharmaceutical_form:""}),R=async()=>{try{const[t,e,p]=await Promise.all([$.get("/api/category"),$.get("/api/company"),$.get("/api/scientific-structure")]);U.value=t.data.data,D.value=e.data.data,F.value=p.data.data}catch(t){console.error("Error fetching dropdown options:",t),y.add({severity:"error",summary:c("error"),detail:c("error_fetching_data"),life:3e3})}},S=async()=>{try{const e=(await $.get(`/api/product/${w.params.id}`)).data.data;o.value={...o.value,category_id:e.category_id,company_id:e.company_id,commercial_name:e.commercial_name,scientific_structure:e.scientific_structure&&e.scientific_structure.length>0?e.scientific_structure:[],usage:e.usage,calibres:e.calibres,quantity:e.quantity,quantity_unit:e.quantity_unit,price:parseFloat(e.price),price_unit:e.price_unit,expiration_from:e.expiration_from,expiration_to:e.expiration_to,storage_notes:e.storage_notes,pharmaceutical_form:e.pharmaceutical_form},e.media&&e.media.length>0&&e.media[0].url&&(b.value=e.media[0].url)}catch(t){console.error("Error fetching product data:",t),y.add({severity:"error",summary:c("error"),detail:c("error_fetching_product"),life:3e3})}},L=t=>{t.preventDefault(),q.value=!0},E=()=>{q.value=!1},G=t=>{V.value=t;const e=new FileReader;e.onload=p=>{b.value=p.target.result},e.readAsDataURL(t),q.value=!1},C=t=>{var p,f,x;const e=((p=t.target.files)==null?void 0:p[0])||((x=(f=t.dataTransfer)==null?void 0:f.files)==null?void 0:x[0]);if(e&&e.type.match("image.*")){if(e.size>1024*1024){y.add({severity:"error",summary:c("error"),detail:c("image_too_large"),life:3e3});return}G(e)}else y.add({severity:"error",summary:c("error"),detail:c("invalid_image_type"),life:3e3})},M=()=>{V.value=null,b.value=null},z=()=>(l.value.category_id=!o.value.category_id,l.value.company_id=!o.value.company_id,l.value.commercial_name=!o.value.commercial_name,l.value.scientific_structure=!o.value.scientific_structure||o.value.scientific_structure.length===0,l.value.usage=!o.value.usage,l.value.calibres=!o.value.calibres,l.value.quantity=o.value.quantity===null||o.value.quantity==="",l.value.quantity_unit=!o.value.quantity_unit,l.value.price=o.value.price===null||o.value.price==="",l.value.price_unit=!o.value.price_unit,l.value.expiration_from=!o.value.expiration_from,l.value.expiration_to=!o.value.expiration_to,l.value.pharmaceutical_form=!o.value.pharmaceutical_form,l.value.product_image=!V.value&&!b.value,!Object.values(l.value).some(t=>t)),I=async()=>{var e,p;if(!z()){y.add({severity:"error",summary:c("error"),detail:c("validation_failed"),life:3e3});return}h.value=!0;const t=new FormData;t.append("category_id",o.value.category_id||""),t.append("company_id",o.value.company_id||""),t.append("commercial_name",o.value.commercial_name||""),o.value.scientific_structure.forEach((f,x)=>{t.append(`scientific_structure[${x}]`,f||"")}),t.append("usage",o.value.usage||""),t.append("calibres",o.value.calibres||""),t.append("quantity",o.value.quantity?Math.floor(o.value.quantity):""),t.append("quantity_unit",o.value.quantity_unit||""),t.append("price",o.value.price?Number(o.value.price).toFixed(2):""),t.append("price_unit",o.value.price_unit||""),t.append("expiration_from",o.value.expiration_from),t.append("expiration_to",o.value.expiration_to),t.append("storage_notes",o.value.storage_notes||""),t.append("pharmaceutical_form",o.value.pharmaceutical_form||""),V.value&&t.append("product_image",V.value);try{await $.post(`/api/product/${w.params.id}`,t,{}),B.push({name:"products"}),y.add({severity:"success",summary:c("success"),detail:c("product_updated"),life:3e3})}catch(f){console.error("Error:",f),y.add({severity:"error",summary:c("error"),detail:((p=(e=f.response)==null?void 0:e.data)==null?void 0:p.message)||c("error_updating_product"),life:3e3})}finally{h.value=!1}};return X(()=>{R(),S()}),(t,e)=>{const p=g("Dropdown"),f=g("InputText"),x=g("MultiSelect"),T=g("Textarea"),P=g("InputNumber"),O=g("Button"),A=g("Form"),J=g("Toast");return i(),u(Y,null,[a("div",ee,[a("h1",te,r(t.$t("product.update_product")),1),n(A,{ref_key:"form",ref:N,model:o.value,onSubmit:k(I,["prevent"]),class:"space-y-6"},{default:j(()=>[a("div",ae,[a("div",oe,[a("label",le,[d(r(t.$t("product.category"))+" ",1),e[14]||(e[14]=a("span",{class:"text-red-500"},"*",-1))]),n(p,{filter:"",id:"category",modelValue:o.value.category_id,"onUpdate:modelValue":e[0]||(e[0]=s=>o.value.category_id=s),options:U.value,optionLabel:"name_ar",optionValue:"id",placeholder:t.$t("product.select_category"),class:m(["w-full border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",{"p-invalid":l.value.category_id}])},null,8,["modelValue","options","placeholder","class"]),l.value.category_id?(i(),u("small",re,r(t.$t("product.validation.category_required")),1)):_("",!0)]),a("div",se,[a("label",ie,[d(r(t.$t("product.company"))+" ",1),e[15]||(e[15]=a("span",{class:"text-red-500"},"*",-1))]),n(p,{filter:"",id:"company",modelValue:o.value.company_id,"onUpdate:modelValue":e[1]||(e[1]=s=>o.value.company_id=s),options:D.value,optionLabel:"name",optionValue:"id",placeholder:t.$t("product.select_company"),class:m(["w-full border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",{"p-invalid":l.value.company_id}])},null,8,["modelValue","options","placeholder","class"]),l.value.company_id?(i(),u("small",ue,r(t.$t("product.validation.company_required")),1)):_("",!0)]),a("div",ne,[a("label",de,[d(r(t.$t("product.commercial_name"))+" ",1),e[16]||(e[16]=a("span",{class:"text-red-500"},"*",-1))]),n(f,{id:"commercial_name",modelValue:o.value.commercial_name,"onUpdate:modelValue":e[2]||(e[2]=s=>o.value.commercial_name=s),placeholder:t.$t("product.enter_commercial_name"),class:m(["w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",{"p-invalid":l.value.commercial_name}])},null,8,["modelValue","placeholder","class"]),l.value.commercial_name?(i(),u("small",ce,r(t.$t("product.validation.commercial_name_required")),1)):_("",!0)]),a("div",pe,[a("label",me,[d(r(t.$t("product.scientific_structure"))+" ",1),e[17]||(e[17]=a("span",{class:"text-red-500"},"*",-1))]),n(x,{id:"scientific_structure",modelValue:o.value.scientific_structure,"onUpdate:modelValue":e[3]||(e[3]=s=>o.value.scientific_structure=s),options:F.value,optionLabel:"name",optionValue:"name",placeholder:t.$t("product.select_scientific_structure"),class:m(["w-full border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",{"p-invalid":l.value.scientific_structure}]),display:"chip"},null,8,["modelValue","options","placeholder","class"]),l.value.scientific_structure?(i(),u("small",_e,r(t.$t("product.validation.scientific_structure_required")),1)):_("",!0)]),a("div",fe,[a("label",ve,[d(r(t.$t("product.usage"))+" ",1),e[18]||(e[18]=a("span",{class:"text-red-500"},"*",-1))]),n(T,{id:"usage",modelValue:o.value.usage,"onUpdate:modelValue":e[4]||(e[4]=s=>o.value.usage=s),placeholder:t.$t("product.enter_usage"),class:m(["w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",{"p-invalid":l.value.usage}])},null,8,["modelValue","placeholder","class"]),l.value.usage?(i(),u("small",ge,r(t.$t("product.validation.usage_required")),1)):_("",!0)]),a("div",ye,[a("label",be,[d(r(t.$t("product.calibres"))+" ",1),e[19]||(e[19]=a("span",{class:"text-red-500"},"*",-1))]),n(f,{id:"calibres",modelValue:o.value.calibres,"onUpdate:modelValue":e[5]||(e[5]=s=>o.value.calibres=s),placeholder:t.$t("product.enter_calibres"),class:m(["w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",{"p-invalid":l.value.calibres}])},null,8,["modelValue","placeholder","class"]),l.value.calibres?(i(),u("small",xe,r(t.$t("product.validation.calibres_required")),1)):_("",!0)]),a("div",he,[a("label",Ve,[d(r(t.$t("product.quantity"))+" ",1),e[20]||(e[20]=a("span",{class:"text-red-500"},"*",-1))]),n(P,{id:"quantity",modelValue:o.value.quantity,"onUpdate:modelValue":e[6]||(e[6]=s=>o.value.quantity=s),useGrouping:!1,placeholder:t.$t("product.enter_quantity"),class:m(["w-full",{"p-invalid":l.value.quantity}]),inputClass:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,8,["modelValue","placeholder","class"]),l.value.quantity?(i(),u("small",qe,r(t.$t("product.validation.quantity_required")),1)):_("",!0)]),a("div",$e,[a("label",ke,[d(r(t.$t("product.quantity_unit"))+" ",1),e[21]||(e[21]=a("span",{class:"text-red-500"},"*",-1))]),n(p,{filter:"",id:"quantity_unit",modelValue:o.value.quantity_unit,"onUpdate:modelValue":e[7]||(e[7]=s=>o.value.quantity_unit=s),options:[{label:"Tablets",value:1},{label:"Capsules",value:2},{label:"Units",value:3}],optionLabel:"label",optionValue:"value",placeholder:t.$t("product.select_quantity_unit"),class:m(["w-full border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",{"p-invalid":l.value.quantity_unit}])},null,8,["modelValue","placeholder","class"]),l.value.quantity_unit?(i(),u("small",we,r(t.$t("product.validation.quantity_unit_required")),1)):_("",!0)]),a("div",Ue,[a("label",De,[d(r(t.$t("product.price"))+" ",1),e[22]||(e[22]=a("span",{class:"text-red-500"},"*",-1))]),n(P,{id:"price",modelValue:o.value.price,"onUpdate:modelValue":e[8]||(e[8]=s=>o.value.price=s),mode:"decimal",minFractionDigits:2,maxFractionDigits:2,placeholder:t.$t("product.enter_price"),class:m(["w-full",{"p-invalid":l.value.price}]),inputClass:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,8,["modelValue","placeholder","class"]),l.value.price?(i(),u("small",Fe,r(t.$t("product.validation.price_required")),1)):_("",!0)]),a("div",Ce,[a("label",Ie,[d(r(t.$t("product.price_unit"))+" ",1),e[23]||(e[23]=a("span",{class:"text-red-500"},"*",-1))]),n(p,{filter:"",id:"price_unit",modelValue:o.value.price_unit,"onUpdate:modelValue":e[9]||(e[9]=s=>o.value.price_unit=s),options:[{label:"USD",value:1},{label:"EUR",value:2},{label:"GBP",value:3}],optionLabel:"label",optionValue:"value",placeholder:t.$t("product.select_price_unit"),class:m(["w-full border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",{"p-invalid":l.value.price_unit}])},null,8,["modelValue","placeholder","class"]),l.value.price_unit?(i(),u("small",Te,r(t.$t("product.validation.price_unit_required")),1)):_("",!0)]),a("div",Pe,[a("label",je,[d(r(t.$t("product.expiration_from"))+" ",1),e[24]||(e[24]=a("span",{class:"text-red-500"},"*",-1))]),n(f,{type:"date",id:"expiration_from",modelValue:o.value.expiration_from,"onUpdate:modelValue":e[10]||(e[10]=s=>o.value.expiration_from=s),placeholder:t.$t("product.enter_expiration_from"),class:m(["w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",{"p-invalid":l.value.expiration_from}])},null,8,["modelValue","placeholder","class"]),l.value.expiration_from?(i(),u("small",Be,r(t.$t("product.validation.expiration_from_required")),1)):_("",!0)]),a("div",Ne,[a("label",Re,[d(r(t.$t("product.expiration_to"))+" ",1),e[25]||(e[25]=a("span",{class:"text-red-500"},"*",-1))]),n(f,{type:"date",id:"expiration_to",modelValue:o.value.expiration_to,"onUpdate:modelValue":e[11]||(e[11]=s=>o.value.expiration_to=s),placeholder:t.$t("product.enter_expiration_to"),class:m(["w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",{"p-invalid":l.value.expiration_to}])},null,8,["modelValue","placeholder","class"]),l.value.expiration_to?(i(),u("small",Se,r(t.$t("product.validation.expiration_to_required")),1)):_("",!0)]),a("div",Le,[a("label",Ee,r(t.$t("product.storage_notes")),1),n(T,{id:"storage_notes",modelValue:o.value.storage_notes,"onUpdate:modelValue":e[12]||(e[12]=s=>o.value.storage_notes=s),placeholder:t.$t("product.enter_storage_notes"),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"},null,8,["modelValue","placeholder"])]),a("div",Ge,[a("label",Me,[d(r(t.$t("product.pharmaceutical_form"))+" ",1),e[26]||(e[26]=a("span",{class:"text-red-500"},"*",-1))]),n(f,{id:"pharmaceutical_form",modelValue:o.value.pharmaceutical_form,"onUpdate:modelValue":e[13]||(e[13]=s=>o.value.pharmaceutical_form=s),placeholder:t.$t("product.enter_pharmaceutical_form"),class:m(["w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",{"p-invalid":l.value.pharmaceutical_form}])},null,8,["modelValue","placeholder","class"]),l.value.pharmaceutical_form?(i(),u("small",ze,r(t.$t("product.validation.pharmaceutical_form_required")),1)):_("",!0)]),a("div",Oe,[a("label",Ae,[d(r(t.$t("product.product_image"))+" ",1),e[27]||(e[27]=a("span",{class:"text-red-500"},"*",-1))]),a("div",Je,[a("label",{onDragover:k(L,["prevent"]),onDragleave:E,onDrop:k(C,["prevent"]),class:m([{"border-blue-500 bg-blue-50":q.value,"border-gray-300":!q.value},"cursor-pointer w-full max-w-md rounded-xl border-2 border-dashed transition-colors duration-300"]),"aria-label":"Upload product image","aria-describedby":"image-upload-instructions"},[a("input",{type:"file",id:"product_image",onChange:C,accept:"image/*",class:"hidden","aria-hidden":"true"},null,32),b.value?(i(),u("div",Ze,[a("div",He,[a("img",{src:b.value,alt:"Preview",class:"w-full h-64 object-cover rounded-lg shadow-md transition-transform duration-300 group-hover:scale-105"},null,8,Ke),a("div",Qe,[a("div",We,[a("button",{type:"button",onClick:k(M,["stop"]),class:"bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition"},[...e[28]||(e[28]=[a("i",{class:"pi pi-trash text-sm"},null,-1)])]),e[29]||(e[29]=a("button",{type:"button",class:"bg-white text-gray-700 p-2 rounded-full hover:bg-gray-100 transition"},[a("i",{class:"pi pi-pencil text-sm"})],-1))])])]),a("p",Xe,r(t.$t("product.click_or_drag_to_change_photo")),1)])):(i(),u("div",Ye,[e[30]||(e[30]=a("div",{class:"bg-blue-100 p-4 rounded-full mb-4"},[a("i",{class:"pi pi-image text-blue-500 text-2xl"})],-1)),a("p",et,[a("span",tt,r(t.$t("product.click_to_upload")),1),d(" "+r(t.$t("product.or_drag_and_drop")),1)]),e[31]||(e[31]=a("p",{class:"text-xs text-gray-400"},"SVG, PNG, JPG or GIF (max. 1MB)",-1))]))],34)]),l.value.product_image?(i(),u("small",at,r(t.$t("product.validation.product_image_required")),1)):_("",!0)])]),a("div",ot,[n(O,{type:"submit",label:"Update Product",icon:"pi pi-check",loading:h.value,class:"px-8 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center space-x-2",disabled:h.value,onClick:I},{default:j(()=>[h.value?(i(),u("i",rt)):(i(),u("span",lt,r(t.$t("product.update_product")),1))]),_:1},8,["loading","disabled"])])]),_:1},8,["model"])]),n(J)],64)}}},nt=Z(st,[["__scopeId","data-v-3aa4b302"]]);export{nt as default};
