import{_ as W,i as X,j as Y,u as ee,r as c,d as ae,Z as f,$ as te,o as p,c as m,M as oe,k as o,t as s,z as i,v as B,C as q,F as j,B as V,q as v,l as u,x as le,y as re}from"./index-a2c89516.js";const se={class:"max-w-5xl mx-auto p-6 bg-white rounded-xl shadow-lg"},ie={class:"text-3xl font-bold text-center mb-8 text-gray-800"},ne={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ue={class:"space-y-2"},de={for:"category",class:"block text-sm font-medium text-gray-700"},ce={class:"space-y-2"},pe={for:"company",class:"block text-sm font-medium text-gray-700"},me={class:"space-y-2 relative"},ve={for:"commercial_name",class:"block text-sm font-medium text-gray-700"},ge={key:0,class:"absolute z-10 w-full bg-white border border-gray-200 rounded-lg shadow-lg mt-1 max-h-60 overflow-y-auto"},_e={class:"py-1"},fe=["onClick"],be={class:"space-y-2 md:col-span-2"},ye={for:"active_ingredient",class:"block text-sm font-medium text-gray-700"},xe={class:"space-y-2 md:col-span-2"},he={for:"usage",class:"block text-sm font-medium text-gray-700"},Ve={class:"space-y-2"},we={for:"calibres",class:"block text-sm font-medium text-gray-700"},$e={class:"space-y-2"},ke={for:"quantity",class:"block text-sm font-medium text-gray-700"},qe={class:"space-y-2"},Ue={for:"quantity_unit",class:"block text-sm font-medium text-gray-700"},De={class:"space-y-2"},Ce={for:"price",class:"block text-sm font-medium text-gray-700"},Ie={class:"space-y-2"},Fe={for:"price_unit",class:"block text-sm font-medium text-gray-700"},Ne={class:"space-y-2"},Te={for:"expiration_from",class:"block text-sm font-medium text-gray-700"},Be={class:"space-y-2"},je={for:"expiration_to",class:"block text-sm font-medium text-gray-700"},Le={class:"space-y-2 md:col-span-2"},Re={for:"storage_notes",class:"block text-sm font-medium text-gray-700"},Se={class:"space-y-2"},Me={for:"pharmaceutical_form",class:"block text-sm font-medium text-gray-700"},Pe={class:"md:col-span-2 space-y-2"},Ee={class:"block text-sm font-medium text-gray-700"},Ge={class:"flex justify-center"},ze={key:0,class:"p-4"},Oe={class:"relative group"},Ae=["src"],Je={class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 flex items-center justify-center transition-all duration-300 rounded-lg"},Ze={class:"opacity-0 group-hover:opacity-100 space-x-3 transition-all duration-300 transform translate-y-4 group-hover:translate-y-0"},He={class:"mt-2 text-center text-sm text-gray-500"},Ke={key:1,class:"p-8 flex flex-col items-center justify-center"},Qe={class:"text-sm text-center text-gray-600 mb-1"},We={class:"text-blue-500 font-medium"},Xe={class:"pt-4 flex justify-center"},Ye={key:0},ea={key:1,class:"pi pi-spinner pi-spin"},aa={__name:"create",setup(ta){const L=X(),w=Y(),{t:g}=ee(),R=c(),x=c(!1);c([]);const U=c([]),D=c([]),C=c([]),$=c(null),k=c(null),h=c(!1),_=c([]),b=c(!1),r=c({category_id:!1,company_id:!1,commercial_name:!1,active_ingredient:!1,usage:!1,calibres:!1,quantity:!1,quantity_unit:!1,price:!1,price_unit:!1,expiration_from:!1,expiration_to:!1,pharmaceutical_form:!1}),t=c({category_id:null,company_id:null,commercial_name:"",active_ingredient:[],product_image:null,usage:"",calibres:"",quantity:null,quantity_unit:null,price:null,price_unit:null,expiration_from:null,expiration_to:null,storage_notes:"",pharmaceutical_form:""}),S=async()=>{try{const[a,e,n]=await Promise.all([V.get("/api/category"),V.get("/api/company"),V.get("/api/scientific-structure")]);U.value=a.data.data,D.value=e.data.data,C.value=n.data.data}catch(a){console.error("Error fetching dropdown options:",a),w.add({severity:"error",summary:g("error"),detail:g("error_fetching_data"),life:3e3})}},M=async a=>{if(!a||a.length<2){_.value=[],b.value=!1;return}try{const e=await V.get(`/api/product/by/name?name=${encodeURIComponent(a)}`);_.value=e.data.data||[],b.value=_.value.length>0}catch(e){console.error("Error fetching commercial names:",e),w.add({severity:"error",summary:g("error"),detail:g("error_fetching_names"),life:3e3}),_.value=[],b.value=!1}},P=a=>{t.value.commercial_name=a,_.value=[],b.value=!1},E=a=>{const e=a.target.value;t.value.commercial_name=e,M(e)},G=a=>{a.preventDefault(),h.value=!0},z=()=>{h.value=!1},O=a=>{$.value=a;const e=new FileReader;e.onload=n=>{k.value=n.target.result},e.readAsDataURL(a),h.value=!1},I=a=>{var n,d,y;const e=((n=a.target.files)==null?void 0:n[0])||((y=(d=a.dataTransfer)==null?void 0:d.files)==null?void 0:y[0]);e&&e.type.match("image.*")&&O(e)},A=()=>{$.value=null,k.value=null},J=()=>(r.value.category_id=!t.value.category_id,r.value.company_id=!t.value.company_id,r.value.commercial_name=!t.value.commercial_name,r.value.active_ingredient=!t.value.active_ingredient||t.value.active_ingredient.length===0,r.value.price=t.value.price===null||t.value.price==="",r.value.price_unit=!t.value.price_unit,r.value.expiration_from=!t.value.expiration_from||t.value.expiration_from==="",r.value.expiration_to=!t.value.expiration_to||t.value.expiration_to==="",!Object.values(r.value).some(a=>a)),F=async()=>{var e,n;if(!J())return;x.value=!0;const a=new FormData;a.append("category_id",t.value.category_id||""),a.append("company_id",t.value.company_id||""),a.append("commercial_name",t.value.commercial_name||""),t.value.active_ingredient.forEach((d,y)=>{a.append(`scientific_structure[${y}]`,d||"")}),a.append("usage",t.value.usage||""),a.append("calibres",t.value.calibres||""),a.append("quantity",t.value.quantity?Math.floor(t.value.quantity):""),a.append("quantity_unit",t.value.quantity_unit||""),a.append("price",t.value.price?Number(t.value.price).toFixed(2):""),a.append("price_unit",t.value.price_unit||""),a.append("expiration_from",t.value.expiration_from||""),a.append("expiration_to",t.value.expiration_to||""),a.append("storage_notes",t.value.storage_notes||""),a.append("pharmaceutical_form",t.value.pharmaceutical_form||""),$.value&&a.append("product_image",$.value);try{await V.post("/api/product",a),L.push({name:"products"}),w.add({severity:"success",summary:g("success"),detail:g("product_created"),life:3e3})}catch(d){console.error("Error:",d),w.add({severity:"error",summary:g("error"),detail:((n=(e=d.response)==null?void 0:e.data)==null?void 0:n.message)||g("error_creating_product"),life:3e3})}finally{x.value=!1}};return ae(()=>{S()}),(a,e)=>{const n=f("Dropdown"),d=f("InputText"),y=f("MultiSelect"),N=f("Textarea"),T=f("InputNumber"),Z=f("Button"),H=f("Form"),K=f("Toast"),Q=te("can");return p(),m(j,null,[oe((p(),m("div",se,[o("h1",ie,s(a.$t("product.create_new_product")),1),i(H,{ref_key:"form",ref:R,model:t.value,onSubmit:q(F,["prevent"]),class:"space-y-6"},{default:B(()=>[o("div",ne,[o("div",ue,[o("label",de,[v(s(a.$t("product.category"))+" ",1),e[16]||(e[16]=o("span",{class:"text-red-500"},"*",-1))]),i(n,{filter:"",id:"category",modelValue:t.value.category_id,"onUpdate:modelValue":e[0]||(e[0]=l=>t.value.category_id=l),options:U.value,optionLabel:"name_ar",optionValue:"id",placeholder:a.$t("product.select_category"),class:u(["w-full border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",{"p-invalid":r.value.category_id}])},null,8,["modelValue","options","placeholder","class"])]),o("div",ce,[o("label",pe,[v(s(a.$t("product.company"))+" ",1),e[17]||(e[17]=o("span",{class:"text-red-500"},"*",-1))]),i(n,{filter:"",id:"company",modelValue:t.value.company_id,"onUpdate:modelValue":e[1]||(e[1]=l=>t.value.company_id=l),options:D.value,optionLabel:"name",optionValue:"id",placeholder:a.$t("product.select_company"),class:u(["w-full border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",{"p-invalid":r.value.company_id}])},null,8,["modelValue","options","placeholder","class"])]),o("div",me,[o("label",ve,[v(s(a.$t("product.commercial_name"))+" ",1),e[18]||(e[18]=o("span",{class:"text-red-500"},"*",-1))]),i(d,{id:"commercial_name",modelValue:t.value.commercial_name,"onUpdate:modelValue":e[2]||(e[2]=l=>t.value.commercial_name=l),placeholder:a.$t("product.enter_commercial_name"),class:u(["w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",{"p-invalid":r.value.commercial_name}]),onInput:E,onFocus:e[3]||(e[3]=l=>b.value=_.value.length>0),onBlur:e[4]||(e[4]=l=>a.setTimeout(()=>b.value=!1,200))},null,8,["modelValue","placeholder","class"]),b.value&&_.value.length>0?(p(),m("div",ge,[o("ul",_e,[(p(!0),m(j,null,le(_.value,l=>(p(),m("li",{key:l.id,onClick:oa=>P(l.commercial_name),class:"px-4 py-2 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-600 cursor-pointer transition-colors duration-200"},s(l.commercial_name),9,fe))),128))])])):re("",!0)]),o("div",be,[o("label",ye,[v(s(a.$t("product.active_ingredient"))+" ",1),e[19]||(e[19]=o("span",{class:"text-red-500"},"*",-1))]),i(y,{filter:"",id:"active_ingredient",modelValue:t.value.active_ingredient,"onUpdate:modelValue":e[5]||(e[5]=l=>t.value.active_ingredient=l),options:C.value,optionLabel:"name",optionValue:"name",placeholder:a.$t("product.select_active_ingredient"),class:u(["w-full border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",{"p-invalid":r.value.active_ingredient}]),display:"chip"},null,8,["modelValue","options","placeholder","class"])]),o("div",xe,[o("label",he,s(a.$t("product.usage")),1),i(N,{id:"usage",modelValue:t.value.usage,"onUpdate:modelValue":e[6]||(e[6]=l=>t.value.usage=l),placeholder:a.$t("product.enter_usage"),class:u(["w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",{"p-invalid":r.value.usage}])},null,8,["modelValue","placeholder","class"])]),o("div",Ve,[o("label",we,s(a.$t("product.calibres")),1),i(d,{id:"calibres",modelValue:t.value.calibres,"onUpdate:modelValue":e[7]||(e[7]=l=>t.value.calibres=l),placeholder:a.$t("product.enter_calibres"),class:u(["w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",{"p-invalid":r.value.calibres}])},null,8,["modelValue","placeholder","class"])]),o("div",$e,[o("label",ke,s(a.$t("product.quantity")),1),i(T,{id:"quantity",modelValue:t.value.quantity,"onUpdate:modelValue":e[8]||(e[8]=l=>t.value.quantity=l),useGrouping:!1,placeholder:a.$t("product.enter_quantity"),class:u(["w-full",{"p-invalid":r.value.quantity}]),inputClass:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,8,["modelValue","placeholder","class"])]),o("div",qe,[o("label",Ue,s(a.$t("product.quantity_unit")),1),i(n,{filter:"",id:"quantity_unit",modelValue:t.value.quantity_unit,"onUpdate:modelValue":e[9]||(e[9]=l=>t.value.quantity_unit=l),options:[{label:"Tablets",value:1},{label:"Capsules",value:2},{label:"Units",value:3}],optionLabel:"label",optionValue:"value",placeholder:a.$t("product.select_quantity_unit"),class:u(["w-full border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",{"p-invalid":r.value.quantity_unit}])},null,8,["modelValue","placeholder","class"])]),o("div",De,[o("label",Ce,[v(s(a.$t("product.price"))+" ",1),e[20]||(e[20]=o("span",{class:"text-red-500"},"*",-1))]),i(T,{id:"price",modelValue:t.value.price,"onUpdate:modelValue":e[10]||(e[10]=l=>t.value.price=l),mode:"decimal",minFractionDigits:2,maxFractionDigits:2,placeholder:a.$t("product.enter_price"),class:u(["w-full",{"p-invalid":r.value.price}]),inputClass:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,8,["modelValue","placeholder","class"])]),o("div",Ie,[o("label",Fe,[v(s(a.$t("product.price_unit"))+" ",1),e[21]||(e[21]=o("span",{class:"text-red-500"},"*",-1))]),i(n,{filter:"",id:"price_unit",modelValue:t.value.price_unit,"onUpdate:modelValue":e[11]||(e[11]=l=>t.value.price_unit=l),options:[{label:"USD",value:1},{label:"EUR",value:2},{label:"GBP",value:3}],optionLabel:"label",optionValue:"value",placeholder:a.$t("product.select_price_unit"),class:u(["w-full border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",{"p-invalid":r.value.price_unit}])},null,8,["modelValue","placeholder","class"])]),o("div",Ne,[o("label",Te,[v(s(a.$t("product.expiration_from"))+" ",1),e[22]||(e[22]=o("span",{class:"text-red-500"},"*",-1))]),i(d,{type:"date",id:"expiration_from",modelValue:t.value.expiration_from,"onUpdate:modelValue":e[12]||(e[12]=l=>t.value.expiration_from=l),placeholder:a.$t("product.enter_expiration_from"),class:u(["w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",{"p-invalid":r.value.expiration_from}])},null,8,["modelValue","placeholder","class"])]),o("div",Be,[o("label",je,[v(s(a.$t("product.expiration_to"))+" ",1),e[23]||(e[23]=o("span",{class:"text-red-500"},"*",-1))]),i(d,{type:"date",id:"expiration_to",modelValue:t.value.expiration_to,"onUpdate:modelValue":e[13]||(e[13]=l=>t.value.expiration_to=l),placeholder:a.$t("product.enter_expiration_to"),class:u(["w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",{"p-invalid":r.value.expiration_to}])},null,8,["modelValue","placeholder","class"])]),o("div",Le,[o("label",Re,s(a.$t("product.storage_notes")),1),i(N,{id:"storage_notes",modelValue:t.value.storage_notes,"onUpdate:modelValue":e[14]||(e[14]=l=>t.value.storage_notes=l),placeholder:a.$t("product.enter_storage_notes"),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition"},null,8,["modelValue","placeholder"])]),o("div",Se,[o("label",Me,s(a.$t("product.pharmaceutical_form")),1),i(d,{id:"pharmaceutical_form",modelValue:t.value.pharmaceutical_form,"onUpdate:modelValue":e[15]||(e[15]=l=>t.value.pharmaceutical_form=l),placeholder:a.$t("product.enter_pharmaceutical_form"),class:u(["w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition",{"p-invalid":r.value.pharmaceutical_form}])},null,8,["modelValue","placeholder","class"])]),o("div",Pe,[o("label",Ee,s(a.$t("product.product_image")),1),o("div",Ge,[o("label",{onDragover:q(G,["prevent"]),onDragleave:z,onDrop:q(I,["prevent"]),class:u([{"border-blue-500 bg-blue-50":h.value,"border-gray-300":!h.value},"cursor-pointer w-full max-w-md rounded-xl border-2 border-dashed transition-colors duration-300"])},[o("input",{type:"file",onChange:I,accept:"image/*",class:"hidden"},null,32),k.value?(p(),m("div",ze,[o("div",Oe,[o("img",{src:k.value,alt:"Preview",class:"w-full h-64 object-cover rounded-lg shadow-md transition-transform duration-300 group-hover:scale-105"},null,8,Ae),o("div",Je,[o("div",Ze,[o("button",{type:"button",onClick:q(A,["stop"]),class:"bg-red-500 text-white p-2 rounded-full hover:bg-red-600 transition"},[...e[24]||(e[24]=[o("i",{class:"pi pi-trash text-sm"},null,-1)])]),e[25]||(e[25]=o("button",{type:"button",class:"bg-white text-gray-700 p-2 rounded-full hover:bg-gray-100 transition"},[o("i",{class:"pi pi-pencil text-sm"})],-1))])])]),o("p",He,s(a.$t("product.click_or_drag_to_change_photo")),1)])):(p(),m("div",Ke,[e[26]||(e[26]=o("div",{class:"bg-blue-100 p-4 rounded-full mb-4"},[o("i",{class:"pi pi-image text-blue-500 text-2xl"})],-1)),o("p",Qe,[o("span",We,s(a.$t("product.click_to_upload")),1),v(" "+s(a.$t("product.or_drag_and_drop")),1)]),e[27]||(e[27]=o("p",{class:"text-xs text-gray-400"},"SVG, PNG, JPG or GIF (max. 1MB)",-1))]))],34)])])]),o("div",Xe,[i(Z,{type:"submit",label:"Create Product",icon:"pi pi-plus",loading:x.value,class:"px-8 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-300 flex items-center justify-center space-x-2",disabled:x.value,onClick:F},{default:B(()=>[x.value?(p(),m("i",ea)):(p(),m("span",Ye,s(a.$t("product.create_product")),1))]),_:1},8,["loading","disabled"])])]),_:1},8,["model"])])),[[Q,"create products"]]),i(K)],64)}}},ra=W(aa,[["__scopeId","data-v-5fb5ce29"]]);export{ra as default};
